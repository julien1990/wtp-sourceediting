<HTML><HEAD><META CONTENT="text/html; charset=UTF-8" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://www.eclemma.org/">EMMA</A> Coverage Report (generated Tue Jun 09 19:59:05 GMT 2009)</TH></TR><TR><TD CLASS="nv">[<A HREF="../xslUnitTestCoverage.html">all classes</A>][<A HREF="124.html">org.eclipse.wst.jsdt.internal.core</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">NameLookup.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>NameLookup.java</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/64)</TD><TD CLASS="h">0%   (0/4002)</TD><TD CLASS="h">0%   (0/951)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">NameLookup</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/46)</TD><TD CLASS="h">0%   (0/3847)</TD><TD CLASS="h">0%   (0/911)</TD></TR><TR><TD CLASS="f"><A HREF="#0">&lt;static initializer&gt;</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">NameLookup (IPackageFragmentRoot [], HashtableOfArrayToObject, IJavaScriptUni...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/391)</TD><TD CLASS="h">0%   (0/79)</TD></TR><TR><TD CLASS="f"><A HREF="#3">acceptType (IType, int, boolean): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/56)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4">addWorkingCopyBindings (IJavaScriptElement [], HashMap): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/73)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR><TD CLASS="f"><A HREF="#5">checkBindingAccept (String, HashMap [], int, IJavaElementRequestor): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/58)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6">createOpenable (String, IJavaScriptSearchScope): IOpenable</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/121)</TD><TD CLASS="h">0%   (0/26)</TD></TR><TR><TD CLASS="f"><A HREF="#7">doAcceptBinding (IJavaScriptElement, int, boolean, IJavaElementRequestor): bo...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/53)</TD><TD CLASS="h">0%   (0/19)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">findAllBindings (String, int, boolean, int, IJavaElementRequestor): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/57)</TD><TD CLASS="h">0%   (0/15)</TD></TR><TR><TD CLASS="f"><A HREF="#9">findAllTypes (String, boolean, int, IJavaElementRequestor): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/56)</TD><TD CLASS="h">0%   (0/15)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a">findBinding (String, String, int, boolean, int, boolean, boolean, String): Na...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/81)</TD><TD CLASS="h">0%   (0/33)</TD></TR><TR><TD CLASS="f"><A HREF="#b">findBinding (String, String, int, boolean, int, boolean, boolean, boolean, IP...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/225)</TD><TD CLASS="h">0%   (0/48)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">findBinding (String, int, IPackageFragment, boolean, int): IJavaScriptElement</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/96)</TD><TD CLASS="h">0%   (0/22)</TD></TR><TR><TD CLASS="f"><A HREF="#d">findBindingSearch (String, String, int, boolean, int, boolean, boolean, boole...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/228)</TD><TD CLASS="h">0%   (0/57)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e">findCompilationUnit (String [], String, PackageFragmentRoot): ITypeRoot</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/59)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR><TD CLASS="f"><A HREF="#f">findCompilationUnit (String): ITypeRoot</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/85)</TD><TD CLASS="h">0%   (0/21)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#10">findPackageFragment (IPath): IPackageFragment</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/176)</TD><TD CLASS="h">0%   (0/47)</TD></TR><TR><TD CLASS="f"><A HREF="#11">findPackageFragments (String, boolean): IPackageFragment []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#12">findPackageFragments (String, boolean, boolean): IPackageFragment []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/52)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#13">findSecondaryType (String, String, IJavaScriptProject, boolean, IProgressMoni...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/79)</TD><TD CLASS="h">0%   (0/18)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#14">findType (String, IPackageFragment, boolean, int): IType</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#15">findType (String, IPackageFragment, boolean, int, boolean): IType</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/23)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#16">findType (String, String, boolean, int, boolean): NameLookup$Answer</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/48)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR><TD CLASS="f"><A HREF="#17">findType (String, String, boolean, int, boolean, boolean, boolean, IProgressM...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/199)</TD><TD CLASS="h">0%   (0/42)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#18">findType (String, boolean, int): IType</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/14)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#19">findType (String, boolean, int, boolean): NameLookup$Answer</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1a">findType (String, boolean, int, boolean, boolean, boolean, IProgressMonitor):...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/36)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#1b">findTypeSources (String, boolean): IJavaScriptUnit []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/129)</TD><TD CLASS="h">0%   (0/27)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1c">getMemberType (IType, String, int): IType</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#1d">getRestrictedAccessRequestor (): IRestrictedAccessBindingRequestor</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1e">getViolatedRestriction (String, String, IType, AccessRestriction): AccessRest...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/35)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#1f">getViolatedRestriction (String, String, Object, AccessRestriction): AccessRes...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#20">isPackage (String []): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#21">nameMatches (String, IJavaScriptElement, boolean): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/13)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#22">nameMatches (String, IJavaScriptUnit, boolean): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/13)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#23">seekBindings (String, int, IPackageFragment, boolean, int, IJavaElementReques...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/91)</TD><TD CLASS="h">0%   (0/24)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#24">seekBindingsInBinaryPackage (String, int, IPackageFragment, boolean, int, IJa...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/292)</TD><TD CLASS="h">0%   (0/76)</TD></TR><TR><TD CLASS="f"><A HREF="#25">seekBindingsInSourcePackage (String, int, IPackageFragment, int, boolean, Str...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/232)</TD><TD CLASS="h">0%   (0/59)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#26">seekBindingsInWorkingCopies (String, int, IPackageFragment, int, boolean, Str...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/164)</TD><TD CLASS="h">0%   (0/32)</TD></TR><TR><TD CLASS="f"><A HREF="#27">seekPackageFragments (String, boolean, IJavaElementRequestor): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/41)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#28">seekTypes (String, IPackageFragment, boolean, int, IJavaElementRequestor): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/71)</TD><TD CLASS="h">0%   (0/21)</TD></TR><TR><TD CLASS="f"><A HREF="#29">seekTypesInSourcePackage (String, IPackageFragment, int, boolean, String, int...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/133)</TD><TD CLASS="h">0%   (0/32)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2a">seekTypesInTopLevelType (String, int, IType, IJavaElementRequestor, int): boo...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/32)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#2b">seekTypesInType (String, int, IType, IJavaElementRequestor, int): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/86)</TD><TD CLASS="h">0%   (0/23)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2c">seekTypesInWorkingCopies (String, IPackageFragment, int, boolean, String, int...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/156)</TD><TD CLASS="h">0%   (0/33)</TD></TR><TR><TD CLASS="f"><A HREF="#2d">setRestrictedAccessRequestor (IRestrictedAccessBindingRequestor): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2e">setScriptFile (IInferenceFile): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#2f">NameLookup$1</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/77)</TD><TD CLASS="h">0%   (0/16)</TD></TR><TR><TD CLASS="f"><A HREF="#2f">NameLookup$1 (NameLookup): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#31">acceptBinding (int, int, char [], char [], String, AccessRestriction): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/43)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="f"><A HREF="#32">getFoundPath (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#33">getFoundPaths (): ArrayList</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#34">reset (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#35">setExcludePath (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#36">NameLookup$1$MyRequestor</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/26)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR><TD CLASS="f"><A HREF="#36">NameLookup$1$MyRequestor (NameLookup): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#38">acceptField (IField): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#39">acceptInitializer (IInitializer): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3a">acceptMemberType (IType): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3b">acceptMethod (IFunction): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3c">acceptPackageFragment (IPackageFragment): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#3d">acceptType (IType): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3e">isCanceled (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#3f">NameLookup$Answer</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/52)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR><TD CLASS="f"><A HREF="#3f">NameLookup$Answer (IType, AccessRestriction): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#41">NameLookup$Answer (Object, AccessRestriction): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#42">ignoreIfBetter (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#43">isBetter (NameLookup$Answer): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/23)</TD><TD CLASS="h">0%   (0/4)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR CLASS="z"><TD CLASS="l">1</TD><TD>/*******************************************************************************</TD></TR><TR><TD CLASS="l">2</TD><TD> * Copyright (c) 2000, 2008 IBM Corporation and others.</TD></TR><TR><TD CLASS="l">3</TD><TD> * All rights reserved. This program and the accompanying materials</TD></TR><TR><TD CLASS="l">4</TD><TD> * are made available under the terms of the Eclipse Public License v1.0</TD></TR><TR><TD CLASS="l">5</TD><TD> * which accompanies this distribution, and is available at</TD></TR><TR><TD CLASS="l">6</TD><TD> * http://www.eclipse.org/legal/epl-v10.html</TD></TR><TR><TD CLASS="l">7</TD><TD> *</TD></TR><TR><TD CLASS="l">8</TD><TD> * Contributors:</TD></TR><TR><TD CLASS="l">9</TD><TD> *     IBM Corporation - initial API and implementation</TD></TR><TR><TD CLASS="l">10</TD><TD> *******************************************************************************/</TD></TR><TR><TD CLASS="l">11</TD><TD>package org.eclipse.wst.jsdt.internal.core;</TD></TR><TR><TD CLASS="l">12</TD><TD> </TD></TR><TR><TD CLASS="l">13</TD><TD>import java.io.File;</TD></TR><TR><TD CLASS="l">14</TD><TD>import java.util.ArrayList;</TD></TR><TR><TD CLASS="l">15</TD><TD>import java.util.HashMap;</TD></TR><TR><TD CLASS="l">16</TD><TD>import java.util.HashSet;</TD></TR><TR><TD CLASS="l">17</TD><TD>import java.util.Iterator;</TD></TR><TR><TD CLASS="l">18</TD><TD>import java.util.Map;</TD></TR><TR><TD CLASS="l">19</TD><TD> </TD></TR><TR><TD CLASS="l">20</TD><TD>import org.eclipse.core.resources.IResource;</TD></TR><TR><TD CLASS="l">21</TD><TD>import org.eclipse.core.resources.ResourcesPlugin;</TD></TR><TR><TD CLASS="l">22</TD><TD>import org.eclipse.core.runtime.IPath;</TD></TR><TR><TD CLASS="l">23</TD><TD>import org.eclipse.core.runtime.IProgressMonitor;</TD></TR><TR><TD CLASS="l">24</TD><TD>import org.eclipse.core.runtime.NullProgressMonitor;</TD></TR><TR><TD CLASS="l">25</TD><TD>import org.eclipse.core.runtime.OperationCanceledException;</TD></TR><TR><TD CLASS="l">26</TD><TD>import org.eclipse.core.runtime.Path;</TD></TR><TR><TD CLASS="l">27</TD><TD>import org.eclipse.wst.jsdt.core.IClassFile;</TD></TR><TR><TD CLASS="l">28</TD><TD>import org.eclipse.wst.jsdt.core.IIncludePathEntry;</TD></TR><TR><TD CLASS="l">29</TD><TD>import org.eclipse.wst.jsdt.core.IJavaScriptUnit;</TD></TR><TR><TD CLASS="l">30</TD><TD>import org.eclipse.wst.jsdt.core.IField;</TD></TR><TR><TD CLASS="l">31</TD><TD>import org.eclipse.wst.jsdt.core.IInitializer;</TD></TR><TR><TD CLASS="l">32</TD><TD>import org.eclipse.wst.jsdt.core.IJavaScriptElement;</TD></TR><TR><TD CLASS="l">33</TD><TD>import org.eclipse.wst.jsdt.core.IJavaScriptProject;</TD></TR><TR><TD CLASS="l">34</TD><TD>import org.eclipse.wst.jsdt.core.IFunction;</TD></TR><TR><TD CLASS="l">35</TD><TD>import org.eclipse.wst.jsdt.core.IOpenable;</TD></TR><TR><TD CLASS="l">36</TD><TD>import org.eclipse.wst.jsdt.core.IPackageFragment;</TD></TR><TR><TD CLASS="l">37</TD><TD>import org.eclipse.wst.jsdt.core.IPackageFragmentRoot;</TD></TR><TR><TD CLASS="l">38</TD><TD>import org.eclipse.wst.jsdt.core.IType;</TD></TR><TR><TD CLASS="l">39</TD><TD>import org.eclipse.wst.jsdt.core.ITypeRoot;</TD></TR><TR><TD CLASS="l">40</TD><TD>import org.eclipse.wst.jsdt.core.JavaScriptCore;</TD></TR><TR><TD CLASS="l">41</TD><TD>import org.eclipse.wst.jsdt.core.JavaScriptModelException;</TD></TR><TR><TD CLASS="l">42</TD><TD>import org.eclipse.wst.jsdt.core.compiler.CharOperation;</TD></TR><TR><TD CLASS="l">43</TD><TD>import org.eclipse.wst.jsdt.core.infer.IInferenceFile;</TD></TR><TR><TD CLASS="l">44</TD><TD>import org.eclipse.wst.jsdt.core.infer.InferrenceManager;</TD></TR><TR><TD CLASS="l">45</TD><TD>import org.eclipse.wst.jsdt.core.infer.InferrenceProvider;</TD></TR><TR><TD CLASS="l">46</TD><TD>import org.eclipse.wst.jsdt.core.infer.ResolutionConfiguration;</TD></TR><TR><TD CLASS="l">47</TD><TD>import org.eclipse.wst.jsdt.core.search.IJavaScriptSearchConstants;</TD></TR><TR><TD CLASS="l">48</TD><TD>import org.eclipse.wst.jsdt.core.search.IJavaScriptSearchScope;</TD></TR><TR><TD CLASS="l">49</TD><TD>import org.eclipse.wst.jsdt.core.search.SearchPattern;</TD></TR><TR><TD CLASS="l">50</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.ast.ASTNode;</TD></TR><TR><TD CLASS="l">51</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.ast.TypeDeclaration;</TD></TR><TR><TD CLASS="l">52</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.env.AccessRestriction;</TD></TR><TR><TD CLASS="l">53</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.env.AccessRuleSet;</TD></TR><TR><TD CLASS="l">54</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.lookup.Binding;</TD></TR><TR><TD CLASS="l">55</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.lookup.CompilationUnitScope;</TD></TR><TR><TD CLASS="l">56</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.lookup.ReferenceBinding;</TD></TR><TR><TD CLASS="l">57</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.lookup.SourceTypeBinding;</TD></TR><TR><TD CLASS="l">58</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.parser.ScannerHelper;</TD></TR><TR><TD CLASS="l">59</TD><TD>import org.eclipse.wst.jsdt.internal.compiler.util.SuffixConstants;</TD></TR><TR><TD CLASS="l">60</TD><TD>import org.eclipse.wst.jsdt.internal.core.search.BasicSearchEngine;</TD></TR><TR><TD CLASS="l">61</TD><TD>import org.eclipse.wst.jsdt.internal.core.search.IRestrictedAccessBindingRequestor;</TD></TR><TR><TD CLASS="l">62</TD><TD>import org.eclipse.wst.jsdt.internal.core.util.HandleFactory;</TD></TR><TR><TD CLASS="l">63</TD><TD>import org.eclipse.wst.jsdt.internal.core.util.HashtableOfArrayToObject;</TD></TR><TR><TD CLASS="l">64</TD><TD>import org.eclipse.wst.jsdt.internal.core.util.Messages;</TD></TR><TR><TD CLASS="l">65</TD><TD>import org.eclipse.wst.jsdt.internal.core.util.Util;</TD></TR><TR><TD CLASS="l">66</TD><TD> </TD></TR><TR><TD CLASS="l">67</TD><TD>/**</TD></TR><TR><TD CLASS="l">68</TD><TD> * A &lt;code&gt;NameLookup&lt;/code&gt; provides name resolution within a Java project.</TD></TR><TR><TD CLASS="l">69</TD><TD> * The name lookup facility uses the project's classpath to prioritize the</TD></TR><TR><TD CLASS="l">70</TD><TD> * order in which package fragments are searched when resolving a name.</TD></TR><TR><TD CLASS="l">71</TD><TD> *</TD></TR><TR><TD CLASS="l">72</TD><TD> * &lt;p&gt;Name lookup only returns a handle when the named element actually</TD></TR><TR><TD CLASS="l">73</TD><TD> * exists in the model; otherwise &lt;code&gt;null&lt;/code&gt; is returned.</TD></TR><TR><TD CLASS="l">74</TD><TD> *</TD></TR><TR><TD CLASS="l">75</TD><TD> * &lt;p&gt;There are two logical sets of methods within this interface.  Methods</TD></TR><TR><TD CLASS="l">76</TD><TD> * which start with &lt;code&gt;find*&lt;/code&gt; are intended to be convenience methods for quickly</TD></TR><TR><TD CLASS="l">77</TD><TD> * finding an element within another element; for instance, for finding a class within a</TD></TR><TR><TD CLASS="l">78</TD><TD> * package.  The other set of methods all begin with &lt;code&gt;seek*&lt;/code&gt;.  These methods</TD></TR><TR><TD CLASS="l">79</TD><TD> * do comprehensive searches of the &lt;code&gt;IJavaScriptProject&lt;/code&gt; returning hits</TD></TR><TR><TD CLASS="l">80</TD><TD> * in real time through an &lt;code&gt;IJavaElementRequestor&lt;/code&gt;.</TD></TR><TR><TD CLASS="l">81</TD><TD> *</TD></TR><TR><TD CLASS="l">82</TD><TD> */</TD></TR><TR CLASS="z"><TD CLASS="l">83</TD><TD>public class NameLookup implements SuffixConstants {</TD></TR><TR><TD CLASS="l"><A NAME="3f">84</A></TD><TD>        public static class Answer {</TD></TR><TR><TD CLASS="l">85</TD><TD>                public IType type;</TD></TR><TR><TD CLASS="l">86</TD><TD>                public Object element;</TD></TR><TR><TD CLASS="l">87</TD><TD>                AccessRestriction restriction;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="41">88</A></TD><TD>                Answer(IType type, AccessRestriction restriction) {</TD></TR><TR CLASS="z"><TD CLASS="l">89</TD><TD>                        this.type = type;</TD></TR><TR CLASS="z"><TD CLASS="l">90</TD><TD>                        this.restriction = restriction;</TD></TR><TR CLASS="z"><TD CLASS="l">91</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">92</TD><TD>                Answer(Object element, AccessRestriction restriction) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="42">93</A></TD><TD>                        this.element = element;</TD></TR><TR CLASS="z"><TD CLASS="l">94</TD><TD>                        this.restriction = restriction;</TD></TR><TR CLASS="z"><TD CLASS="l">95</TD><TD>                }</TD></TR><TR><TD CLASS="l">96</TD><TD>                public boolean ignoreIfBetter() {</TD></TR><TR CLASS="z"><TD CLASS="l">97</TD><TD>                        return this.restriction != null &amp;&amp; this.restriction.ignoreIfBetter();</TD></TR><TR><TD CLASS="l">98</TD><TD>                }</TD></TR><TR><TD CLASS="l">99</TD><TD>                /*</TD></TR><TR><TD CLASS="l">100</TD><TD>                 * Returns whether this answer is better than the other awswer.</TD></TR><TR><TD CLASS="l"><A NAME="43">101</A></TD><TD>                 * (accessible is better than discouraged, which is better than</TD></TR><TR><TD CLASS="l">102</TD><TD>                 * non-accessible)</TD></TR><TR><TD CLASS="l">103</TD><TD>                 */</TD></TR><TR><TD CLASS="l">104</TD><TD>                public boolean isBetter(Answer otherAnswer) {</TD></TR><TR CLASS="z"><TD CLASS="l">105</TD><TD>                        if (otherAnswer == null) return true;</TD></TR><TR CLASS="z"><TD CLASS="l">106</TD><TD>                        if (this.restriction == null) return true;</TD></TR><TR CLASS="z"><TD CLASS="l">107</TD><TD>                        return otherAnswer.restriction != null</TD></TR><TR CLASS="z"><TD CLASS="l">108</TD><TD>                                &amp;&amp; this.restriction.getProblemId() &lt; otherAnswer.restriction.getProblemId();</TD></TR><TR><TD CLASS="l">109</TD><TD>                }</TD></TR><TR><TD CLASS="l">110</TD><TD>        }</TD></TR><TR><TD CLASS="l">111</TD><TD> </TD></TR><TR><TD CLASS="l">112</TD><TD>        // TODO (jerome) suppress the accept flags (qualified name is sufficient to find a type)</TD></TR><TR><TD CLASS="l">113</TD><TD>        /**</TD></TR><TR><TD CLASS="l">114</TD><TD>         * Accept flag for specifying classes.</TD></TR><TR><TD CLASS="l">115</TD><TD>         */</TD></TR><TR><TD CLASS="l">116</TD><TD>        public static final int ACCEPT_CLASSES = ASTNode.Bit2;</TD></TR><TR><TD CLASS="l">117</TD><TD> </TD></TR><TR><TD CLASS="l">118</TD><TD>        /**</TD></TR><TR><TD CLASS="l">119</TD><TD>         * Accept flag for specifying interfaces.</TD></TR><TR><TD CLASS="l">120</TD><TD>         */</TD></TR><TR><TD CLASS="l">121</TD><TD>        public static final int ACCEPT_INTERFACES = ASTNode.Bit3;</TD></TR><TR><TD CLASS="l">122</TD><TD> </TD></TR><TR><TD CLASS="l">123</TD><TD>        /**</TD></TR><TR><TD CLASS="l">124</TD><TD>         * Accept flag for specifying enums.</TD></TR><TR><TD CLASS="l">125</TD><TD>         */</TD></TR><TR><TD CLASS="l">126</TD><TD>        public static final int ACCEPT_ENUMS = ASTNode.Bit4;</TD></TR><TR><TD CLASS="l">127</TD><TD> </TD></TR><TR><TD CLASS="l">128</TD><TD>        /**</TD></TR><TR><TD CLASS="l">129</TD><TD>         * Accept flag for specifying annotations.</TD></TR><TR><TD CLASS="l">130</TD><TD>         */</TD></TR><TR><TD CLASS="l">131</TD><TD>        public static final int ACCEPT_ANNOTATIONS = ASTNode.Bit5;</TD></TR><TR><TD CLASS="l">132</TD><TD> </TD></TR><TR><TD CLASS="l">133</TD><TD>        /*</TD></TR><TR><TD CLASS="l"><A NAME="0">134</A></TD><TD>         * Accept flag for all kinds of types</TD></TR><TR><TD CLASS="l">135</TD><TD>         */</TD></TR><TR><TD CLASS="l">136</TD><TD>        public static final int ACCEPT_ALL = ACCEPT_CLASSES | ACCEPT_INTERFACES | ACCEPT_ENUMS | ACCEPT_ANNOTATIONS;</TD></TR><TR><TD CLASS="l">137</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">138</TD><TD>        public static boolean VERBOSE = false;</TD></TR><TR><TD CLASS="l">139</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">140</TD><TD>        private static final IType[] NO_TYPES = {};</TD></TR><TR CLASS="z"><TD CLASS="l">141</TD><TD>        private static final IJavaScriptElement[] NO_BINDINGS = {};</TD></TR><TR><TD CLASS="l">142</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">143</TD><TD>        private boolean searchFiles=true;</TD></TR><TR><TD CLASS="l">144</TD><TD>        </TD></TR><TR><TD CLASS="l">145</TD><TD>        /**</TD></TR><TR><TD CLASS="l">146</TD><TD>         * The &lt;code&gt;IPackageFragmentRoot&lt;/code&gt;'s associated</TD></TR><TR><TD CLASS="l">147</TD><TD>         * with the classpath of this NameLookup facility's</TD></TR><TR><TD CLASS="l">148</TD><TD>         * project.</TD></TR><TR><TD CLASS="l">149</TD><TD>         */</TD></TR><TR><TD CLASS="l">150</TD><TD>        protected IPackageFragmentRoot[] packageFragmentRoots;</TD></TR><TR><TD CLASS="l">151</TD><TD> </TD></TR><TR><TD CLASS="l">152</TD><TD>        /**</TD></TR><TR><TD CLASS="l">153</TD><TD>         * Table that maps package names to lists of package fragment roots</TD></TR><TR><TD CLASS="l">154</TD><TD>         * that contain such a package known by this name lookup facility.</TD></TR><TR><TD CLASS="l">155</TD><TD>         * To allow &gt; 1 package fragment with the same name, values are</TD></TR><TR><TD CLASS="l">156</TD><TD>         * arrays of package fragment roots ordered as they appear on the</TD></TR><TR><TD CLASS="l">157</TD><TD>         * classpath.</TD></TR><TR><TD CLASS="l">158</TD><TD>         * Note if the list is of size 1, then the IPackageFragmentRoot object</TD></TR><TR><TD CLASS="l">159</TD><TD>         * replaces the array.</TD></TR><TR><TD CLASS="l">160</TD><TD>         */</TD></TR><TR><TD CLASS="l">161</TD><TD>        protected HashtableOfArrayToObject packageFragments;</TD></TR><TR><TD CLASS="l">162</TD><TD> </TD></TR><TR><TD CLASS="l">163</TD><TD>        /**</TD></TR><TR><TD CLASS="l">164</TD><TD>         * Reverse map from root path to corresponding resolved CP entry</TD></TR><TR><TD CLASS="l">165</TD><TD>         * (so as to be able to figure inclusion/exclusion rules)</TD></TR><TR><TD CLASS="l">166</TD><TD>         */</TD></TR><TR><TD CLASS="l">167</TD><TD>        protected Map rootToResolvedEntries;</TD></TR><TR><TD CLASS="l">168</TD><TD> </TD></TR><TR><TD CLASS="l">169</TD><TD>        /**</TD></TR><TR><TD CLASS="l">170</TD><TD>         * A map from package handles to a map from type name to an IType or an IType[].</TD></TR><TR><TD CLASS="l">171</TD><TD>         * Allows working copies to take precedence over compilation units.</TD></TR><TR><TD CLASS="l">172</TD><TD>         */</TD></TR><TR><TD CLASS="l">173</TD><TD>        protected HashMap typesInWorkingCopies;</TD></TR><TR><TD CLASS="l">174</TD><TD>        protected HashMap bindingsInWorkingCopies;</TD></TR><TR><TD CLASS="l">175</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">176</TD><TD>        public long timeSpentInSeekTypesInSourcePackage = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">177</TD><TD>        public long timeSpentInSeekTypesInBinaryPackage = 0;</TD></TR><TR><TD CLASS="l">178</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">179</TD><TD>        protected HashSet acceptedCUs=new HashSet();</TD></TR><TR><TD CLASS="l"><A NAME="2">180</A></TD><TD>        private IJavaScriptUnit[] workingCopies;</TD></TR><TR><TD CLASS="l">181</TD><TD> </TD></TR><TR><TD CLASS="l">182</TD><TD>        IRestrictedAccessBindingRequestor restrictedRequestor;</TD></TR><TR><TD CLASS="l">183</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">184</TD><TD>        public NameLookup(</TD></TR><TR><TD CLASS="l">185</TD><TD>                        IPackageFragmentRoot[] packageFragmentRoots,</TD></TR><TR><TD CLASS="l">186</TD><TD>                        HashtableOfArrayToObject packageFragments,</TD></TR><TR><TD CLASS="l">187</TD><TD>                        IJavaScriptUnit[] workingCopies,</TD></TR><TR><TD CLASS="l">188</TD><TD>                        Map rootToResolvedEntries) {</TD></TR><TR CLASS="z"><TD CLASS="l">189</TD><TD>                long start = -1;</TD></TR><TR CLASS="z"><TD CLASS="l">190</TD><TD>                if (VERBOSE) {</TD></TR><TR CLASS="z"><TD CLASS="l">191</TD><TD>                        Util.verbose(&#34; BUILDING NameLoopkup&#34;);  //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">192</TD><TD>                        Util.verbose(&#34; -&gt; pkg roots size: &#34; + (packageFragmentRoots == null ? 0 : packageFragmentRoots.length));  //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">193</TD><TD>                        Util.verbose(&#34; -&gt; pkgs size: &#34; + (packageFragments == null ? 0 : packageFragments.size()));  //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">194</TD><TD>                        Util.verbose(&#34; -&gt; working copy size: &#34; + (workingCopies == null ? 0 : workingCopies.length));  //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">195</TD><TD>                        start = System.currentTimeMillis();</TD></TR><TR><TD CLASS="l">196</TD><TD>                }</TD></TR><TR><TD CLASS="l">197</TD><TD>//                this.restrictedRequestor=restrictedRequestor;</TD></TR><TR><TD CLASS="l">198</TD><TD>                //this.restrictToLanguage=restrictToLanguage;</TD></TR><TR CLASS="z"><TD CLASS="l">199</TD><TD>                this.packageFragmentRoots = packageFragmentRoots;</TD></TR><TR CLASS="z"><TD CLASS="l">200</TD><TD>                if (workingCopies == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">201</TD><TD>                        this.packageFragments = packageFragments;</TD></TR><TR><TD CLASS="l">202</TD><TD>                } else {</TD></TR><TR><TD CLASS="l">203</TD><TD>                        // clone tables as we're adding packages from working copies</TD></TR><TR><TD CLASS="l">204</TD><TD>                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">205</TD><TD>                                this.packageFragments = (HashtableOfArrayToObject) packageFragments.clone();</TD></TR><TR CLASS="z"><TD CLASS="l">206</TD><TD>                        } catch (CloneNotSupportedException e1) {</TD></TR><TR><TD CLASS="l">207</TD><TD>                                // ignore (implementation of HashtableOfArrayToObject supports cloning)</TD></TR><TR><TD CLASS="l">208</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">209</TD><TD>                        this.typesInWorkingCopies = new HashMap();</TD></TR><TR CLASS="z"><TD CLASS="l">210</TD><TD>                        this.bindingsInWorkingCopies = new HashMap();</TD></TR><TR CLASS="z"><TD CLASS="l">211</TD><TD>                        this.workingCopies=workingCopies;</TD></TR><TR CLASS="z"><TD CLASS="l">212</TD><TD>                        for (int i = 0, length = workingCopies.length; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">213</TD><TD>                                IJavaScriptUnit workingCopy = workingCopies[i];</TD></TR><TR CLASS="z"><TD CLASS="l">214</TD><TD>                                PackageFragment pkg = (PackageFragment) workingCopy.getParent();</TD></TR><TR CLASS="z"><TD CLASS="l">215</TD><TD>                                HashMap typeMap = (HashMap) this.typesInWorkingCopies.get(pkg);</TD></TR><TR CLASS="z"><TD CLASS="l">216</TD><TD>                                HashMap[] bindingsMap = (HashMap[]) this.bindingsInWorkingCopies.get(pkg);</TD></TR><TR CLASS="z"><TD CLASS="l">217</TD><TD>                                if (typeMap == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">218</TD><TD>                                        typeMap = new HashMap();</TD></TR><TR CLASS="z"><TD CLASS="l">219</TD><TD>                                        this.typesInWorkingCopies.put(pkg, typeMap);</TD></TR><TR><TD CLASS="l">220</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">221</TD><TD>                                        bindingsMap = new HashMap[Binding.NUMBER_BASIC_BINDING];</TD></TR><TR CLASS="z"><TD CLASS="l">222</TD><TD>                                        for (int j = 0; j &lt;Binding.NUMBER_BASIC_BINDING; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">223</TD><TD>                                                bindingsMap[j] = new HashMap();</TD></TR><TR><TD CLASS="l">224</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">225</TD><TD>                                        this.bindingsInWorkingCopies.put(pkg, bindingsMap);</TD></TR><TR><TD CLASS="l">226</TD><TD>                                }</TD></TR><TR><TD CLASS="l">227</TD><TD>                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">228</TD><TD>                                        IType[] types = workingCopy.getTypes();</TD></TR><TR CLASS="z"><TD CLASS="l">229</TD><TD>                                        int typeLength = types.length;</TD></TR><TR CLASS="z"><TD CLASS="l">230</TD><TD>                                        if (typeLength == 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">231</TD><TD>                                                String typeName = Util.getNameWithoutJavaLikeExtension(workingCopy.getElementName());</TD></TR><TR CLASS="z"><TD CLASS="l">232</TD><TD>                                                typeMap.put(typeName, NO_TYPES);</TD></TR><TR><TD CLASS="l">233</TD><TD>                                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">234</TD><TD>                                                for (int j = 0; j &lt; typeLength; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">235</TD><TD>                                                        IType type = types[j];</TD></TR><TR CLASS="z"><TD CLASS="l">236</TD><TD>                                                        String typeName = type.getElementName();</TD></TR><TR CLASS="z"><TD CLASS="l">237</TD><TD>                                                        Object existing = typeMap.get(typeName);</TD></TR><TR CLASS="z"><TD CLASS="l">238</TD><TD>                                                        if (existing == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">239</TD><TD>                                                                typeMap.put(typeName, type);</TD></TR><TR CLASS="z"><TD CLASS="l">240</TD><TD>                                                        } else if (existing instanceof IType) {</TD></TR><TR CLASS="z"><TD CLASS="l">241</TD><TD>                                                                typeMap.put(typeName, new IType[] {(IType) existing, type});</TD></TR><TR><TD CLASS="l">242</TD><TD>                                                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">243</TD><TD>                                                                IType[] existingTypes = (IType[]) existing;</TD></TR><TR CLASS="z"><TD CLASS="l">244</TD><TD>                                                                int existingTypeLength = existingTypes.length;</TD></TR><TR CLASS="z"><TD CLASS="l">245</TD><TD>                                                                System.arraycopy(existingTypes, 0, existingTypes = new IType[existingTypeLength+1], 0, existingTypeLength);</TD></TR><TR CLASS="z"><TD CLASS="l">246</TD><TD>                                                                existingTypes[existingTypeLength] = type;</TD></TR><TR CLASS="z"><TD CLASS="l">247</TD><TD>                                                                typeMap.put(typeName, existingTypes);</TD></TR><TR><TD CLASS="l">248</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">249</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">250</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">251</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">252</TD><TD>                                        addWorkingCopyBindings(types, bindingsMap[Binding.TYPE]);</TD></TR><TR CLASS="z"><TD CLASS="l">253</TD><TD>                                        addWorkingCopyBindings(workingCopy.getFields(), bindingsMap[Binding.VARIABLE]);</TD></TR><TR CLASS="z"><TD CLASS="l">254</TD><TD>                                        addWorkingCopyBindings(workingCopy.getFields(), bindingsMap[Binding.LOCAL]);</TD></TR><TR CLASS="z"><TD CLASS="l">255</TD><TD>                                        addWorkingCopyBindings(workingCopy.getFunctions(), bindingsMap[Binding.METHOD]);</TD></TR><TR><TD CLASS="l">256</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">257</TD><TD>                                } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">258</TD><TD>                                        // working copy doesn't exist -&gt; ignore</TD></TR><TR><TD CLASS="l">259</TD><TD>                                }</TD></TR><TR><TD CLASS="l">260</TD><TD> </TD></TR><TR><TD CLASS="l">261</TD><TD>                                // add root of package fragment to cache</TD></TR><TR CLASS="z"><TD CLASS="l">262</TD><TD>                                IPackageFragmentRoot root = (IPackageFragmentRoot) pkg.getParent();</TD></TR><TR CLASS="z"><TD CLASS="l">263</TD><TD>                                String[] pkgName = pkg.names;</TD></TR><TR CLASS="z"><TD CLASS="l">264</TD><TD>                                Object existing = this.packageFragments.get(pkgName);</TD></TR><TR CLASS="z"><TD CLASS="l">265</TD><TD>                                if (existing == null || existing == JavaProjectElementInfo.NO_ROOTS) {</TD></TR><TR CLASS="z"><TD CLASS="l">266</TD><TD>                                        this.packageFragments.put(pkgName, root);</TD></TR><TR><TD CLASS="l">267</TD><TD>                                        // ensure super packages (see https://bugs.eclipse.org/bugs/show_bug.cgi?id=119161)</TD></TR><TR><TD CLASS="l">268</TD><TD>                                        // are also in the map</TD></TR><TR CLASS="z"><TD CLASS="l">269</TD><TD>                                        JavaProjectElementInfo.addSuperPackageNames(pkgName, this.packageFragments);</TD></TR><TR><TD CLASS="l">270</TD><TD>                                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">271</TD><TD>                                        if (existing instanceof PackageFragmentRoot) {</TD></TR><TR CLASS="z"><TD CLASS="l">272</TD><TD>                                                if (!existing.equals(root))</TD></TR><TR CLASS="z"><TD CLASS="l">273</TD><TD>                                                        this.packageFragments.put(pkgName, new IPackageFragmentRoot[] {(PackageFragmentRoot) existing, root});</TD></TR><TR><TD CLASS="l">274</TD><TD>                                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">275</TD><TD>                                                IPackageFragmentRoot[] roots = (IPackageFragmentRoot[]) existing;</TD></TR><TR CLASS="z"><TD CLASS="l">276</TD><TD>                                                int rootLength = roots.length;</TD></TR><TR CLASS="z"><TD CLASS="l">277</TD><TD>                                                boolean containsRoot = false;</TD></TR><TR CLASS="z"><TD CLASS="l">278</TD><TD>                                                for (int j = 0; j &lt; rootLength; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">279</TD><TD>                                                        if (roots[j].equals(root)) {</TD></TR><TR CLASS="z"><TD CLASS="l">280</TD><TD>                                                                containsRoot = true;</TD></TR><TR CLASS="z"><TD CLASS="l">281</TD><TD>                                                                break;</TD></TR><TR><TD CLASS="l">282</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">283</TD><TD>                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">284</TD><TD>                                                if (containsRoot) {</TD></TR><TR CLASS="z"><TD CLASS="l">285</TD><TD>                                                        System.arraycopy(roots, 0, roots = new IPackageFragmentRoot[rootLength+1], 0, rootLength);</TD></TR><TR CLASS="z"><TD CLASS="l">286</TD><TD>                                                        roots[rootLength] = root;</TD></TR><TR CLASS="z"><TD CLASS="l">287</TD><TD>                                                        this.packageFragments.put(pkgName, roots);</TD></TR><TR><TD CLASS="l">288</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">289</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">290</TD><TD>                                }</TD></TR><TR><TD CLASS="l">291</TD><TD>                        }</TD></TR><TR><TD CLASS="l">292</TD><TD>                }</TD></TR><TR><TD CLASS="l">293</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">294</TD><TD>                this.rootToResolvedEntries = rootToResolvedEntries;</TD></TR><TR CLASS="z"><TD CLASS="l">295</TD><TD>        if (VERBOSE) {</TD></TR><TR CLASS="z"><TD CLASS="l">296</TD><TD>            Util.verbose(&#34; -&gt; spent: &#34; + (System.currentTimeMillis() - start) + &#34;ms&#34;);  //$NON-NLS-1$ //$NON-NLS-2$</TD></TR><TR><TD CLASS="l"><A NAME="2d">297</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">298</TD><TD>        }</TD></TR><TR><TD CLASS="l">299</TD><TD> </TD></TR><TR><TD CLASS="l">300</TD><TD>        public void setRestrictedAccessRequestor(IRestrictedAccessBindingRequestor restrictedRequestor) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1d">301</A></TD><TD>                this.restrictedRequestor=restrictedRequestor;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2f">302</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">303</TD><TD> </TD></TR><TR><TD CLASS="l">304</TD><TD>        protected  IRestrictedAccessBindingRequestor getRestrictedAccessRequestor() {</TD></TR><TR CLASS="z"><TD CLASS="l">305</TD><TD>                if(this.restrictedRequestor==null) {</TD></TR><TR CLASS="z"><TD CLASS="l">306</TD><TD>                        this.restrictedRequestor=new IRestrictedAccessBindingRequestor() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="35">307</A></TD><TD>                                ArrayList foundPaths=new ArrayList();</TD></TR><TR><TD CLASS="l">308</TD><TD>                                String excludePath;</TD></TR><TR><TD CLASS="l">309</TD><TD> </TD></TR><TR><TD CLASS="l">310</TD><TD>                                public void setExcludePath(String excludePath) {</TD></TR><TR CLASS="z"><TD CLASS="l">311</TD><TD>                                        this.excludePath = excludePath;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="31">312</A></TD><TD>                                }</TD></TR><TR><TD CLASS="l">313</TD><TD>                                public boolean acceptBinding(int type,int modifiers, char[] packageName,</TD></TR><TR><TD CLASS="l">314</TD><TD>                                                char[] simpleTypeName,</TD></TR><TR><TD CLASS="l">315</TD><TD>                                                String path, AccessRestriction access) {</TD></TR><TR CLASS="z"><TD CLASS="l">316</TD><TD>                                        if (excludePath!=null &amp;&amp; path.equals(excludePath))</TD></TR><TR CLASS="z"><TD CLASS="l">317</TD><TD>                                                return false;</TD></TR><TR CLASS="z"><TD CLASS="l">318</TD><TD>                                        for (int i = 0; workingCopies!=null &amp;&amp; i &lt; workingCopies.length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">319</TD><TD>                                                if (workingCopies[i].getPath().toString().equals(path))</TD></TR><TR CLASS="z"><TD CLASS="l">320</TD><TD>                                                        return false;</TD></TR><TR><TD CLASS="l">321</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">322</TD><TD>                                        foundPaths.add(path);</TD></TR><TR CLASS="z"><TD CLASS="l">323</TD><TD>                                        return true;</TD></TR><TR><TD CLASS="l">324</TD><TD>                                }</TD></TR><TR><TD CLASS="l"><A NAME="32">325</A></TD><TD>                                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">326</TD><TD>                                 * @see org.eclipse.wst.jsdt.internal.core.search.IRestrictedAccessBindingRequestor#getFoundPaths()</TD></TR><TR><TD CLASS="l">327</TD><TD>                                 */</TD></TR><TR><TD CLASS="l">328</TD><TD>                                public String getFoundPath() {</TD></TR><TR CLASS="z"><TD CLASS="l">329</TD><TD>                                        return foundPaths.size()&gt;0?(String)foundPaths.get(0):null;</TD></TR><TR><TD CLASS="l"><A NAME="34">330</A></TD><TD>                                }</TD></TR><TR><TD CLASS="l">331</TD><TD> </TD></TR><TR><TD CLASS="l">332</TD><TD> </TD></TR><TR><TD CLASS="l">333</TD><TD>                                public void reset() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="33">334</A></TD><TD>                                        foundPaths.clear();</TD></TR><TR CLASS="z"><TD CLASS="l">335</TD><TD>                                }</TD></TR><TR><TD CLASS="l">336</TD><TD>                                public ArrayList getFoundPaths()</TD></TR><TR><TD CLASS="l">337</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">338</TD><TD>                                        return foundPaths;</TD></TR><TR><TD CLASS="l">339</TD><TD>                                }</TD></TR><TR><TD CLASS="l">340</TD><TD> </TD></TR><TR><TD CLASS="l">341</TD><TD>                        };</TD></TR><TR><TD CLASS="l">342</TD><TD>                }</TD></TR><TR><TD CLASS="l">343</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">344</TD><TD>                return this.restrictedRequestor;</TD></TR><TR><TD CLASS="l"><A NAME="4">345</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">346</TD><TD> </TD></TR><TR><TD CLASS="l">347</TD><TD>        private void addWorkingCopyBindings(IJavaScriptElement [] elements, HashMap bindingsMap)</TD></TR><TR><TD CLASS="l">348</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">349</TD><TD>                for (int j = 0; j &lt; elements.length; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">350</TD><TD>                        IJavaScriptElement element = elements[j];</TD></TR><TR CLASS="z"><TD CLASS="l">351</TD><TD>                        String elementName = element.getElementName();</TD></TR><TR CLASS="z"><TD CLASS="l">352</TD><TD>                        Object existing = bindingsMap.get(elementName);</TD></TR><TR CLASS="z"><TD CLASS="l">353</TD><TD>                        if (existing == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">354</TD><TD>                                bindingsMap.put(elementName, element);</TD></TR><TR CLASS="z"><TD CLASS="l">355</TD><TD>                        } else if (existing instanceof IJavaScriptElement) {</TD></TR><TR CLASS="z"><TD CLASS="l">356</TD><TD>                                bindingsMap.put(elementName, new IJavaScriptElement[] {(IJavaScriptElement) existing, element});</TD></TR><TR><TD CLASS="l">357</TD><TD>                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">358</TD><TD>                                IJavaScriptElement[] existingElements = (IJavaScriptElement[]) existing;</TD></TR><TR CLASS="z"><TD CLASS="l">359</TD><TD>                                int existingElementsLength = existingElements.length;</TD></TR><TR CLASS="z"><TD CLASS="l">360</TD><TD>                                System.arraycopy(existingElements, 0, existingElements = new IJavaScriptElement[existingElementsLength+1], 0, existingElementsLength);</TD></TR><TR CLASS="z"><TD CLASS="l">361</TD><TD>                                existingElements[existingElementsLength] = element;</TD></TR><TR CLASS="z"><TD CLASS="l">362</TD><TD>                                bindingsMap.put(elementName, existingElements);</TD></TR><TR><TD CLASS="l">363</TD><TD>                        }</TD></TR><TR><TD CLASS="l">364</TD><TD>                }</TD></TR><TR><TD CLASS="l">365</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">366</TD><TD>        }</TD></TR><TR><TD CLASS="l">367</TD><TD> </TD></TR><TR><TD CLASS="l">368</TD><TD>        /**</TD></TR><TR><TD CLASS="l">369</TD><TD>         * Returns true if:&lt;ul&gt;</TD></TR><TR><TD CLASS="l">370</TD><TD>         *  &lt;li&gt;the given type is an existing class and the flag's &lt;code&gt;ACCEPT_CLASSES&lt;/code&gt;</TD></TR><TR><TD CLASS="l">371</TD><TD>         *      bit is on</TD></TR><TR><TD CLASS="l">372</TD><TD>         *  &lt;li&gt;the given type is an existing interface and the &lt;code&gt;ACCEPT_INTERFACES&lt;/code&gt;</TD></TR><TR><TD CLASS="l">373</TD><TD>         *      bit is on</TD></TR><TR><TD CLASS="l">374</TD><TD>         *  &lt;li&gt;neither the &lt;code&gt;ACCEPT_CLASSES&lt;/code&gt; or &lt;code&gt;ACCEPT_INTERFACES&lt;/code&gt;</TD></TR><TR><TD CLASS="l">375</TD><TD>         *      bit is on</TD></TR><TR><TD CLASS="l"><A NAME="3">376</A></TD><TD>         *  &lt;/ul&gt;</TD></TR><TR><TD CLASS="l">377</TD><TD>         * Otherwise, false is returned.</TD></TR><TR><TD CLASS="l">378</TD><TD>         */</TD></TR><TR><TD CLASS="l">379</TD><TD>        protected boolean acceptType(IType type, int acceptFlags, boolean isSourceType) {</TD></TR><TR CLASS="z"><TD CLASS="l">380</TD><TD>                if (!type.exists())</TD></TR><TR CLASS="z"><TD CLASS="l">381</TD><TD>                        return false;</TD></TR><TR CLASS="z"><TD CLASS="l">382</TD><TD>                if (acceptFlags == 0 || acceptFlags == ACCEPT_ALL)</TD></TR><TR CLASS="z"><TD CLASS="l">383</TD><TD>                        return true; // no flags or all flags, always accepted</TD></TR><TR><TD CLASS="l">384</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">385</TD><TD>                        int kind =  TypeDeclaration.kind(((SourceTypeElementInfo) ((SourceType) type).getElementInfo()).getModifiers());</TD></TR><TR><TD CLASS="l">386</TD><TD> </TD></TR><TR><TD CLASS="l">387</TD><TD>//                        int kind = isSourceType</TD></TR><TR><TD CLASS="l">388</TD><TD>//                                        ? TypeDeclaration.kind(((SourceTypeElementInfo) ((SourceType) type).getElementInfo()).getModifiers())</TD></TR><TR><TD CLASS="l">389</TD><TD>//                                        : TypeDeclaration.kind(((IBinaryType) ((BinaryType) type).getElementInfo()).getModifiers());</TD></TR><TR CLASS="z"><TD CLASS="l">390</TD><TD>                        switch (kind) {</TD></TR><TR><TD CLASS="l">391</TD><TD>                                case TypeDeclaration.CLASS_DECL :</TD></TR><TR CLASS="z"><TD CLASS="l">392</TD><TD>                                        return (acceptFlags &amp; ACCEPT_CLASSES) != 0;</TD></TR><TR><TD CLASS="l">393</TD><TD>                                case TypeDeclaration.INTERFACE_DECL :</TD></TR><TR CLASS="z"><TD CLASS="l">394</TD><TD>                                        return (acceptFlags &amp; ACCEPT_INTERFACES) != 0;</TD></TR><TR><TD CLASS="l">395</TD><TD>                                case TypeDeclaration.ENUM_DECL :</TD></TR><TR CLASS="z"><TD CLASS="l">396</TD><TD>                                        return (acceptFlags &amp; ACCEPT_ENUMS) != 0;</TD></TR><TR><TD CLASS="l">397</TD><TD>                                default:</TD></TR><TR><TD CLASS="l">398</TD><TD>                                        //case IGenericType.ANNOTATION_TYPE :</TD></TR><TR CLASS="z"><TD CLASS="l">399</TD><TD>                                        return (acceptFlags &amp; ACCEPT_ANNOTATIONS) != 0;</TD></TR><TR><TD CLASS="l">400</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">401</TD><TD>                } catch (JavaScriptModelException npe) {</TD></TR><TR CLASS="z"><TD CLASS="l">402</TD><TD>                        return false; // the class is not present, do not accept.</TD></TR><TR><TD CLASS="l"><A NAME="7">403</A></TD><TD>                }</TD></TR><TR><TD CLASS="l">404</TD><TD>        }</TD></TR><TR><TD CLASS="l">405</TD><TD> </TD></TR><TR><TD CLASS="l">406</TD><TD>        protected boolean doAcceptBinding(IJavaScriptElement element, int bindingType, boolean isSourceType,IJavaElementRequestor requestor) {</TD></TR><TR CLASS="z"><TD CLASS="l">407</TD><TD>                switch (bindingType)</TD></TR><TR><TD CLASS="l">408</TD><TD>                {</TD></TR><TR><TD CLASS="l">409</TD><TD>                  case Binding.FIELD | Binding.METHOD:</TD></TR><TR CLASS="z"><TD CLASS="l">410</TD><TD>                          if (element instanceof IFunction)</TD></TR><TR><TD CLASS="l">411</TD><TD>                          {</TD></TR><TR><TD CLASS="l">412</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">413</TD><TD>                                  requestor.acceptMethod((IFunction)element);</TD></TR><TR CLASS="z"><TD CLASS="l">414</TD><TD>                                  return true;</TD></TR><TR><TD CLASS="l">415</TD><TD>                          }</TD></TR><TR CLASS="z"><TD CLASS="l">416</TD><TD>                          if (element instanceof IField)</TD></TR><TR><TD CLASS="l">417</TD><TD>                          {</TD></TR><TR CLASS="z"><TD CLASS="l">418</TD><TD>                                  requestor.acceptField( (IField)element);</TD></TR><TR CLASS="z"><TD CLASS="l">419</TD><TD>                                  return true;</TD></TR><TR><TD CLASS="l">420</TD><TD>                          }</TD></TR><TR CLASS="z"><TD CLASS="l">421</TD><TD>                          return false;</TD></TR><TR><TD CLASS="l">422</TD><TD>                  case Binding.FIELD:</TD></TR><TR><TD CLASS="l">423</TD><TD>                  case Binding.VARIABLE:</TD></TR><TR CLASS="z"><TD CLASS="l">424</TD><TD>                          if (element instanceof IField)</TD></TR><TR><TD CLASS="l">425</TD><TD>                          {</TD></TR><TR CLASS="z"><TD CLASS="l">426</TD><TD>                                  requestor.acceptField( (IField)element);</TD></TR><TR CLASS="z"><TD CLASS="l">427</TD><TD>                                  return true;</TD></TR><TR><TD CLASS="l">428</TD><TD>                          }</TD></TR><TR CLASS="z"><TD CLASS="l">429</TD><TD>                          return false;</TD></TR><TR><TD CLASS="l">430</TD><TD>                  case Binding.METHOD:</TD></TR><TR CLASS="z"><TD CLASS="l">431</TD><TD>                          if (element instanceof IFunction)</TD></TR><TR><TD CLASS="l">432</TD><TD>                          {</TD></TR><TR CLASS="z"><TD CLASS="l">433</TD><TD>                                  requestor.acceptMethod((IFunction)element);</TD></TR><TR CLASS="z"><TD CLASS="l">434</TD><TD>                                  return true;</TD></TR><TR><TD CLASS="l">435</TD><TD>                          }</TD></TR><TR><TD CLASS="l">436</TD><TD>                  case Binding.TYPE:</TD></TR><TR CLASS="z"><TD CLASS="l">437</TD><TD>                          if (element instanceof IType)</TD></TR><TR><TD CLASS="l">438</TD><TD>                          {</TD></TR><TR CLASS="z"><TD CLASS="l">439</TD><TD>                                  requestor.acceptType((IType)element);</TD></TR><TR CLASS="z"><TD CLASS="l">440</TD><TD>                                  return true;</TD></TR><TR><TD CLASS="l">441</TD><TD>                          }</TD></TR><TR><TD CLASS="l">442</TD><TD> </TD></TR><TR><TD CLASS="l">443</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">444</TD><TD>                return false;</TD></TR><TR><TD CLASS="l">445</TD><TD>        }</TD></TR><TR><TD CLASS="l">446</TD><TD> </TD></TR><TR><TD CLASS="l">447</TD><TD>        /**</TD></TR><TR><TD CLASS="l">448</TD><TD>         * Finds every type in the project whose simple name matches</TD></TR><TR><TD CLASS="l">449</TD><TD>         * the prefix, informing the requestor of each hit. The requestor</TD></TR><TR><TD CLASS="l">450</TD><TD>         * is polled for cancellation at regular intervals.</TD></TR><TR><TD CLASS="l">451</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="9">452</A></TD><TD>         * &lt;p&gt;The &lt;code&gt;partialMatch&lt;/code&gt; argument indicates partial matches</TD></TR><TR><TD CLASS="l">453</TD><TD>         * should be considered.</TD></TR><TR><TD CLASS="l">454</TD><TD>         */</TD></TR><TR><TD CLASS="l">455</TD><TD>        private void findAllTypes(String prefix, boolean partialMatch, int acceptFlags, IJavaElementRequestor requestor) {</TD></TR><TR CLASS="z"><TD CLASS="l">456</TD><TD>                int count= this.packageFragmentRoots.length;</TD></TR><TR CLASS="z"><TD CLASS="l">457</TD><TD>                for (int i= 0; i &lt; count; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">458</TD><TD>                        if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">459</TD><TD>                                return;</TD></TR><TR CLASS="z"><TD CLASS="l">460</TD><TD>                        IPackageFragmentRoot root= this.packageFragmentRoots[i];</TD></TR><TR CLASS="z"><TD CLASS="l">461</TD><TD>                        IJavaScriptElement[] packages= null;</TD></TR><TR><TD CLASS="l">462</TD><TD>                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">463</TD><TD>                                packages= root.getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">464</TD><TD>                        } catch (JavaScriptModelException npe) {</TD></TR><TR CLASS="z"><TD CLASS="l">465</TD><TD>                                continue; // the root is not present, continue;</TD></TR><TR><TD CLASS="l">466</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">467</TD><TD>                        if (packages != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">468</TD><TD>                                for (int j= 0, packageCount= packages.length; j &lt; packageCount; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">469</TD><TD>                                        if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">470</TD><TD>                                                return;</TD></TR><TR CLASS="z"><TD CLASS="l">471</TD><TD>                                        seekTypes(prefix, (IPackageFragment) packages[j], partialMatch, acceptFlags, requestor);</TD></TR><TR><TD CLASS="l">472</TD><TD>                                }</TD></TR><TR><TD CLASS="l">473</TD><TD>                        }</TD></TR><TR><TD CLASS="l"><A NAME="8">474</A></TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">475</TD><TD>        }</TD></TR><TR><TD CLASS="l">476</TD><TD> </TD></TR><TR><TD CLASS="l">477</TD><TD>        private void findAllBindings(String prefix,int bindingType, boolean partialMatch, int acceptFlags, IJavaElementRequestor requestor) {</TD></TR><TR CLASS="z"><TD CLASS="l">478</TD><TD>                int count= this.packageFragmentRoots.length;</TD></TR><TR CLASS="z"><TD CLASS="l">479</TD><TD>                for (int i= 0; i &lt; count; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">480</TD><TD>                        if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">481</TD><TD>                                return;</TD></TR><TR CLASS="z"><TD CLASS="l">482</TD><TD>                        IPackageFragmentRoot root= this.packageFragmentRoots[i];</TD></TR><TR CLASS="z"><TD CLASS="l">483</TD><TD>                        IJavaScriptElement[] packages= null;</TD></TR><TR><TD CLASS="l">484</TD><TD>                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">485</TD><TD>                                packages= root.getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">486</TD><TD>                        } catch (JavaScriptModelException npe) {</TD></TR><TR CLASS="z"><TD CLASS="l">487</TD><TD>                                continue; // the root is not present, continue;</TD></TR><TR><TD CLASS="l">488</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">489</TD><TD>                        if (packages != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">490</TD><TD>                                for (int j= 0, packageCount= packages.length; j &lt; packageCount; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">491</TD><TD>                                        if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">492</TD><TD>                                                return;</TD></TR><TR CLASS="z"><TD CLASS="l">493</TD><TD>                                        seekBindings(prefix,bindingType, (IPackageFragment) packages[j], partialMatch, acceptFlags, requestor);</TD></TR><TR><TD CLASS="l">494</TD><TD>                                }</TD></TR><TR><TD CLASS="l">495</TD><TD>                        }</TD></TR><TR><TD CLASS="l">496</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">497</TD><TD>        }</TD></TR><TR><TD CLASS="l">498</TD><TD> </TD></TR><TR><TD CLASS="l">499</TD><TD>        /**</TD></TR><TR><TD CLASS="l">500</TD><TD>         * Returns the &lt;code&gt;IJavaScriptUnit&lt;/code&gt; which defines the type</TD></TR><TR><TD CLASS="l">501</TD><TD>         * named &lt;code&gt;qualifiedTypeName&lt;/code&gt;, or &lt;code&gt;null&lt;/code&gt; if</TD></TR><TR><TD CLASS="l">502</TD><TD>         * none exists. The domain of the search is bounded by the classpath</TD></TR><TR><TD CLASS="l">503</TD><TD>         * of the &lt;code&gt;IJavaScriptProject&lt;/code&gt; this &lt;code&gt;NameLookup&lt;/code&gt; was</TD></TR><TR><TD CLASS="l">504</TD><TD>         * obtained from.</TD></TR><TR><TD CLASS="l"><A NAME="f">505</A></TD><TD>         * &lt;p&gt;</TD></TR><TR><TD CLASS="l">506</TD><TD>         * The name must be fully qualified (eg &#34;java.lang.Object&#34;, &#34;java.util.Hashtable$Entry&#34;)</TD></TR><TR><TD CLASS="l">507</TD><TD>         */</TD></TR><TR><TD CLASS="l">508</TD><TD>        public ITypeRoot findCompilationUnit(String qualifiedTypeName) {</TD></TR><TR CLASS="z"><TD CLASS="l">509</TD><TD>                String[] pkgName = CharOperation.NO_STRINGS;</TD></TR><TR CLASS="z"><TD CLASS="l">510</TD><TD>                String cuName = qualifiedTypeName;</TD></TR><TR><TD CLASS="l">511</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">512</TD><TD>                int index= qualifiedTypeName.lastIndexOf('.');</TD></TR><TR CLASS="z"><TD CLASS="l">513</TD><TD>                if (index != -1) {</TD></TR><TR CLASS="z"><TD CLASS="l">514</TD><TD>                        pkgName= Util.splitOn('.', qualifiedTypeName, 0, index);</TD></TR><TR CLASS="z"><TD CLASS="l">515</TD><TD>                        cuName= qualifiedTypeName.substring(index + 1);</TD></TR><TR><TD CLASS="l">516</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">517</TD><TD>                cuName=cuName.replace(CompilationUnitScope.FILENAME_DOT_SUBSTITUTION, '.');</TD></TR><TR CLASS="z"><TD CLASS="l">518</TD><TD>                index= cuName.indexOf('$');</TD></TR><TR CLASS="z"><TD CLASS="l">519</TD><TD>                if (index != -1) {</TD></TR><TR CLASS="z"><TD CLASS="l">520</TD><TD>                        cuName= cuName.substring(0, index);</TD></TR><TR><TD CLASS="l">521</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">522</TD><TD>                Object value = this.packageFragments.get(pkgName);</TD></TR><TR CLASS="z"><TD CLASS="l">523</TD><TD>                if (value != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">524</TD><TD>                        if (value instanceof PackageFragmentRoot) {</TD></TR><TR CLASS="z"><TD CLASS="l">525</TD><TD>                                return findCompilationUnit(pkgName, cuName, (PackageFragmentRoot) value);</TD></TR><TR><TD CLASS="l">526</TD><TD>                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">527</TD><TD>                                IPackageFragmentRoot[] roots = (IPackageFragmentRoot[]) value;</TD></TR><TR CLASS="z"><TD CLASS="l">528</TD><TD>                                for (int i= 0; i &lt; roots.length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">529</TD><TD>                                        PackageFragmentRoot root= (PackageFragmentRoot) roots[i];</TD></TR><TR CLASS="z"><TD CLASS="l">530</TD><TD>                                        ITypeRoot cu = findCompilationUnit(pkgName, cuName, root);</TD></TR><TR CLASS="z"><TD CLASS="l">531</TD><TD>                                        if (cu != null)</TD></TR><TR CLASS="z"><TD CLASS="l">532</TD><TD>                                                return cu;</TD></TR><TR><TD CLASS="l">533</TD><TD>                                }</TD></TR><TR><TD CLASS="l">534</TD><TD>                        }</TD></TR><TR><TD CLASS="l">535</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="e">536</A></TD><TD>                return null;</TD></TR><TR><TD CLASS="l">537</TD><TD>        }</TD></TR><TR><TD CLASS="l">538</TD><TD> </TD></TR><TR><TD CLASS="l">539</TD><TD>        private ITypeRoot findCompilationUnit(String[] pkgName, String cuName, PackageFragmentRoot root) {</TD></TR><TR CLASS="z"><TD CLASS="l">540</TD><TD>                if (!root.isArchive()) {</TD></TR><TR CLASS="z"><TD CLASS="l">541</TD><TD>                        IPackageFragment pkg = root.getPackageFragment(pkgName);</TD></TR><TR><TD CLASS="l">542</TD><TD>                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">543</TD><TD>                                IJavaScriptUnit[] cus = pkg.getJavaScriptUnits();</TD></TR><TR CLASS="z"><TD CLASS="l">544</TD><TD>                                for (int j = 0, length = cus.length; j &lt; length; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">545</TD><TD>                                        IJavaScriptUnit cu = cus[j];</TD></TR><TR CLASS="z"><TD CLASS="l">546</TD><TD>                                        if (Util.equalsIgnoreJavaLikeExtension(cu.getElementName(), cuName))</TD></TR><TR CLASS="z"><TD CLASS="l">547</TD><TD>                                                return cu;</TD></TR><TR><TD CLASS="l">548</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">549</TD><TD>                                IClassFile[] classFiles = pkg.getClassFiles();</TD></TR><TR CLASS="z"><TD CLASS="l">550</TD><TD>                                for (int j = 0, length = classFiles.length; j &lt; length; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">551</TD><TD>                                        IClassFile cu = classFiles[j];</TD></TR><TR CLASS="z"><TD CLASS="l">552</TD><TD>                                        if (Util.equalsIgnoreJavaLikeExtension(cu.getElementName(), cuName))</TD></TR><TR CLASS="z"><TD CLASS="l">553</TD><TD>                                                return cu;</TD></TR><TR><TD CLASS="l">554</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">555</TD><TD>                        } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">556</TD><TD>                                // pkg does not exist</TD></TR><TR><TD CLASS="l">557</TD><TD>                                // -&gt; try next package</TD></TR><TR><TD CLASS="l">558</TD><TD>                        }</TD></TR><TR><TD CLASS="l">559</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">560</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">561</TD><TD>}</TD></TR><TR><TD CLASS="l">562</TD><TD> </TD></TR><TR><TD CLASS="l">563</TD><TD>        /**</TD></TR><TR><TD CLASS="l">564</TD><TD>         * Returns the package fragment whose path matches the given</TD></TR><TR><TD CLASS="l">565</TD><TD>         * (absolute) path, or &lt;code&gt;null&lt;/code&gt; if none exist. The domain of</TD></TR><TR><TD CLASS="l">566</TD><TD>         * the search is bounded by the classpath of the &lt;code&gt;IJavaScriptProject&lt;/code&gt;</TD></TR><TR><TD CLASS="l">567</TD><TD>         * this &lt;code&gt;NameLookup&lt;/code&gt; was obtained from.</TD></TR><TR><TD CLASS="l">568</TD><TD>         * The path can be:</TD></TR><TR><TD CLASS="l"><A NAME="10">569</A></TD><TD>         *         - internal to the workbench: &#34;/Project/src&#34;</TD></TR><TR><TD CLASS="l">570</TD><TD>         *  - external to the workbench: &#34;c:/jdk/classes.zip/java/lang&#34;</TD></TR><TR><TD CLASS="l">571</TD><TD>         */</TD></TR><TR><TD CLASS="l">572</TD><TD>        public IPackageFragment findPackageFragment(IPath path) {</TD></TR><TR CLASS="z"><TD CLASS="l">573</TD><TD>                if (!path.isAbsolute()) {</TD></TR><TR CLASS="z"><TD CLASS="l">574</TD><TD>                        throw new IllegalArgumentException(Messages.path_mustBeAbsolute);</TD></TR><TR><TD CLASS="l">575</TD><TD>                }</TD></TR><TR><TD CLASS="l">576</TD><TD>/*</TD></TR><TR><TD CLASS="l">577</TD><TD> * TODO (jerome) this code should rather use the package fragment map to find the candidate package, then</TD></TR><TR><TD CLASS="l">578</TD><TD> * check if the respective enclosing root maps to the one on this given IPath.</TD></TR><TR><TD CLASS="l">579</TD><TD> */</TD></TR><TR CLASS="z"><TD CLASS="l">580</TD><TD>                IResource possibleFragment = ResourcesPlugin.getWorkspace().getRoot().findMember(path);</TD></TR><TR CLASS="z"><TD CLASS="l">581</TD><TD>                if (possibleFragment == null) {</TD></TR><TR><TD CLASS="l">582</TD><TD>                        //external jar</TD></TR><TR CLASS="z"><TD CLASS="l">583</TD><TD>                        for (int i = 0; i &lt; this.packageFragmentRoots.length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">584</TD><TD>                                IPackageFragmentRoot root = this.packageFragmentRoots[i];</TD></TR><TR CLASS="z"><TD CLASS="l">585</TD><TD>                                if (!root.isExternal()) {</TD></TR><TR CLASS="z"><TD CLASS="l">586</TD><TD>                                        continue;</TD></TR><TR><TD CLASS="l">587</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">588</TD><TD>                                IPath rootPath = root.getPath();</TD></TR><TR CLASS="z"><TD CLASS="l">589</TD><TD>                                int matchingCount = rootPath.matchingFirstSegments(path);</TD></TR><TR CLASS="z"><TD CLASS="l">590</TD><TD>                                if (matchingCount != 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">591</TD><TD>                                        String name = path.toOSString();</TD></TR><TR><TD CLASS="l">592</TD><TD>                                        // + 1 is for the File.separatorChar</TD></TR><TR CLASS="z"><TD CLASS="l">593</TD><TD>                                        name = name.substring(rootPath.toOSString().length() + 1, name.length());</TD></TR><TR CLASS="z"><TD CLASS="l">594</TD><TD>                                        name = name.replace(File.separatorChar, '.');</TD></TR><TR CLASS="z"><TD CLASS="l">595</TD><TD>                                        IJavaScriptElement[] list = null;</TD></TR><TR><TD CLASS="l">596</TD><TD>                                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">597</TD><TD>                                                list = root.getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">598</TD><TD>                                        } catch (JavaScriptModelException npe) {</TD></TR><TR CLASS="z"><TD CLASS="l">599</TD><TD>                                                continue; // the package fragment root is not present;</TD></TR><TR><TD CLASS="l">600</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">601</TD><TD>                                        int elementCount = list.length;</TD></TR><TR CLASS="z"><TD CLASS="l">602</TD><TD>                                        for (int j = 0; j &lt; elementCount; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">603</TD><TD>                                                IPackageFragment packageFragment = (IPackageFragment) list[j];</TD></TR><TR CLASS="z"><TD CLASS="l">604</TD><TD>                                                if (nameMatches(name, packageFragment, false)) {</TD></TR><TR CLASS="z"><TD CLASS="l">605</TD><TD>                                                        return packageFragment;</TD></TR><TR><TD CLASS="l">606</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">607</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">608</TD><TD>                                }</TD></TR><TR><TD CLASS="l">609</TD><TD>                        }</TD></TR><TR><TD CLASS="l">610</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">611</TD><TD>                        IJavaScriptElement fromFactory = JavaScriptCore.create(possibleFragment);</TD></TR><TR CLASS="z"><TD CLASS="l">612</TD><TD>                        if (fromFactory == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">613</TD><TD>                                return null;</TD></TR><TR><TD CLASS="l">614</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">615</TD><TD>                        switch (fromFactory.getElementType()) {</TD></TR><TR><TD CLASS="l">616</TD><TD>                                case IJavaScriptElement.PACKAGE_FRAGMENT:</TD></TR><TR CLASS="z"><TD CLASS="l">617</TD><TD>                                        return (IPackageFragment) fromFactory;</TD></TR><TR><TD CLASS="l">618</TD><TD>                                case IJavaScriptElement.JAVASCRIPT_PROJECT:</TD></TR><TR><TD CLASS="l">619</TD><TD>                                        // default package in a default root</TD></TR><TR CLASS="z"><TD CLASS="l">620</TD><TD>                                        JavaProject project = (JavaProject) fromFactory;</TD></TR><TR><TD CLASS="l">621</TD><TD>                                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">622</TD><TD>                                                IIncludePathEntry entry = project.getClasspathEntryFor(path);</TD></TR><TR CLASS="z"><TD CLASS="l">623</TD><TD>                                                if (entry != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">624</TD><TD>                                                        IPackageFragmentRoot root =</TD></TR><TR CLASS="z"><TD CLASS="l">625</TD><TD>                                                                project.getPackageFragmentRoot(project.getResource());</TD></TR><TR CLASS="z"><TD CLASS="l">626</TD><TD>                                                        Object defaultPkgRoot = this.packageFragments.get(CharOperation.NO_STRINGS);</TD></TR><TR CLASS="z"><TD CLASS="l">627</TD><TD>                                                        if (defaultPkgRoot == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">628</TD><TD>                                                                return null;</TD></TR><TR><TD CLASS="l">629</TD><TD>                                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">630</TD><TD>                                                        if (defaultPkgRoot instanceof PackageFragmentRoot &amp;&amp; defaultPkgRoot.equals(root))</TD></TR><TR CLASS="z"><TD CLASS="l">631</TD><TD>                                                                return  ((PackageFragmentRoot) root).getPackageFragment(CharOperation.NO_STRINGS);</TD></TR><TR><TD CLASS="l">632</TD><TD>                                                        else {</TD></TR><TR CLASS="z"><TD CLASS="l">633</TD><TD>                                                                IPackageFragmentRoot[] roots = (IPackageFragmentRoot[]) defaultPkgRoot;</TD></TR><TR CLASS="z"><TD CLASS="l">634</TD><TD>                                                                for (int i = 0; i &lt; roots.length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">635</TD><TD>                                                                        if (roots[i].equals(root)) {</TD></TR><TR CLASS="z"><TD CLASS="l">636</TD><TD>                                                                                return  ((PackageFragmentRoot) root).getPackageFragment(CharOperation.NO_STRINGS);</TD></TR><TR><TD CLASS="l">637</TD><TD>                                                                        }</TD></TR><TR><TD CLASS="l">638</TD><TD>                                                                }</TD></TR><TR><TD CLASS="l">639</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">640</TD><TD>                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">641</TD><TD>                                        } catch (JavaScriptModelException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">642</TD><TD>                                                return null;</TD></TR><TR><TD CLASS="l">643</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">644</TD><TD>                                        return null;</TD></TR><TR><TD CLASS="l">645</TD><TD>                                case IJavaScriptElement.PACKAGE_FRAGMENT_ROOT:</TD></TR><TR CLASS="z"><TD CLASS="l">646</TD><TD>                                        return ((PackageFragmentRoot)fromFactory).getPackageFragment(CharOperation.NO_STRINGS);</TD></TR><TR><TD CLASS="l">647</TD><TD>                        }</TD></TR><TR><TD CLASS="l">648</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">649</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">650</TD><TD>        }</TD></TR><TR><TD CLASS="l">651</TD><TD> </TD></TR><TR><TD CLASS="l">652</TD><TD>        /**</TD></TR><TR><TD CLASS="l">653</TD><TD>         * Returns the package fragments whose name matches the given</TD></TR><TR><TD CLASS="l">654</TD><TD>         * (qualified) name, or &lt;code&gt;null&lt;/code&gt; if none exist.</TD></TR><TR><TD CLASS="l">655</TD><TD>         *</TD></TR><TR><TD CLASS="l">656</TD><TD>         * The name can be:</TD></TR><TR><TD CLASS="l">657</TD><TD>         * &lt;ul&gt;</TD></TR><TR><TD CLASS="l">658</TD><TD>         *                &lt;li&gt;empty: &#34;&#34;&lt;/li&gt;</TD></TR><TR><TD CLASS="l">659</TD><TD>         *                &lt;li&gt;qualified: &#34;pack.pack1.pack2&#34;&lt;/li&gt;</TD></TR><TR><TD CLASS="l">660</TD><TD>         * &lt;/ul&gt;</TD></TR><TR><TD CLASS="l"><A NAME="11">661</A></TD><TD>         * @param partialMatch partial name matches qualify when &lt;code&gt;true&lt;/code&gt;,</TD></TR><TR><TD CLASS="l">662</TD><TD>         *        only exact name matches qualify when &lt;code&gt;false&lt;/code&gt;</TD></TR><TR><TD CLASS="l">663</TD><TD>         */</TD></TR><TR><TD CLASS="l">664</TD><TD>        public IPackageFragment[] findPackageFragments(String name, boolean partialMatch) {</TD></TR><TR CLASS="z"><TD CLASS="l">665</TD><TD>                return findPackageFragments(name, partialMatch, false);</TD></TR><TR><TD CLASS="l">666</TD><TD>        }</TD></TR><TR><TD CLASS="l">667</TD><TD> </TD></TR><TR><TD CLASS="l">668</TD><TD>        /**</TD></TR><TR><TD CLASS="l">669</TD><TD>         * Returns the package fragments whose name matches the given</TD></TR><TR><TD CLASS="l">670</TD><TD>         * (qualified) name or pattern, or &lt;code&gt;null&lt;/code&gt; if none exist.</TD></TR><TR><TD CLASS="l">671</TD><TD>         *</TD></TR><TR><TD CLASS="l">672</TD><TD>         * The name can be:</TD></TR><TR><TD CLASS="l">673</TD><TD>         * &lt;ul&gt;</TD></TR><TR><TD CLASS="l">674</TD><TD>         *                &lt;li&gt;empty: &#34;&#34;&lt;/li&gt;</TD></TR><TR><TD CLASS="l">675</TD><TD>         *                &lt;li&gt;qualified: &#34;pack.pack1.pack2&#34;&lt;/li&gt;</TD></TR><TR><TD CLASS="l">676</TD><TD>         *         &lt;li&gt;a pattern: &#34;pack.*.util&#34;&lt;/li&gt;</TD></TR><TR><TD CLASS="l">677</TD><TD>         * &lt;/ul&gt;</TD></TR><TR><TD CLASS="l">678</TD><TD>         * @param partialMatch partial name matches qualify when &lt;code&gt;true&lt;/code&gt;,</TD></TR><TR><TD CLASS="l"><A NAME="12">679</A></TD><TD>         * @param patternMatch &lt;code&gt;true&lt;/code&gt; when the given name might be a pattern,</TD></TR><TR><TD CLASS="l">680</TD><TD>         *                &lt;code&gt;false&lt;/code&gt; otherwise.</TD></TR><TR><TD CLASS="l">681</TD><TD>         */</TD></TR><TR><TD CLASS="l">682</TD><TD>        public IPackageFragment[] findPackageFragments(String name, boolean partialMatch, boolean patternMatch) {</TD></TR><TR CLASS="z"><TD CLASS="l">683</TD><TD>                ArrayList fragRootChildren = new ArrayList();</TD></TR><TR CLASS="z"><TD CLASS="l">684</TD><TD>                for (int i = 0; i &lt; this.packageFragmentRoots.length; i++) {</TD></TR><TR><TD CLASS="l">685</TD><TD>                        IJavaScriptElement[] children;</TD></TR><TR><TD CLASS="l">686</TD><TD>                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">687</TD><TD>                                children = packageFragmentRoots[i].getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">688</TD><TD>                                for (int j = 0; j &lt; children.length; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">689</TD><TD>                                        IPackageFragment packageFragment = (IPackageFragment)children[j];</TD></TR><TR CLASS="z"><TD CLASS="l">690</TD><TD>                                        if(packageFragment!=null &amp;&amp; packageFragment.getElementName().equals(name))</TD></TR><TR CLASS="z"><TD CLASS="l">691</TD><TD>                                                fragRootChildren.add((packageFragment));</TD></TR><TR><TD CLASS="l">692</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">693</TD><TD>                        } catch (JavaScriptModelException e) {}</TD></TR><TR><TD CLASS="l">694</TD><TD> </TD></TR><TR><TD CLASS="l">695</TD><TD>                }</TD></TR><TR><TD CLASS="l">696</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">697</TD><TD>                return (IPackageFragment[])fragRootChildren.toArray(new IPackageFragment[fragRootChildren.size()]);</TD></TR><TR><TD CLASS="l">698</TD><TD>                //                if (partialMatch) {</TD></TR><TR><TD CLASS="l">699</TD><TD>//                        String[] splittedName = Util.splitOn('.', name, 0, name.length());</TD></TR><TR><TD CLASS="l">700</TD><TD>//                        IPackageFragment[] oneFragment = null;</TD></TR><TR><TD CLASS="l">701</TD><TD>//                        ArrayList pkgs = null;</TD></TR><TR><TD CLASS="l">702</TD><TD>//                        Object[][] keys = this.packageFragments.keyTable;</TD></TR><TR><TD CLASS="l">703</TD><TD>//                        for (int i = 0, length = keys.length; i &lt; length; i++) {</TD></TR><TR><TD CLASS="l">704</TD><TD>//                                String[] pkgName = (String[]) keys[i];</TD></TR><TR><TD CLASS="l">705</TD><TD>//                                if (pkgName != null &amp;&amp; Util.startsWithIgnoreCase(pkgName, splittedName)) {</TD></TR><TR><TD CLASS="l">706</TD><TD>//                                        Object value = this.packageFragments.valueTable[i];</TD></TR><TR><TD CLASS="l">707</TD><TD>//                                        if (value instanceof PackageFragmentRoot) {</TD></TR><TR><TD CLASS="l">708</TD><TD>//                                                IPackageFragment pkg = ((PackageFragmentRoot) value).getPackageFragment(pkgName);</TD></TR><TR><TD CLASS="l">709</TD><TD>//                                                if (oneFragment == null) {</TD></TR><TR><TD CLASS="l">710</TD><TD>//                                                        oneFragment = new IPackageFragment[] {pkg};</TD></TR><TR><TD CLASS="l">711</TD><TD>//                                                } else {</TD></TR><TR><TD CLASS="l">712</TD><TD>//                                                        if (pkgs == null) {</TD></TR><TR><TD CLASS="l">713</TD><TD>//                                                                pkgs = new ArrayList();</TD></TR><TR><TD CLASS="l">714</TD><TD>//                                                                pkgs.add(oneFragment[0]);</TD></TR><TR><TD CLASS="l">715</TD><TD>//                                                        }</TD></TR><TR><TD CLASS="l">716</TD><TD>//                                                        pkgs.add(pkg);</TD></TR><TR><TD CLASS="l">717</TD><TD>//                                                }</TD></TR><TR><TD CLASS="l">718</TD><TD>//                                        } else {</TD></TR><TR><TD CLASS="l">719</TD><TD>//                                                IPackageFragmentRoot[] roots = (IPackageFragmentRoot[]) value;</TD></TR><TR><TD CLASS="l">720</TD><TD>//                                                for (int j = 0, length2 = roots.length; j &lt; length2; j++) {</TD></TR><TR><TD CLASS="l">721</TD><TD>//                                                        PackageFragmentRoot root = (PackageFragmentRoot) roots[j];</TD></TR><TR><TD CLASS="l">722</TD><TD>//                                                        IPackageFragment pkg = root.getPackageFragment(pkgName);</TD></TR><TR><TD CLASS="l">723</TD><TD>//                                                        if (oneFragment == null) {</TD></TR><TR><TD CLASS="l">724</TD><TD>//                                                                oneFragment = new IPackageFragment[] {pkg};</TD></TR><TR><TD CLASS="l">725</TD><TD>//                                                        } else {</TD></TR><TR><TD CLASS="l">726</TD><TD>//                                                                if (pkgs == null) {</TD></TR><TR><TD CLASS="l">727</TD><TD>//                                                                        pkgs = new ArrayList();</TD></TR><TR><TD CLASS="l">728</TD><TD>//                                                                        pkgs.add(oneFragment[0]);</TD></TR><TR><TD CLASS="l">729</TD><TD>//                                                                }</TD></TR><TR><TD CLASS="l">730</TD><TD>//                                                                pkgs.add(pkg);</TD></TR><TR><TD CLASS="l">731</TD><TD>//                                                        }</TD></TR><TR><TD CLASS="l">732</TD><TD>//                                                }</TD></TR><TR><TD CLASS="l">733</TD><TD>//                                        }</TD></TR><TR><TD CLASS="l">734</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">735</TD><TD>//                        }</TD></TR><TR><TD CLASS="l">736</TD><TD>//                        if (pkgs == null) return oneFragment;</TD></TR><TR><TD CLASS="l">737</TD><TD>//                        int resultLength = pkgs.size();</TD></TR><TR><TD CLASS="l">738</TD><TD>//                        IPackageFragment[] result = new IPackageFragment[resultLength];</TD></TR><TR><TD CLASS="l">739</TD><TD>//                        pkgs.toArray(result);</TD></TR><TR><TD CLASS="l">740</TD><TD>//                        return result;</TD></TR><TR><TD CLASS="l">741</TD><TD>//                } else {</TD></TR><TR><TD CLASS="l">742</TD><TD>//                        String[] splittedName = (name.length()&gt;0)? new String[]{name}: new String[0];//Util.splitOn('.', name, 0, name.length());</TD></TR><TR><TD CLASS="l">743</TD><TD>//                        Object value = this.packageFragments.get(splittedName);</TD></TR><TR><TD CLASS="l">744</TD><TD>//                        if (value==null)</TD></TR><TR><TD CLASS="l">745</TD><TD>//                                value=this.packageFragments.get(new String[]{name});</TD></TR><TR><TD CLASS="l">746</TD><TD>//                        if (value == null)</TD></TR><TR><TD CLASS="l">747</TD><TD>//                                return null;</TD></TR><TR><TD CLASS="l">748</TD><TD>//                        if (value instanceof PackageFragmentRoot) {</TD></TR><TR><TD CLASS="l">749</TD><TD>//                                return new IPackageFragment[] {((PackageFragmentRoot) value).getPackageFragment(splittedName)};</TD></TR><TR><TD CLASS="l">750</TD><TD>//                        } else {</TD></TR><TR><TD CLASS="l">751</TD><TD>//                                IPackageFragmentRoot[] roots = (IPackageFragmentRoot[]) value;</TD></TR><TR><TD CLASS="l">752</TD><TD>//                                IPackageFragment[] result = new IPackageFragment[roots.length];</TD></TR><TR><TD CLASS="l">753</TD><TD>//                                for (int i= 0; i &lt; roots.length; i++) {</TD></TR><TR><TD CLASS="l">754</TD><TD>//                                        result[i] = ((PackageFragmentRoot) roots[i]).getPackageFragment(splittedName);</TD></TR><TR><TD CLASS="l">755</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">756</TD><TD>//                                return result;</TD></TR><TR><TD CLASS="l">757</TD><TD>//                        }</TD></TR><TR><TD CLASS="l">758</TD><TD>//                }</TD></TR><TR><TD CLASS="l">759</TD><TD>        }</TD></TR><TR><TD CLASS="l">760</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="13">761</A></TD><TD>        /*</TD></TR><TR><TD CLASS="l">762</TD><TD>         * Find secondary type for a project.</TD></TR><TR><TD CLASS="l">763</TD><TD>         */</TD></TR><TR><TD CLASS="l">764</TD><TD>        private IType findSecondaryType(String packageName, String typeName, IJavaScriptProject project, boolean waitForIndexes, IProgressMonitor monitor) {</TD></TR><TR CLASS="z"><TD CLASS="l">765</TD><TD>                if (JavaModelManager.VERBOSE) {</TD></TR><TR CLASS="z"><TD CLASS="l">766</TD><TD>                        Util.verbose(&#34;NameLookup FIND SECONDARY TYPES:&#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">767</TD><TD>                        Util.verbose(&#34; -&gt; pkg name: &#34; + packageName);  //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">768</TD><TD>                        Util.verbose(&#34; -&gt; type name: &#34; + typeName);  //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">769</TD><TD>                        Util.verbose(&#34; -&gt; project: &#34;+project.getElementName()); //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">770</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">771</TD><TD>                JavaModelManager manager = JavaModelManager.getJavaModelManager();</TD></TR><TR><TD CLASS="l">772</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">773</TD><TD>                        IJavaScriptProject javaProject = project;</TD></TR><TR CLASS="z"><TD CLASS="l">774</TD><TD>                        Map secondaryTypePaths = manager.secondaryTypes(javaProject, waitForIndexes, monitor);</TD></TR><TR CLASS="z"><TD CLASS="l">775</TD><TD>                        if (secondaryTypePaths.size() &gt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">776</TD><TD>                                Map types = (Map) secondaryTypePaths.get(packageName==null?&#34;&#34;:packageName); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">777</TD><TD>                                if (types != null &amp;&amp; types.size() &gt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">778</TD><TD>                                        IType type = (IType) types.get(typeName);</TD></TR><TR CLASS="z"><TD CLASS="l">779</TD><TD>                                        if (type != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">780</TD><TD>                                                if (JavaModelManager.VERBOSE) {</TD></TR><TR CLASS="z"><TD CLASS="l">781</TD><TD>                                                        Util.verbose(&#34; -&gt; type: &#34; + type.getElementName());  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">782</TD><TD>                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">783</TD><TD>                                                return type;</TD></TR><TR><TD CLASS="l">784</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">785</TD><TD>                                }</TD></TR><TR><TD CLASS="l">786</TD><TD>                        }</TD></TR><TR><TD CLASS="l">787</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">788</TD><TD>                catch (JavaScriptModelException jme) {</TD></TR><TR><TD CLASS="l">789</TD><TD>                        // give up</TD></TR><TR><TD CLASS="l">790</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">791</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">792</TD><TD>        }</TD></TR><TR><TD CLASS="l">793</TD><TD> </TD></TR><TR><TD CLASS="l">794</TD><TD>        /**</TD></TR><TR><TD CLASS="l">795</TD><TD>         * Find type considering secondary types but without waiting for indexes.</TD></TR><TR><TD CLASS="l">796</TD><TD>         * It means that secondary types may be not found under certain circumstances...</TD></TR><TR><TD CLASS="l"><A NAME="16">797</A></TD><TD>         * @see &#34;https://bugs.eclipse.org/bugs/show_bug.cgi?id=118789&#34;</TD></TR><TR><TD CLASS="l">798</TD><TD>         */</TD></TR><TR><TD CLASS="l">799</TD><TD>        public Answer findType(String typeName, String packageName, boolean partialMatch, int acceptFlags, boolean checkRestrictions) {</TD></TR><TR><TD CLASS="l">800</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">801</TD><TD>                if (USE_BINDING_SEARCH &amp;&amp; this.searchFiles)</TD></TR><TR><TD CLASS="l">802</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">803</TD><TD>                        Answer answer =findBindingSearch(typeName, packageName, Binding.TYPE, partialMatch, acceptFlags, true, true, checkRestrictions, null,false,null);</TD></TR><TR CLASS="z"><TD CLASS="l">804</TD><TD>                        if (answer!=null &amp;&amp; answer.type==null &amp;&amp; answer.element instanceof ITypeRoot)</TD></TR><TR><TD CLASS="l">805</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">806</TD><TD>                                ITypeRoot typeroot=(ITypeRoot)answer.element;</TD></TR><TR CLASS="z"><TD CLASS="l">807</TD><TD>                                answer.type=typeroot.getType(typeName);</TD></TR><TR><TD CLASS="l">808</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">809</TD><TD>                        return answer;</TD></TR><TR><TD CLASS="l">810</TD><TD>                }</TD></TR><TR><TD CLASS="l">811</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">812</TD><TD>                return findType(typeName,</TD></TR><TR CLASS="z"><TD CLASS="l">813</TD><TD>                        packageName,</TD></TR><TR CLASS="z"><TD CLASS="l">814</TD><TD>                        partialMatch,</TD></TR><TR CLASS="z"><TD CLASS="l">815</TD><TD>                        acceptFlags,</TD></TR><TR CLASS="z"><TD CLASS="l">816</TD><TD>                        true/* consider secondary types */,</TD></TR><TR CLASS="z"><TD CLASS="l">817</TD><TD>                        false/* do NOT wait for indexes */,</TD></TR><TR CLASS="z"><TD CLASS="l">818</TD><TD>                        checkRestrictions,</TD></TR><TR CLASS="z"><TD CLASS="l">819</TD><TD>                        null);</TD></TR><TR><TD CLASS="l">820</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="a">821</A></TD><TD> </TD></TR><TR><TD CLASS="l">822</TD><TD>        public Answer findBinding(String typeName, String packageName,int type, boolean partialMatch,</TD></TR><TR><TD CLASS="l">823</TD><TD>                        int acceptFlags, boolean checkRestrictions, boolean returnMultiple , String excludePath){</TD></TR><TR><TD CLASS="l">824</TD><TD>                </TD></TR><TR CLASS="z"><TD CLASS="l">825</TD><TD>                if ((type&amp;Binding.COMPILATION_UNIT)!=0)</TD></TR><TR><TD CLASS="l">826</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">827</TD><TD>                        String fullName=typeName;</TD></TR><TR CLASS="z"><TD CLASS="l">828</TD><TD>                        if (packageName.length()&gt;0)</TD></TR><TR CLASS="z"><TD CLASS="l">829</TD><TD>                                fullName=packageName+&#34;.&#34;+typeName;</TD></TR><TR CLASS="z"><TD CLASS="l">830</TD><TD>                        ITypeRoot compilationUnit = findCompilationUnit(fullName);</TD></TR><TR CLASS="z"><TD CLASS="l">831</TD><TD>                        if (compilationUnit!=null )</TD></TR><TR><TD CLASS="l">832</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">833</TD><TD>                                return new Answer(compilationUnit, null);</TD></TR><TR><TD CLASS="l">834</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">835</TD><TD>                        type &amp;= ~Binding.COMPILATION_UNIT;</TD></TR><TR CLASS="z"><TD CLASS="l">836</TD><TD>                        if (type==0)</TD></TR><TR CLASS="z"><TD CLASS="l">837</TD><TD>                                return null;</TD></TR><TR><TD CLASS="l">838</TD><TD>                }</TD></TR><TR><TD CLASS="l">839</TD><TD>                </TD></TR><TR CLASS="z"><TD CLASS="l">840</TD><TD>                if ((type&amp;Binding.PACKAGE)!=0)</TD></TR><TR><TD CLASS="l">841</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">842</TD><TD>                        type &amp;= ~Binding.PACKAGE;</TD></TR><TR CLASS="z"><TD CLASS="l">843</TD><TD>                        if (type==0)</TD></TR><TR CLASS="z"><TD CLASS="l">844</TD><TD>                                return null;</TD></TR><TR><TD CLASS="l">845</TD><TD>                }</TD></TR><TR><TD CLASS="l">846</TD><TD>                </TD></TR><TR CLASS="z"><TD CLASS="l">847</TD><TD>                if (USE_BINDING_SEARCH &amp;&amp; searchFiles)</TD></TR><TR CLASS="z"><TD CLASS="l">848</TD><TD>                return findBindingSearch(typeName,</TD></TR><TR CLASS="z"><TD CLASS="l">849</TD><TD>                        packageName,</TD></TR><TR CLASS="z"><TD CLASS="l">850</TD><TD>                        type,</TD></TR><TR CLASS="z"><TD CLASS="l">851</TD><TD>                        partialMatch,</TD></TR><TR CLASS="z"><TD CLASS="l">852</TD><TD>                        acceptFlags,</TD></TR><TR CLASS="z"><TD CLASS="l">853</TD><TD>                        true/* consider secondary types */,</TD></TR><TR CLASS="z"><TD CLASS="l">854</TD><TD>                        false/* do NOT wait for indexes */,</TD></TR><TR CLASS="z"><TD CLASS="l">855</TD><TD>                        checkRestrictions,</TD></TR><TR CLASS="z"><TD CLASS="l">856</TD><TD>                        null,  returnMultiple,  excludePath);</TD></TR><TR CLASS="z"><TD CLASS="l">857</TD><TD>                return findBinding(typeName,</TD></TR><TR CLASS="z"><TD CLASS="l">858</TD><TD>                                packageName,</TD></TR><TR CLASS="z"><TD CLASS="l">859</TD><TD>                                type,</TD></TR><TR CLASS="z"><TD CLASS="l">860</TD><TD>                                partialMatch,</TD></TR><TR CLASS="z"><TD CLASS="l">861</TD><TD>                                acceptFlags,</TD></TR><TR CLASS="z"><TD CLASS="l">862</TD><TD>                                true/* consider secondary types */,</TD></TR><TR CLASS="z"><TD CLASS="l">863</TD><TD>                                false/* do NOT wait for indexes */,</TD></TR><TR CLASS="z"><TD CLASS="l">864</TD><TD>                                checkRestrictions,</TD></TR><TR CLASS="z"><TD CLASS="l">865</TD><TD>                                null);</TD></TR><TR><TD CLASS="l">866</TD><TD>        }</TD></TR><TR><TD CLASS="l">867</TD><TD> </TD></TR><TR><TD CLASS="l">868</TD><TD>        /* return all CUs defining a type */</TD></TR><TR><TD CLASS="l">869</TD><TD>        /**</TD></TR><TR><TD CLASS="l">870</TD><TD>         * Returns all compilationUnits containing a specific type</TD></TR><TR><TD CLASS="l">871</TD><TD>         *</TD></TR><TR><TD CLASS="l">872</TD><TD>         * NOT FULLY IMPLEMENTED YET.</TD></TR><TR><TD CLASS="l">873</TD><TD>         *</TD></TR><TR><TD CLASS="l">874</TD><TD>         * @param typeName</TD></TR><TR><TD CLASS="l">875</TD><TD>         * @param waitForIndexes</TD></TR><TR><TD CLASS="l">876</TD><TD>         * @return all found compilationUnits containg [typeName]</TD></TR><TR><TD CLASS="l"><A NAME="1b">877</A></TD><TD>         */</TD></TR><TR><TD CLASS="l">878</TD><TD>        public IJavaScriptUnit[] findTypeSources(String typeName, boolean waitForIndexes) {</TD></TR><TR><TD CLASS="l">879</TD><TD> </TD></TR><TR><TD CLASS="l">880</TD><TD>                // Look for concerned package fragments</TD></TR><TR CLASS="z"><TD CLASS="l">881</TD><TD>                JavaElementRequestor elementRequestor = new JavaElementRequestor();</TD></TR><TR CLASS="z"><TD CLASS="l">882</TD><TD>                seekPackageFragments(IPackageFragment.DEFAULT_PACKAGE_NAME, false, elementRequestor);</TD></TR><TR CLASS="z"><TD CLASS="l">883</TD><TD>                IPackageFragment[] packages= elementRequestor.getPackageFragments();</TD></TR><TR><TD CLASS="l">884</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">885</TD><TD>                IType type = null;</TD></TR><TR CLASS="z"><TD CLASS="l">886</TD><TD>                int length= packages.length;</TD></TR><TR CLASS="z"><TD CLASS="l">887</TD><TD>                HashSet projects = null;</TD></TR><TR CLASS="z"><TD CLASS="l">888</TD><TD>                IJavaScriptProject javaProject = null;</TD></TR><TR><TD CLASS="l">889</TD><TD>//                Answer suggestedAnswer = null;</TD></TR><TR CLASS="z"><TD CLASS="l">890</TD><TD>                ArrayList found = new ArrayList();</TD></TR><TR><TD CLASS="l">891</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">892</TD><TD>                for (int i= 0; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">893</TD><TD>                        type = findType(typeName, packages[i], false, NameLookup.ACCEPT_ALL);</TD></TR><TR CLASS="z"><TD CLASS="l">894</TD><TD>                        if (type != null &amp;&amp; type.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">895</TD><TD>                                found.add(type);</TD></TR><TR><TD CLASS="l">896</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">897</TD><TD>                        if (javaProject == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">898</TD><TD>                                javaProject = packages[i].getJavaScriptProject();</TD></TR><TR CLASS="z"><TD CLASS="l">899</TD><TD>                        } else if (projects == null)  {</TD></TR><TR CLASS="z"><TD CLASS="l">900</TD><TD>                                if (!javaProject.equals(packages[i].getJavaScriptProject())) {</TD></TR><TR CLASS="z"><TD CLASS="l">901</TD><TD>                                        projects = new HashSet(3);</TD></TR><TR CLASS="z"><TD CLASS="l">902</TD><TD>                                        projects.add(javaProject);</TD></TR><TR CLASS="z"><TD CLASS="l">903</TD><TD>                                        projects.add(packages[i].getJavaScriptProject());</TD></TR><TR><TD CLASS="l">904</TD><TD>                                }</TD></TR><TR><TD CLASS="l">905</TD><TD>                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">906</TD><TD>                                projects.add(packages[i].getJavaScriptProject());</TD></TR><TR><TD CLASS="l">907</TD><TD>                        }</TD></TR><TR><TD CLASS="l">908</TD><TD> </TD></TR><TR><TD CLASS="l">909</TD><TD>                }</TD></TR><TR><TD CLASS="l">910</TD><TD> </TD></TR><TR><TD CLASS="l">911</TD><TD>                // If type was not found, try to find it as secondary in source folders</TD></TR><TR CLASS="z"><TD CLASS="l">912</TD><TD>                if (javaProject != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">913</TD><TD>                        if (projects == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">914</TD><TD>                                type = findSecondaryType(IPackageFragment.DEFAULT_PACKAGE_NAME, typeName, javaProject, waitForIndexes, new NullProgressMonitor());</TD></TR><TR><TD CLASS="l">915</TD><TD>                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">916</TD><TD>                                Iterator allProjects = projects.iterator();</TD></TR><TR CLASS="z"><TD CLASS="l">917</TD><TD>                                while (type == null &amp;&amp; allProjects.hasNext()) {</TD></TR><TR CLASS="z"><TD CLASS="l">918</TD><TD>                                        type = findSecondaryType(IPackageFragment.DEFAULT_PACKAGE_NAME, typeName, (IJavaScriptProject) allProjects.next(), waitForIndexes, new NullProgressMonitor());</TD></TR><TR><TD CLASS="l">919</TD><TD>                                }</TD></TR><TR><TD CLASS="l">920</TD><TD>                        }</TD></TR><TR><TD CLASS="l">921</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">922</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">923</TD><TD>        }</TD></TR><TR><TD CLASS="l">924</TD><TD> </TD></TR><TR><TD CLASS="l">925</TD><TD>        /**</TD></TR><TR><TD CLASS="l">926</TD><TD>         * Find type. Considering secondary types and waiting for indexes depends on given corresponding parameters.</TD></TR><TR><TD CLASS="l">927</TD><TD>         */</TD></TR><TR><TD CLASS="l">928</TD><TD>        public Answer findType(</TD></TR><TR><TD CLASS="l">929</TD><TD>                        String typeName,</TD></TR><TR><TD CLASS="l">930</TD><TD>                        String packageName,</TD></TR><TR><TD CLASS="l">931</TD><TD>                        boolean partialMatch,</TD></TR><TR><TD CLASS="l">932</TD><TD>                        int acceptFlags,</TD></TR><TR><TD CLASS="l"><A NAME="17">933</A></TD><TD>                        boolean considerSecondaryTypes,</TD></TR><TR><TD CLASS="l">934</TD><TD>                        boolean waitForIndexes,</TD></TR><TR><TD CLASS="l">935</TD><TD>                        boolean checkRestrictions,</TD></TR><TR><TD CLASS="l">936</TD><TD>                        IProgressMonitor monitor) {</TD></TR><TR CLASS="z"><TD CLASS="l">937</TD><TD>                if (packageName == null || packageName.length() == 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">938</TD><TD>                        packageName= IPackageFragment.DEFAULT_PACKAGE_NAME;</TD></TR><TR CLASS="z"><TD CLASS="l">939</TD><TD>                } else if (typeName.length() &gt; 0 &amp;&amp; ScannerHelper.isLowerCase(typeName.charAt(0))) {</TD></TR><TR><TD CLASS="l">940</TD><TD>                        // see if this is a known package and not a type</TD></TR><TR CLASS="z"><TD CLASS="l">941</TD><TD>                        if (findPackageFragments(packageName + &#34;.&#34; + typeName, false) != null) return null; //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">942</TD><TD>                }</TD></TR><TR><TD CLASS="l">943</TD><TD> </TD></TR><TR><TD CLASS="l">944</TD><TD>                // Look for concerned package fragments</TD></TR><TR CLASS="z"><TD CLASS="l">945</TD><TD>                JavaElementRequestor elementRequestor = new JavaElementRequestor();</TD></TR><TR CLASS="z"><TD CLASS="l">946</TD><TD>                seekPackageFragments(packageName, false, elementRequestor);</TD></TR><TR CLASS="z"><TD CLASS="l">947</TD><TD>                IPackageFragment[] packages= elementRequestor.getPackageFragments();</TD></TR><TR><TD CLASS="l">948</TD><TD> </TD></TR><TR><TD CLASS="l">949</TD><TD>                // Try to find type in package fragments list</TD></TR><TR CLASS="z"><TD CLASS="l">950</TD><TD>                IType type = null;</TD></TR><TR CLASS="z"><TD CLASS="l">951</TD><TD>                int length= packages.length;</TD></TR><TR CLASS="z"><TD CLASS="l">952</TD><TD>                HashSet projects = null;</TD></TR><TR CLASS="z"><TD CLASS="l">953</TD><TD>                IJavaScriptProject javaProject = null;</TD></TR><TR CLASS="z"><TD CLASS="l">954</TD><TD>                Answer suggestedAnswer = null;</TD></TR><TR CLASS="z"><TD CLASS="l">955</TD><TD>                for (int i= 0; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">956</TD><TD>                        type = findType(typeName, packages[i], partialMatch, acceptFlags);</TD></TR><TR CLASS="z"><TD CLASS="l">957</TD><TD>                        if (type != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">958</TD><TD>                                AccessRestriction accessRestriction = null;</TD></TR><TR CLASS="z"><TD CLASS="l">959</TD><TD>                                if (checkRestrictions) {</TD></TR><TR CLASS="z"><TD CLASS="l">960</TD><TD>                                        accessRestriction = getViolatedRestriction(typeName, packageName, type, accessRestriction);</TD></TR><TR><TD CLASS="l">961</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">962</TD><TD>                                Answer answer = new Answer(type, accessRestriction);</TD></TR><TR CLASS="z"><TD CLASS="l">963</TD><TD>                                if (!answer.ignoreIfBetter()) {</TD></TR><TR CLASS="z"><TD CLASS="l">964</TD><TD>                                        if (answer.isBetter(suggestedAnswer))</TD></TR><TR CLASS="z"><TD CLASS="l">965</TD><TD>                                                return answer;</TD></TR><TR CLASS="z"><TD CLASS="l">966</TD><TD>                                } else if (answer.isBetter(suggestedAnswer))</TD></TR><TR><TD CLASS="l">967</TD><TD>                                        // remember suggestion and keep looking</TD></TR><TR CLASS="z"><TD CLASS="l">968</TD><TD>                                        suggestedAnswer = answer;</TD></TR><TR><TD CLASS="l">969</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">970</TD><TD>                        else if (suggestedAnswer == null &amp;&amp; considerSecondaryTypes) {</TD></TR><TR CLASS="z"><TD CLASS="l">971</TD><TD>                                if (javaProject == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">972</TD><TD>                                        javaProject = packages[i].getJavaScriptProject();</TD></TR><TR CLASS="z"><TD CLASS="l">973</TD><TD>                                } else if (projects == null)  {</TD></TR><TR CLASS="z"><TD CLASS="l">974</TD><TD>                                        if (!javaProject.equals(packages[i].getJavaScriptProject())) {</TD></TR><TR CLASS="z"><TD CLASS="l">975</TD><TD>                                                projects = new HashSet(3);</TD></TR><TR CLASS="z"><TD CLASS="l">976</TD><TD>                                                projects.add(javaProject);</TD></TR><TR CLASS="z"><TD CLASS="l">977</TD><TD>                                                projects.add(packages[i].getJavaScriptProject());</TD></TR><TR><TD CLASS="l">978</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">979</TD><TD>                                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">980</TD><TD>                                        projects.add(packages[i].getJavaScriptProject());</TD></TR><TR><TD CLASS="l">981</TD><TD>                                }</TD></TR><TR><TD CLASS="l">982</TD><TD>                        }</TD></TR><TR><TD CLASS="l">983</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">984</TD><TD>                if (suggestedAnswer != null)</TD></TR><TR><TD CLASS="l">985</TD><TD>                        // no better answer was found</TD></TR><TR CLASS="z"><TD CLASS="l">986</TD><TD>                        return suggestedAnswer;</TD></TR><TR><TD CLASS="l">987</TD><TD> </TD></TR><TR><TD CLASS="l">988</TD><TD>                // If type was not found, try to find it as secondary in source folders</TD></TR><TR CLASS="z"><TD CLASS="l">989</TD><TD>                if (considerSecondaryTypes &amp;&amp; javaProject != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">990</TD><TD>                        if (projects == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">991</TD><TD>                                type = findSecondaryType(packageName, typeName, javaProject, waitForIndexes, monitor);</TD></TR><TR><TD CLASS="l">992</TD><TD>                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">993</TD><TD>                                Iterator allProjects = projects.iterator();</TD></TR><TR CLASS="z"><TD CLASS="l">994</TD><TD>                                while (type == null &amp;&amp; allProjects.hasNext()) {</TD></TR><TR CLASS="z"><TD CLASS="l">995</TD><TD>                                        type = findSecondaryType(packageName, typeName, (IJavaScriptProject) allProjects.next(), waitForIndexes, monitor);</TD></TR><TR><TD CLASS="l">996</TD><TD>                                }</TD></TR><TR><TD CLASS="l">997</TD><TD>                        }</TD></TR><TR><TD CLASS="l">998</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">999</TD><TD>                return type == null ? null : new Answer(type, null);</TD></TR><TR><TD CLASS="l">1000</TD><TD>        }</TD></TR><TR><TD CLASS="l">1001</TD><TD> </TD></TR><TR><TD CLASS="l">1002</TD><TD>        public Answer findBinding(</TD></TR><TR><TD CLASS="l">1003</TD><TD>                        String bindingName,</TD></TR><TR><TD CLASS="l">1004</TD><TD>                        String packageName,</TD></TR><TR><TD CLASS="l">1005</TD><TD>                        int bindingType,</TD></TR><TR><TD CLASS="l">1006</TD><TD>                        boolean partialMatch,</TD></TR><TR><TD CLASS="l">1007</TD><TD>                        int acceptFlags,</TD></TR><TR><TD CLASS="l"><A NAME="b">1008</A></TD><TD>                        boolean considerSecondaryTypes,</TD></TR><TR><TD CLASS="l">1009</TD><TD>                        boolean waitForIndexes,</TD></TR><TR><TD CLASS="l">1010</TD><TD>                        boolean checkRestrictions,</TD></TR><TR><TD CLASS="l">1011</TD><TD>                        IProgressMonitor monitor) {</TD></TR><TR CLASS="z"><TD CLASS="l">1012</TD><TD>                if (packageName == null || packageName.length() == 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">1013</TD><TD>                        packageName= IPackageFragment.DEFAULT_PACKAGE_NAME;</TD></TR><TR CLASS="z"><TD CLASS="l">1014</TD><TD>                } else if (bindingName.length() &gt; 0 &amp;&amp; ScannerHelper.isLowerCase(bindingName.charAt(0))) {</TD></TR><TR><TD CLASS="l">1015</TD><TD>                        // see if this is a known package and not a type</TD></TR><TR CLASS="z"><TD CLASS="l">1016</TD><TD>                        if (findPackageFragments(packageName + &#34;.&#34; + bindingName, false) != null) return null; //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1017</TD><TD>                }</TD></TR><TR><TD CLASS="l">1018</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1019</TD><TD>                if (VERBOSE)</TD></TR><TR CLASS="z"><TD CLASS="l">1020</TD><TD>                        System.out.println(&#34;find binding: &#34;+bindingName); //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1021</TD><TD>                // Look for concerned package fragments</TD></TR><TR CLASS="z"><TD CLASS="l">1022</TD><TD>                JavaElementRequestor elementRequestor = new JavaElementRequestor();</TD></TR><TR CLASS="z"><TD CLASS="l">1023</TD><TD>                seekPackageFragments(packageName, false, elementRequestor);</TD></TR><TR CLASS="z"><TD CLASS="l">1024</TD><TD>                IPackageFragment[] packages= elementRequestor.getPackageFragments();</TD></TR><TR><TD CLASS="l">1025</TD><TD> </TD></TR><TR><TD CLASS="l">1026</TD><TD>                // Try to find type in package fragments list</TD></TR><TR><TD CLASS="l">1027</TD><TD>//                IType type = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1028</TD><TD>                Object element = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1029</TD><TD>                int length= packages.length;</TD></TR><TR CLASS="z"><TD CLASS="l">1030</TD><TD>                HashSet projects = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1031</TD><TD>                IJavaScriptProject javaProject = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1032</TD><TD>                Answer suggestedAnswer = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1033</TD><TD>                for (int i= 0; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1034</TD><TD>                        element = findBinding(bindingName, bindingType,packages[i], partialMatch, acceptFlags);</TD></TR><TR CLASS="z"><TD CLASS="l">1035</TD><TD>                        if (element != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1036</TD><TD>                                AccessRestriction accessRestriction = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1037</TD><TD>                                if (checkRestrictions) {</TD></TR><TR CLASS="z"><TD CLASS="l">1038</TD><TD>                                        accessRestriction = getViolatedRestriction(bindingName, packageName, element, accessRestriction);</TD></TR><TR><TD CLASS="l">1039</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1040</TD><TD>                                char[] path = null;</TD></TR><TR><TD CLASS="l">1041</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1042</TD><TD>                                if(element instanceof SourceTypeBinding) {</TD></TR><TR CLASS="z"><TD CLASS="l">1043</TD><TD>                                        path = ((SourceTypeBinding)element).getFileName();</TD></TR><TR CLASS="z"><TD CLASS="l">1044</TD><TD>                                }else if ( element instanceof ReferenceBinding) {</TD></TR><TR CLASS="z"><TD CLASS="l">1045</TD><TD>                                        path = ((ReferenceBinding)element).getFileName();</TD></TR><TR CLASS="z"><TD CLASS="l">1046</TD><TD>                                }else if(element instanceof SourceType){</TD></TR><TR CLASS="z"><TD CLASS="l">1047</TD><TD>                                        path = ((SourceType)element).getPath().toString().toCharArray();</TD></TR><TR><TD CLASS="l">1048</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1049</TD><TD>                                if(path!=null &amp;&amp; !getRestrictedAccessRequestor().acceptBinding(bindingType, acceptFlags, packageName.toCharArray(), bindingName.toCharArray(), new String(path), accessRestriction)){</TD></TR><TR CLASS="z"><TD CLASS="l">1050</TD><TD>                                        element = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1051</TD><TD>                                        continue;</TD></TR><TR><TD CLASS="l">1052</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1053</TD><TD>//</TD></TR><TR CLASS="z"><TD CLASS="l">1054</TD><TD>                                Answer answer = new Answer(element, accessRestriction);</TD></TR><TR CLASS="z"><TD CLASS="l">1055</TD><TD>                                if (!answer.ignoreIfBetter()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1056</TD><TD>                                        if (answer.isBetter(suggestedAnswer))</TD></TR><TR CLASS="z"><TD CLASS="l">1057</TD><TD>                                                return answer;</TD></TR><TR CLASS="z"><TD CLASS="l">1058</TD><TD>                                } else if (answer.isBetter(suggestedAnswer))</TD></TR><TR><TD CLASS="l">1059</TD><TD>                                        // remember suggestion and keep looking</TD></TR><TR CLASS="z"><TD CLASS="l">1060</TD><TD>                                        suggestedAnswer = answer;</TD></TR><TR><TD CLASS="l">1061</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1062</TD><TD>                        else if (suggestedAnswer == null &amp;&amp; considerSecondaryTypes) {</TD></TR><TR CLASS="z"><TD CLASS="l">1063</TD><TD>                                if (javaProject == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1064</TD><TD>                                        javaProject = packages[i].getJavaScriptProject();</TD></TR><TR CLASS="z"><TD CLASS="l">1065</TD><TD>                                } else if (projects == null)  {</TD></TR><TR CLASS="z"><TD CLASS="l">1066</TD><TD>                                        if (!javaProject.equals(packages[i].getJavaScriptProject())) {</TD></TR><TR CLASS="z"><TD CLASS="l">1067</TD><TD>                                                projects = new HashSet(3);</TD></TR><TR CLASS="z"><TD CLASS="l">1068</TD><TD>                                                projects.add(javaProject);</TD></TR><TR CLASS="z"><TD CLASS="l">1069</TD><TD>                                                projects.add(packages[i].getJavaScriptProject());</TD></TR><TR><TD CLASS="l">1070</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1071</TD><TD>                                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1072</TD><TD>                                        projects.add(packages[i].getJavaScriptProject());</TD></TR><TR><TD CLASS="l">1073</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1074</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1075</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1076</TD><TD>                if (suggestedAnswer != null)</TD></TR><TR><TD CLASS="l">1077</TD><TD>                        // no better answer was found</TD></TR><TR CLASS="z"><TD CLASS="l">1078</TD><TD>                        return suggestedAnswer;</TD></TR><TR><TD CLASS="l">1079</TD><TD> </TD></TR><TR><TD CLASS="l">1080</TD><TD>//                // If type was not found, try to find it as secondary in source folders</TD></TR><TR><TD CLASS="l">1081</TD><TD>//                if (considerSecondaryTypes &amp;&amp; javaProject != null) {</TD></TR><TR><TD CLASS="l">1082</TD><TD>//                        if (projects == null) {</TD></TR><TR><TD CLASS="l">1083</TD><TD>//                                type = findSecondaryType(packageName, bindingName, javaProject, waitForIndexes, monitor);</TD></TR><TR><TD CLASS="l">1084</TD><TD>//                        } else {</TD></TR><TR><TD CLASS="l">1085</TD><TD>//                                Iterator allProjects = projects.iterator();</TD></TR><TR><TD CLASS="l">1086</TD><TD>//                                while (type == null &amp;&amp; allProjects.hasNext()) {</TD></TR><TR><TD CLASS="l">1087</TD><TD>//                                        type = findSecondaryType(packageName, typeName, (IJavaScriptProject) allProjects.next(), waitForIndexes, monitor);</TD></TR><TR><TD CLASS="l">1088</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">1089</TD><TD>//                        }</TD></TR><TR><TD CLASS="l">1090</TD><TD>//                }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1e">1091</A></TD><TD>                return element == null ? null : new Answer(element, null);</TD></TR><TR><TD CLASS="l">1092</TD><TD>        }</TD></TR><TR><TD CLASS="l">1093</TD><TD> </TD></TR><TR><TD CLASS="l">1094</TD><TD>        private AccessRestriction getViolatedRestriction(String typeName, String packageName, IType type, AccessRestriction accessRestriction) {</TD></TR><TR CLASS="z"><TD CLASS="l">1095</TD><TD>                PackageFragmentRoot root = (PackageFragmentRoot) type.getAncestor(IJavaScriptElement.PACKAGE_FRAGMENT_ROOT);</TD></TR><TR CLASS="z"><TD CLASS="l">1096</TD><TD>                ClasspathEntry entry = (ClasspathEntry) this.rootToResolvedEntries.get(root);</TD></TR><TR CLASS="z"><TD CLASS="l">1097</TD><TD>                if (entry != null) { // reverse map always contains resolved CP entry</TD></TR><TR CLASS="z"><TD CLASS="l">1098</TD><TD>                        AccessRuleSet accessRuleSet = entry.getAccessRuleSet();</TD></TR><TR CLASS="z"><TD CLASS="l">1099</TD><TD>                        if (accessRuleSet != null) {</TD></TR><TR><TD CLASS="l">1100</TD><TD>                                // TODO (philippe) improve char[] &lt;-&gt; String conversions to avoid performing them on the fly</TD></TR><TR CLASS="z"><TD CLASS="l">1101</TD><TD>                                char[][] packageChars = CharOperation.splitOn('.', packageName.toCharArray());</TD></TR><TR CLASS="z"><TD CLASS="l">1102</TD><TD>                                char[] typeChars = typeName.toCharArray();</TD></TR><TR CLASS="z"><TD CLASS="l">1103</TD><TD>                                accessRestriction = accessRuleSet.getViolatedRestriction(CharOperation.concatWith(packageChars, typeChars, '/'));</TD></TR><TR><TD CLASS="l">1104</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1105</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1106</TD><TD>                return accessRestriction;</TD></TR><TR><TD CLASS="l">1107</TD><TD>        }</TD></TR><TR><TD CLASS="l">1108</TD><TD> </TD></TR><TR><TD CLASS="l">1109</TD><TD>        private AccessRestriction getViolatedRestriction(String typeName, String packageName, Object element, AccessRestriction accessRestriction) {</TD></TR><TR><TD CLASS="l">1110</TD><TD>//TODO: implement</TD></TR><TR><TD CLASS="l">1111</TD><TD>//                System.out.println(&#34;implement NameLookup.getViolatedRestriction&#34;);</TD></TR><TR><TD CLASS="l">1112</TD><TD>//                PackageFragmentRoot root = (PackageFragmentRoot) type.getAncestor(IJavaScriptElement.PACKAGE_FRAGMENT_ROOT);</TD></TR><TR><TD CLASS="l">1113</TD><TD>//                ClasspathEntry entry = (ClasspathEntry) this.rootToResolvedEntries.get(root);</TD></TR><TR><TD CLASS="l">1114</TD><TD>//                if (entry != null) { // reverse map always contains resolved CP entry</TD></TR><TR><TD CLASS="l">1115</TD><TD>//                        AccessRuleSet accessRuleSet = entry.getAccessRuleSet();</TD></TR><TR><TD CLASS="l">1116</TD><TD>//                        if (accessRuleSet != null) {</TD></TR><TR><TD CLASS="l">1117</TD><TD>//                                // TODO (philippe) improve char[] &lt;-&gt; String conversions to avoid performing them on the fly</TD></TR><TR><TD CLASS="l">1118</TD><TD>//                                char[][] packageChars = CharOperation.splitOn('.', packageName.toCharArray());</TD></TR><TR><TD CLASS="l"><A NAME="1f">1119</A></TD><TD>//                                char[] typeChars = typeName.toCharArray();</TD></TR><TR><TD CLASS="l">1120</TD><TD>//                                accessRestriction = accessRuleSet.getViolatedRestriction(CharOperation.concatWith(packageChars, typeChars, '/'));</TD></TR><TR><TD CLASS="l">1121</TD><TD>//                        }</TD></TR><TR><TD CLASS="l">1122</TD><TD>//                }</TD></TR><TR CLASS="z"><TD CLASS="l">1123</TD><TD>                return accessRestriction;</TD></TR><TR><TD CLASS="l">1124</TD><TD>        }</TD></TR><TR><TD CLASS="l">1125</TD><TD> </TD></TR><TR><TD CLASS="l">1126</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1127</TD><TD>         * Returns the first type in the given package whose name</TD></TR><TR><TD CLASS="l">1128</TD><TD>         * matches the given (unqualified) name, or &lt;code&gt;null&lt;/code&gt; if none</TD></TR><TR><TD CLASS="l">1129</TD><TD>         * exist. Specifying a &lt;code&gt;null&lt;/code&gt; package will result in no matches.</TD></TR><TR><TD CLASS="l">1130</TD><TD>         * The domain of the search is bounded by the Java project from which</TD></TR><TR><TD CLASS="l">1131</TD><TD>         * this name lookup was obtained.</TD></TR><TR><TD CLASS="l">1132</TD><TD>         *</TD></TR><TR><TD CLASS="l">1133</TD><TD>         * @param name the name of the type to find</TD></TR><TR><TD CLASS="l">1134</TD><TD>         * @param pkg the package to search</TD></TR><TR><TD CLASS="l">1135</TD><TD>         * @param partialMatch partial name matches qualify when &lt;code&gt;true&lt;/code&gt;,</TD></TR><TR><TD CLASS="l">1136</TD><TD>         *        only exact name matches qualify when &lt;code&gt;false&lt;/code&gt;</TD></TR><TR><TD CLASS="l">1137</TD><TD>         * @param acceptFlags a bit mask describing if classes, interfaces or both classes and interfaces</TD></TR><TR><TD CLASS="l">1138</TD><TD>         *         are desired results. If no flags are specified, all types are returned.</TD></TR><TR><TD CLASS="l">1139</TD><TD>         * @param considerSecondaryTypes flag to know whether secondary types has to be considered</TD></TR><TR><TD CLASS="l">1140</TD><TD>         *         during the search</TD></TR><TR><TD CLASS="l">1141</TD><TD>         *</TD></TR><TR><TD CLASS="l">1142</TD><TD>         * @see #ACCEPT_CLASSES</TD></TR><TR><TD CLASS="l">1143</TD><TD>         * @see #ACCEPT_INTERFACES</TD></TR><TR><TD CLASS="l"><A NAME="15">1144</A></TD><TD>         * @see #ACCEPT_ENUMS</TD></TR><TR><TD CLASS="l">1145</TD><TD>         * @see #ACCEPT_ANNOTATIONS</TD></TR><TR><TD CLASS="l">1146</TD><TD>         */</TD></TR><TR><TD CLASS="l">1147</TD><TD>        public IType findType(String name, IPackageFragment pkg, boolean partialMatch, int acceptFlags, boolean considerSecondaryTypes) {</TD></TR><TR CLASS="z"><TD CLASS="l">1148</TD><TD>                IType type = findType(name, pkg, partialMatch, acceptFlags);</TD></TR><TR CLASS="z"><TD CLASS="l">1149</TD><TD>                if (type == null &amp;&amp; considerSecondaryTypes) {</TD></TR><TR CLASS="z"><TD CLASS="l">1150</TD><TD>                        type = findSecondaryType(pkg.getElementName(), name, pkg.getJavaScriptProject(), false, null);</TD></TR><TR><TD CLASS="l">1151</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1152</TD><TD>                return type;</TD></TR><TR><TD CLASS="l">1153</TD><TD>        }</TD></TR><TR><TD CLASS="l">1154</TD><TD> </TD></TR><TR><TD CLASS="l">1155</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1156</TD><TD>         * Returns the first type in the given package whose name</TD></TR><TR><TD CLASS="l">1157</TD><TD>         * matches the given (unqualified) name, or &lt;code&gt;null&lt;/code&gt; if none</TD></TR><TR><TD CLASS="l">1158</TD><TD>         * exist. Specifying a &lt;code&gt;null&lt;/code&gt; package will result in no matches.</TD></TR><TR><TD CLASS="l">1159</TD><TD>         * The domain of the search is bounded by the Java project from which</TD></TR><TR><TD CLASS="l">1160</TD><TD>         * this name lookup was obtained.</TD></TR><TR><TD CLASS="l">1161</TD><TD>         * &lt;br&gt;</TD></TR><TR><TD CLASS="l">1162</TD><TD>         *        Note that this method does not find secondary types.</TD></TR><TR><TD CLASS="l">1163</TD><TD>         * &lt;br&gt;</TD></TR><TR><TD CLASS="l">1164</TD><TD>         * @param name the name of the type to find</TD></TR><TR><TD CLASS="l">1165</TD><TD>         * @param pkg the package to search</TD></TR><TR><TD CLASS="l">1166</TD><TD>         * @param partialMatch partial name matches qualify when &lt;code&gt;true&lt;/code&gt;,</TD></TR><TR><TD CLASS="l">1167</TD><TD>         *        only exact name matches qualify when &lt;code&gt;false&lt;/code&gt;</TD></TR><TR><TD CLASS="l">1168</TD><TD>         * @param acceptFlags a bit mask describing if classes, interfaces or both classes and interfaces</TD></TR><TR><TD CLASS="l">1169</TD><TD>         *         are desired results. If no flags are specified, all types are returned.</TD></TR><TR><TD CLASS="l">1170</TD><TD>         *</TD></TR><TR><TD CLASS="l">1171</TD><TD>         * @see #ACCEPT_CLASSES</TD></TR><TR><TD CLASS="l">1172</TD><TD>         * @see #ACCEPT_INTERFACES</TD></TR><TR><TD CLASS="l"><A NAME="14">1173</A></TD><TD>         * @see #ACCEPT_ENUMS</TD></TR><TR><TD CLASS="l">1174</TD><TD>         * @see #ACCEPT_ANNOTATIONS</TD></TR><TR><TD CLASS="l">1175</TD><TD>         */</TD></TR><TR><TD CLASS="l">1176</TD><TD>        public IType findType(String name, IPackageFragment pkg, boolean partialMatch, int acceptFlags) {</TD></TR><TR CLASS="z"><TD CLASS="l">1177</TD><TD>                if (pkg == null) return null;</TD></TR><TR><TD CLASS="l">1178</TD><TD> </TD></TR><TR><TD CLASS="l">1179</TD><TD>                // Return first found (ignore duplicates).</TD></TR><TR CLASS="z"><TD CLASS="l">1180</TD><TD>                SingleTypeRequestor typeRequestor = new SingleTypeRequestor();</TD></TR><TR CLASS="z"><TD CLASS="l">1181</TD><TD>                seekTypes(name, pkg, partialMatch, acceptFlags, typeRequestor);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="c">1182</A></TD><TD>                return typeRequestor.getType();</TD></TR><TR><TD CLASS="l">1183</TD><TD>        }</TD></TR><TR><TD CLASS="l">1184</TD><TD> </TD></TR><TR><TD CLASS="l">1185</TD><TD>        public IJavaScriptElement findBinding(String name, int type, IPackageFragment pkg, boolean partialMatch, int acceptFlags) {</TD></TR><TR CLASS="z"><TD CLASS="l">1186</TD><TD>                if (pkg == null) return null;</TD></TR><TR><TD CLASS="l">1187</TD><TD> </TD></TR><TR><TD CLASS="l">1188</TD><TD>                // Return first found (ignore duplicates).</TD></TR><TR CLASS="z"><TD CLASS="l">1189</TD><TD>                JavaElementRequestor requestor = new JavaElementRequestor();</TD></TR><TR CLASS="z"><TD CLASS="l">1190</TD><TD>                seekBindings(name,type, pkg, partialMatch, acceptFlags, requestor);</TD></TR><TR CLASS="z"><TD CLASS="l">1191</TD><TD>                  IField[] fields = requestor.getFields();</TD></TR><TR CLASS="z"><TD CLASS="l">1192</TD><TD>                  IFunction[] methods = requestor.getMethods();</TD></TR><TR CLASS="z"><TD CLASS="l">1193</TD><TD>                  IType[] types = requestor.getTypes();</TD></TR><TR CLASS="z"><TD CLASS="l">1194</TD><TD>                switch (type)</TD></TR><TR><TD CLASS="l">1195</TD><TD>                {</TD></TR><TR><TD CLASS="l">1196</TD><TD>                  case Binding.FIELD | Binding.METHOD:</TD></TR><TR CLASS="z"><TD CLASS="l">1197</TD><TD>                          if (methods.length&gt;0)</TD></TR><TR CLASS="z"><TD CLASS="l">1198</TD><TD>                                  return methods[0];</TD></TR><TR><TD CLASS="l">1199</TD><TD>                  case Binding.FIELD:</TD></TR><TR CLASS="z"><TD CLASS="l">1200</TD><TD>                          return (fields.length&gt;0)?fields[0]:null;</TD></TR><TR><TD CLASS="l">1201</TD><TD> </TD></TR><TR><TD CLASS="l">1202</TD><TD>                  case Binding.METHOD:</TD></TR><TR CLASS="z"><TD CLASS="l">1203</TD><TD>                          return (methods.length&gt;0)?methods[0]:null;</TD></TR><TR><TD CLASS="l">1204</TD><TD>                  case Binding.TYPE:</TD></TR><TR><TD CLASS="l">1205</TD><TD>                  case Binding.TYPE|Binding.PACKAGE:</TD></TR><TR CLASS="z"><TD CLASS="l">1206</TD><TD>                          return (types.length&gt;0)?types[0]:null;</TD></TR><TR><TD CLASS="l">1207</TD><TD> </TD></TR><TR><TD CLASS="l">1208</TD><TD>                  default:</TD></TR><TR><TD CLASS="l">1209</TD><TD>                  {</TD></TR><TR CLASS="z"><TD CLASS="l">1210</TD><TD>                                if ((Binding.TYPE &amp; type)!=0)</TD></TR><TR><TD CLASS="l">1211</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">1212</TD><TD>                                          if (types.length&gt;0)</TD></TR><TR CLASS="z"><TD CLASS="l">1213</TD><TD>                                                  return types[0];</TD></TR><TR><TD CLASS="l">1214</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1215</TD><TD>                                if ((Binding.METHOD &amp; type)!=0)</TD></TR><TR><TD CLASS="l">1216</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">1217</TD><TD>                                          if (methods.length&gt;0)</TD></TR><TR CLASS="z"><TD CLASS="l">1218</TD><TD>                                                  return methods[0];</TD></TR><TR><TD CLASS="l">1219</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1220</TD><TD>                                if ((Binding.VARIABLE &amp; type)!=0)</TD></TR><TR><TD CLASS="l">1221</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">1222</TD><TD>                                          if (fields.length&gt;0)</TD></TR><TR CLASS="z"><TD CLASS="l">1223</TD><TD>                                                  return fields[0];</TD></TR><TR><TD CLASS="l">1224</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1225</TD><TD>                  }</TD></TR><TR><TD CLASS="l">1226</TD><TD> </TD></TR><TR><TD CLASS="l">1227</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1228</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">1229</TD><TD>        }</TD></TR><TR><TD CLASS="l">1230</TD><TD> </TD></TR><TR><TD CLASS="l">1231</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1232</TD><TD>         * Returns the type specified by the qualified name, or &lt;code&gt;null&lt;/code&gt;</TD></TR><TR><TD CLASS="l">1233</TD><TD>         * if none exist. The domain of</TD></TR><TR><TD CLASS="l">1234</TD><TD>         * the search is bounded by the Java project from which this name lookup was obtained.</TD></TR><TR><TD CLASS="l">1235</TD><TD>         *</TD></TR><TR><TD CLASS="l">1236</TD><TD>         * @param name the name of the type to find</TD></TR><TR><TD CLASS="l">1237</TD><TD>         * @param partialMatch partial name matches qualify when &lt;code&gt;true&lt;/code&gt;,</TD></TR><TR><TD CLASS="l">1238</TD><TD>         *        only exact name matches qualify when &lt;code&gt;false&lt;/code&gt;</TD></TR><TR><TD CLASS="l">1239</TD><TD>         * @param acceptFlags a bit mask describing if classes, interfaces or both classes and interfaces</TD></TR><TR><TD CLASS="l">1240</TD><TD>         *         are desired results. If no flags are specified, all types are returned.</TD></TR><TR><TD CLASS="l">1241</TD><TD>         *</TD></TR><TR><TD CLASS="l">1242</TD><TD>         * @see #ACCEPT_CLASSES</TD></TR><TR><TD CLASS="l">1243</TD><TD>         * @see #ACCEPT_INTERFACES</TD></TR><TR><TD CLASS="l"><A NAME="18">1244</A></TD><TD>         * @see #ACCEPT_ENUMS</TD></TR><TR><TD CLASS="l">1245</TD><TD>         * @see #ACCEPT_ANNOTATIONS</TD></TR><TR><TD CLASS="l">1246</TD><TD>         */</TD></TR><TR><TD CLASS="l">1247</TD><TD>        public IType findType(String name, boolean partialMatch, int acceptFlags) {</TD></TR><TR CLASS="z"><TD CLASS="l">1248</TD><TD>                NameLookup.Answer answer = findType(name, partialMatch, acceptFlags, false/*don't check restrictions*/);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="19">1249</A></TD><TD>                return answer == null ? null : answer.type;</TD></TR><TR><TD CLASS="l">1250</TD><TD>        }</TD></TR><TR><TD CLASS="l">1251</TD><TD> </TD></TR><TR><TD CLASS="l">1252</TD><TD>        public Answer findType(String name, boolean partialMatch, int acceptFlags, boolean checkRestrictions) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1a">1253</A></TD><TD>                return findType(name, partialMatch, acceptFlags, true/*consider secondary types*/, true/*wait for indexes*/, checkRestrictions, null);</TD></TR><TR><TD CLASS="l">1254</TD><TD>        }</TD></TR><TR><TD CLASS="l">1255</TD><TD>        public Answer findType(String name, boolean partialMatch, int acceptFlags, boolean considerSecondaryTypes, boolean waitForIndexes, boolean checkRestrictions, IProgressMonitor monitor) {</TD></TR><TR><TD CLASS="l">1256</TD><TD>//                int index= name.lastIndexOf('.');</TD></TR><TR CLASS="z"><TD CLASS="l">1257</TD><TD>                String className= null, packageName= null;</TD></TR><TR><TD CLASS="l">1258</TD><TD>//                if (index == -1) {</TD></TR><TR CLASS="z"><TD CLASS="l">1259</TD><TD>                        packageName= IPackageFragment.DEFAULT_PACKAGE_NAME;</TD></TR><TR CLASS="z"><TD CLASS="l">1260</TD><TD>                        className= name;</TD></TR><TR><TD CLASS="l">1261</TD><TD>//                } else {</TD></TR><TR><TD CLASS="l">1262</TD><TD>//                        packageName= name.substring(0, index);</TD></TR><TR><TD CLASS="l">1263</TD><TD>//                        className= name.substring(index + 1);</TD></TR><TR><TD CLASS="l">1264</TD><TD>//                }</TD></TR><TR CLASS="z"><TD CLASS="l">1265</TD><TD>                if (USE_BINDING_SEARCH &amp;&amp; searchFiles)</TD></TR><TR CLASS="z"><TD CLASS="l">1266</TD><TD>                        return findBindingSearch(className, packageName, Binding.TYPE, partialMatch, acceptFlags, considerSecondaryTypes, waitForIndexes, checkRestrictions, monitor,false,null);</TD></TR><TR CLASS="z"><TD CLASS="l">1267</TD><TD>                return findType(className, packageName, partialMatch, acceptFlags, considerSecondaryTypes, waitForIndexes, checkRestrictions, monitor);</TD></TR><TR><TD CLASS="l">1268</TD><TD>        }</TD></TR><TR><TD CLASS="l">1269</TD><TD> </TD></TR><TR><TD CLASS="l">1270</TD><TD>        private IType getMemberType(IType type, String name, int dot) {</TD></TR><TR><TD CLASS="l">1271</TD><TD>                //while (dot != -1) {</TD></TR><TR><TD CLASS="l">1272</TD><TD>                        //int start = dot+1;</TD></TR><TR><TD CLASS="l"><A NAME="1c">1273</A></TD><TD>                //        dot = name.indexOf('.', start);</TD></TR><TR><TD CLASS="l">1274</TD><TD>                //        String typeName = name.substring(start, dot == -1 ? name.length() : dot);</TD></TR><TR><TD CLASS="l">1275</TD><TD>                //        type = type.getType(name);</TD></TR><TR><TD CLASS="l">1276</TD><TD>                //}</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="20">1277</A></TD><TD>                return type;</TD></TR><TR><TD CLASS="l">1278</TD><TD>        }</TD></TR><TR><TD CLASS="l">1279</TD><TD> </TD></TR><TR><TD CLASS="l">1280</TD><TD>        public boolean isPackage(String[] pkgName) {</TD></TR><TR CLASS="z"><TD CLASS="l">1281</TD><TD>                return this.packageFragments.get(pkgName) != null;</TD></TR><TR><TD CLASS="l">1282</TD><TD>        }</TD></TR><TR><TD CLASS="l">1283</TD><TD> </TD></TR><TR><TD CLASS="l">1284</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1285</TD><TD>         * Returns true if the given element's name matches the</TD></TR><TR><TD CLASS="l">1286</TD><TD>         * specified &lt;code&gt;searchName&lt;/code&gt;, otherwise false.</TD></TR><TR><TD CLASS="l">1287</TD><TD>         *</TD></TR><TR><TD CLASS="l">1288</TD><TD>         * &lt;p&gt;The &lt;code&gt;partialMatch&lt;/code&gt; argument indicates partial matches</TD></TR><TR><TD CLASS="l">1289</TD><TD>         * should be considered.</TD></TR><TR><TD CLASS="l"><A NAME="21">1290</A></TD><TD>         * NOTE: in partialMatch mode, the case will be ignored, and the searchName must already have</TD></TR><TR><TD CLASS="l">1291</TD><TD>         *          been lowercased.</TD></TR><TR><TD CLASS="l">1292</TD><TD>         */</TD></TR><TR><TD CLASS="l">1293</TD><TD>        protected boolean nameMatches(String searchName, IJavaScriptElement element, boolean partialMatch) {</TD></TR><TR CLASS="z"><TD CLASS="l">1294</TD><TD>                if (partialMatch) {</TD></TR><TR><TD CLASS="l">1295</TD><TD>                        // partial matches are used in completion mode, thus case insensitive mode</TD></TR><TR CLASS="z"><TD CLASS="l">1296</TD><TD>                        return element.getElementName().toLowerCase().startsWith(searchName);</TD></TR><TR><TD CLASS="l">1297</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1298</TD><TD>                        return element.getElementName().equals(searchName);</TD></TR><TR><TD CLASS="l">1299</TD><TD>                }</TD></TR><TR><TD CLASS="l">1300</TD><TD>        }</TD></TR><TR><TD CLASS="l">1301</TD><TD> </TD></TR><TR><TD CLASS="l">1302</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1303</TD><TD>         * Returns true if the given cu's name matches the</TD></TR><TR><TD CLASS="l">1304</TD><TD>         * specified &lt;code&gt;searchName&lt;/code&gt;, otherwise false.</TD></TR><TR><TD CLASS="l">1305</TD><TD>         *</TD></TR><TR><TD CLASS="l">1306</TD><TD>         * &lt;p&gt;The &lt;code&gt;partialMatch&lt;/code&gt; argument indicates partial matches</TD></TR><TR><TD CLASS="l">1307</TD><TD>         * should be considered.</TD></TR><TR><TD CLASS="l"><A NAME="22">1308</A></TD><TD>         * NOTE: in partialMatch mode, the case will be ignored, and the searchName must already have</TD></TR><TR><TD CLASS="l">1309</TD><TD>         *          been lowercased.</TD></TR><TR><TD CLASS="l">1310</TD><TD>         */</TD></TR><TR><TD CLASS="l">1311</TD><TD>        protected boolean nameMatches(String searchName, IJavaScriptUnit cu, boolean partialMatch) {</TD></TR><TR CLASS="z"><TD CLASS="l">1312</TD><TD>                if (partialMatch) {</TD></TR><TR><TD CLASS="l">1313</TD><TD>                        // partial matches are used in completion mode, thus case insensitive mode</TD></TR><TR CLASS="z"><TD CLASS="l">1314</TD><TD>                        return cu.getElementName().toLowerCase().startsWith(searchName);</TD></TR><TR><TD CLASS="l">1315</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1316</TD><TD>                        return Util.equalsIgnoreJavaLikeExtension(cu.getElementName(), searchName);</TD></TR><TR><TD CLASS="l">1317</TD><TD>                }</TD></TR><TR><TD CLASS="l">1318</TD><TD>        }</TD></TR><TR><TD CLASS="l">1319</TD><TD> </TD></TR><TR><TD CLASS="l">1320</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1321</TD><TD>         * Notifies the given requestor of all package fragments with the</TD></TR><TR><TD CLASS="l">1322</TD><TD>         * given name. Checks the requestor at regular intervals to see if the</TD></TR><TR><TD CLASS="l">1323</TD><TD>         * requestor has canceled. The domain of</TD></TR><TR><TD CLASS="l">1324</TD><TD>         * the search is bounded by the &lt;code&gt;IJavaScriptProject&lt;/code&gt;</TD></TR><TR><TD CLASS="l">1325</TD><TD>         * this &lt;code&gt;NameLookup&lt;/code&gt; was obtained from.</TD></TR><TR><TD CLASS="l">1326</TD><TD>         *</TD></TR><TR><TD CLASS="l">1327</TD><TD>         * @param partialMatch partial name matches qualify when &lt;code&gt;true&lt;/code&gt;;</TD></TR><TR><TD CLASS="l">1328</TD><TD>         *        only exact name matches qualify when &lt;code&gt;false&lt;/code&gt;</TD></TR><TR><TD CLASS="l">1329</TD><TD>         */</TD></TR><TR><TD CLASS="l">1330</TD><TD>        public void seekPackageFragments(String name, boolean partialMatch, IJavaElementRequestor requestor) {</TD></TR><TR><TD CLASS="l">1331</TD><TD>/*                if (VERBOSE) {</TD></TR><TR><TD CLASS="l">1332</TD><TD>                        Util.verbose(&#34; SEEKING PACKAGE FRAGMENTS&#34;);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l"><A NAME="27">1333</A></TD><TD>                        Util.verbose(&#34; -&gt; name: &#34; + name);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1334</TD><TD>                        Util.verbose(&#34; -&gt; partial match:&#34; + partialMatch);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1335</TD><TD>                }</TD></TR><TR><TD CLASS="l">1336</TD><TD>                */</TD></TR><TR CLASS="z"><TD CLASS="l">1337</TD><TD>                for (int i = 0; i &lt; this.packageFragmentRoots.length; i++) {</TD></TR><TR><TD CLASS="l">1338</TD><TD> </TD></TR><TR><TD CLASS="l">1339</TD><TD> </TD></TR><TR><TD CLASS="l">1340</TD><TD>                        IJavaScriptElement[] children;</TD></TR><TR><TD CLASS="l">1341</TD><TD>                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">1342</TD><TD>                                if (this.searchFiles || packageFragmentRoots[i].isLibrary())</TD></TR><TR><TD CLASS="l">1343</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">1344</TD><TD>                                        children = packageFragmentRoots[i].getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">1345</TD><TD>                                        for (int j = 0; j &lt; children.length; j++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1346</TD><TD>                                                requestor.acceptPackageFragment((IPackageFragment)children[j]);</TD></TR><TR><TD CLASS="l">1347</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1348</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1349</TD><TD>                        } catch (JavaScriptModelException e) {}</TD></TR><TR><TD CLASS="l">1350</TD><TD> </TD></TR><TR><TD CLASS="l">1351</TD><TD>                }</TD></TR><TR><TD CLASS="l">1352</TD><TD> </TD></TR><TR><TD CLASS="l">1353</TD><TD> </TD></TR><TR><TD CLASS="l">1354</TD><TD> </TD></TR><TR><TD CLASS="l">1355</TD><TD>//                if (partialMatch) {</TD></TR><TR><TD CLASS="l">1356</TD><TD>//                        String[] splittedName = splitPackageName(name);</TD></TR><TR><TD CLASS="l">1357</TD><TD>//                        Object[][] keys = this.packageFragments.keyTable;</TD></TR><TR><TD CLASS="l">1358</TD><TD>//                        for (int i = 0, length = keys.length; i &lt; length; i++) {</TD></TR><TR><TD CLASS="l">1359</TD><TD>//                                if (requestor.isCanceled())</TD></TR><TR><TD CLASS="l">1360</TD><TD>//                                        return;</TD></TR><TR><TD CLASS="l">1361</TD><TD>//                                String[] pkgName = (String[]) keys[i];</TD></TR><TR><TD CLASS="l">1362</TD><TD>//                                if (pkgName != null &amp;&amp; Util.startsWithIgnoreCase(pkgName, splittedName)) {</TD></TR><TR><TD CLASS="l">1363</TD><TD>//                                        Object value = this.packageFragments.valueTable[i];</TD></TR><TR><TD CLASS="l">1364</TD><TD>//                                        if (value instanceof PackageFragmentRoot) {</TD></TR><TR><TD CLASS="l">1365</TD><TD>//                                                PackageFragmentRoot root = (PackageFragmentRoot) value;</TD></TR><TR><TD CLASS="l">1366</TD><TD>//                                                requestor.acceptPackageFragment(root.getPackageFragment(pkgName));</TD></TR><TR><TD CLASS="l">1367</TD><TD>//                                        } else {</TD></TR><TR><TD CLASS="l">1368</TD><TD>//                                                IPackageFragmentRoot[] roots = (IPackageFragmentRoot[]) value;</TD></TR><TR><TD CLASS="l">1369</TD><TD>//                                                for (int j = 0, length2 = roots.length; j &lt; length2; j++) {</TD></TR><TR><TD CLASS="l">1370</TD><TD>//                                                        if (requestor.isCanceled())</TD></TR><TR><TD CLASS="l">1371</TD><TD>//                                                                return;</TD></TR><TR><TD CLASS="l">1372</TD><TD>//                                                        PackageFragmentRoot root = (PackageFragmentRoot) roots[j];</TD></TR><TR><TD CLASS="l">1373</TD><TD>//                                                        requestor.acceptPackageFragment(root.getPackageFragment(pkgName));</TD></TR><TR><TD CLASS="l">1374</TD><TD>//                                                }</TD></TR><TR><TD CLASS="l">1375</TD><TD>//                                        }</TD></TR><TR><TD CLASS="l">1376</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">1377</TD><TD>//                        }</TD></TR><TR><TD CLASS="l">1378</TD><TD>//                } else {</TD></TR><TR><TD CLASS="l">1379</TD><TD>//                        String[] splittedName = splitPackageName(name);</TD></TR><TR><TD CLASS="l">1380</TD><TD>//                        Object value = this.packageFragments.get(splittedName);</TD></TR><TR><TD CLASS="l">1381</TD><TD>//                        if (value instanceof PackageFragmentRoot) {</TD></TR><TR><TD CLASS="l">1382</TD><TD>//                                requestor.acceptPackageFragment(((PackageFragmentRoot) value).getPackageFragment(splittedName));</TD></TR><TR><TD CLASS="l">1383</TD><TD>//                        } else {</TD></TR><TR><TD CLASS="l">1384</TD><TD>//                                IPackageFragmentRoot[] roots = (IPackageFragmentRoot[]) value;</TD></TR><TR><TD CLASS="l">1385</TD><TD>//                                if (roots != null) {</TD></TR><TR><TD CLASS="l">1386</TD><TD>//                                        for (int i = 0, length = roots.length; i &lt; length; i++) {</TD></TR><TR><TD CLASS="l">1387</TD><TD>//                                                if (requestor.isCanceled())</TD></TR><TR><TD CLASS="l">1388</TD><TD>//                                                        return;</TD></TR><TR><TD CLASS="l">1389</TD><TD>//                                                PackageFragmentRoot root = (PackageFragmentRoot) roots[i];</TD></TR><TR><TD CLASS="l">1390</TD><TD>//                                                requestor.acceptPackageFragment(root.getPackageFragment(splittedName));</TD></TR><TR><TD CLASS="l">1391</TD><TD>//                                        }</TD></TR><TR><TD CLASS="l">1392</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">1393</TD><TD>//                        }</TD></TR><TR><TD CLASS="l">1394</TD><TD>//                }</TD></TR><TR><TD CLASS="l">1395</TD><TD>//                if (name==null || name.equals(IPackageFragment.DEFAULT_PACKAGE_NAME))</TD></TR><TR><TD CLASS="l">1396</TD><TD>//                {</TD></TR><TR><TD CLASS="l">1397</TD><TD>//                        for (int i = 0; i &lt; this.packageFragmentRoots.length; i++) {</TD></TR><TR><TD CLASS="l">1398</TD><TD>//                                if (packageFragmentRoots[i] instanceof LibraryFragmentRoot)</TD></TR><TR><TD CLASS="l">1399</TD><TD>//                                {</TD></TR><TR><TD CLASS="l">1400</TD><TD>//                                        IJavaScriptElement[] children;</TD></TR><TR><TD CLASS="l">1401</TD><TD>//                                        try {</TD></TR><TR><TD CLASS="l">1402</TD><TD>//                                                children = packageFragmentRoots[i].getChildren();</TD></TR><TR><TD CLASS="l">1403</TD><TD>//                                                for (int j = 0; j &lt; children.length; j++) {</TD></TR><TR><TD CLASS="l">1404</TD><TD>//                                                        requestor.acceptPackageFragment((IPackageFragment)children[j]);</TD></TR><TR><TD CLASS="l">1405</TD><TD>//                                                }</TD></TR><TR><TD CLASS="l">1406</TD><TD>//                                        } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">1407</TD><TD>//                                        }</TD></TR><TR><TD CLASS="l">1408</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">1409</TD><TD>//                        }</TD></TR><TR><TD CLASS="l">1410</TD><TD>//                }</TD></TR><TR CLASS="z"><TD CLASS="l">1411</TD><TD>        }</TD></TR><TR><TD CLASS="l">1412</TD><TD> </TD></TR><TR><TD CLASS="l">1413</TD><TD>//        private String [] splitPackageName(String name)</TD></TR><TR><TD CLASS="l">1414</TD><TD>//        {</TD></TR><TR><TD CLASS="l">1415</TD><TD>//                String[] strings;</TD></TR><TR><TD CLASS="l">1416</TD><TD>//                int index=Util.indexOfJavaLikeExtension(name);</TD></TR><TR><TD CLASS="l">1417</TD><TD>//                if (index&gt;=0)</TD></TR><TR><TD CLASS="l">1418</TD><TD>//                {</TD></TR><TR><TD CLASS="l">1419</TD><TD>//                        String extension=name.substring(index+1);</TD></TR><TR><TD CLASS="l">1420</TD><TD>//                        name=name.substring(0,index);</TD></TR><TR><TD CLASS="l">1421</TD><TD>//                        strings= Util.splitOn('.', name, 0, name.length());</TD></TR><TR><TD CLASS="l">1422</TD><TD>//                        strings[strings.length-1]=strings[strings.length-1]+extension;</TD></TR><TR><TD CLASS="l">1423</TD><TD>//                }</TD></TR><TR><TD CLASS="l">1424</TD><TD>//                else</TD></TR><TR><TD CLASS="l">1425</TD><TD>//                strings  = Util.splitOn('.', name, 0, name.length());</TD></TR><TR><TD CLASS="l">1426</TD><TD>//</TD></TR><TR><TD CLASS="l">1427</TD><TD>//                return strings;</TD></TR><TR><TD CLASS="l">1428</TD><TD>//        }</TD></TR><TR><TD CLASS="l">1429</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1430</TD><TD>         * Notifies the given requestor of all types (classes and interfaces) in the</TD></TR><TR><TD CLASS="l">1431</TD><TD>         * given package fragment with the given (unqualified) name.</TD></TR><TR><TD CLASS="l">1432</TD><TD>         * Checks the requestor at regular intervals to see if the requestor</TD></TR><TR><TD CLASS="l">1433</TD><TD>         * has canceled. If the given package fragment is &lt;code&gt;null&lt;/code&gt;, all types in the</TD></TR><TR><TD CLASS="l">1434</TD><TD>         * project whose simple name matches the given name are found.</TD></TR><TR><TD CLASS="l">1435</TD><TD>         *</TD></TR><TR><TD CLASS="l">1436</TD><TD>         * @param name The name to search</TD></TR><TR><TD CLASS="l">1437</TD><TD>         * @param pkg The corresponding package fragment</TD></TR><TR><TD CLASS="l">1438</TD><TD>         * @param partialMatch partial name matches qualify when &lt;code&gt;true&lt;/code&gt;;</TD></TR><TR><TD CLASS="l">1439</TD><TD>         *        only exact name matches qualify when &lt;code&gt;false&lt;/code&gt;</TD></TR><TR><TD CLASS="l">1440</TD><TD>         * @param acceptFlags a bit mask describing if classes, interfaces or both classes and interfaces</TD></TR><TR><TD CLASS="l">1441</TD><TD>         *         are desired results. If no flags are specified, all types are returned.</TD></TR><TR><TD CLASS="l">1442</TD><TD>         * @param requestor The requestor that collects the result</TD></TR><TR><TD CLASS="l">1443</TD><TD>         *</TD></TR><TR><TD CLASS="l">1444</TD><TD>         * @see #ACCEPT_CLASSES</TD></TR><TR><TD CLASS="l">1445</TD><TD>         * @see #ACCEPT_INTERFACES</TD></TR><TR><TD CLASS="l">1446</TD><TD>         * @see #ACCEPT_ENUMS</TD></TR><TR><TD CLASS="l">1447</TD><TD>         * @see #ACCEPT_ANNOTATIONS</TD></TR><TR><TD CLASS="l">1448</TD><TD>         */</TD></TR><TR><TD CLASS="l">1449</TD><TD>        public void seekTypes(String name, IPackageFragment pkg, boolean partialMatch, int acceptFlags, IJavaElementRequestor requestor) {</TD></TR><TR><TD CLASS="l">1450</TD><TD>/*                if (VERBOSE) {</TD></TR><TR><TD CLASS="l">1451</TD><TD>                        Util.verbose(&#34; SEEKING TYPES&#34;);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1452</TD><TD>                        Util.verbose(&#34; -&gt; name: &#34; + name);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l"><A NAME="28">1453</A></TD><TD>                        Util.verbose(&#34; -&gt; pkg: &#34; + ((JavaElement) pkg).toStringWithAncestors());  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1454</TD><TD>                        Util.verbose(&#34; -&gt; partial match:&#34; + partialMatch);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1455</TD><TD>                }</TD></TR><TR><TD CLASS="l">1456</TD><TD>*/</TD></TR><TR CLASS="z"><TD CLASS="l">1457</TD><TD>                String matchName= partialMatch ? name.toLowerCase() : name;</TD></TR><TR CLASS="z"><TD CLASS="l">1458</TD><TD>                if (pkg == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1459</TD><TD>                        findAllTypes(matchName, partialMatch, acceptFlags, requestor);</TD></TR><TR CLASS="z"><TD CLASS="l">1460</TD><TD>                        return;</TD></TR><TR><TD CLASS="l">1461</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1462</TD><TD>                IPackageFragmentRoot root= (IPackageFragmentRoot) pkg.getParent();</TD></TR><TR><TD CLASS="l">1463</TD><TD>                try {</TD></TR><TR><TD CLASS="l">1464</TD><TD> </TD></TR><TR><TD CLASS="l">1465</TD><TD>                        // look in working copies first</TD></TR><TR CLASS="z"><TD CLASS="l">1466</TD><TD>                        int firstDot = -1;</TD></TR><TR CLASS="z"><TD CLASS="l">1467</TD><TD>                        String topLevelTypeName = matchName;</TD></TR><TR CLASS="z"><TD CLASS="l">1468</TD><TD>                        int packageFlavor= root.getKind();</TD></TR><TR><TD CLASS="l">1469</TD><TD>//                        if (this.typesInWorkingCopies != null || packageFlavor == IPackageFragmentRoot.K_SOURCE) {</TD></TR><TR><TD CLASS="l">1470</TD><TD>//                                firstDot = matchName.indexOf('.');</TD></TR><TR><TD CLASS="l">1471</TD><TD>//                                if (!partialMatch)</TD></TR><TR><TD CLASS="l">1472</TD><TD>//                                        topLevelTypeName = firstDot == -1 ? matchName : matchName.substring(0, firstDot);</TD></TR><TR><TD CLASS="l">1473</TD><TD>//                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1474</TD><TD>                        if (this.typesInWorkingCopies != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1475</TD><TD>                                if (seekTypesInWorkingCopies(matchName, pkg, firstDot, partialMatch, topLevelTypeName, acceptFlags, requestor))</TD></TR><TR CLASS="z"><TD CLASS="l">1476</TD><TD>                                        return;</TD></TR><TR><TD CLASS="l">1477</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1478</TD><TD> </TD></TR><TR><TD CLASS="l">1479</TD><TD>                        // look in model</TD></TR><TR CLASS="z"><TD CLASS="l">1480</TD><TD>                        switch (packageFlavor) {</TD></TR><TR><TD CLASS="l">1481</TD><TD>                                case IPackageFragmentRoot.K_BINARY :</TD></TR><TR CLASS="z"><TD CLASS="l">1482</TD><TD>                                        matchName= matchName.replace('.', '$');</TD></TR><TR CLASS="z"><TD CLASS="l">1483</TD><TD>                                        seekBindingsInBinaryPackage(matchName,Binding.TYPE, pkg, partialMatch, acceptFlags, requestor);</TD></TR><TR CLASS="z"><TD CLASS="l">1484</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">1485</TD><TD>                                case IPackageFragmentRoot.K_SOURCE :</TD></TR><TR CLASS="z"><TD CLASS="l">1486</TD><TD>                                        seekTypesInSourcePackage(matchName, pkg, firstDot, partialMatch, topLevelTypeName, acceptFlags, requestor);</TD></TR><TR CLASS="z"><TD CLASS="l">1487</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">1488</TD><TD>                                default :</TD></TR><TR CLASS="z"><TD CLASS="l">1489</TD><TD>                                        return;</TD></TR><TR><TD CLASS="l">1490</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1491</TD><TD>                } catch (JavaScriptModelException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">1492</TD><TD>                        return;</TD></TR><TR><TD CLASS="l">1493</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1494</TD><TD>        }</TD></TR><TR><TD CLASS="l">1495</TD><TD> </TD></TR><TR><TD CLASS="l">1496</TD><TD> </TD></TR><TR><TD CLASS="l">1497</TD><TD>        public void seekBindings(String name, int bindingType, IPackageFragment pkg, boolean partialMatch, int acceptFlags, IJavaElementRequestor requestor) {</TD></TR><TR><TD CLASS="l">1498</TD><TD>                /*                if (VERBOSE) {</TD></TR><TR><TD CLASS="l">1499</TD><TD>                                        Util.verbose(&#34; SEEKING TYPES&#34;);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1500</TD><TD>                                        Util.verbose(&#34; -&gt; name: &#34; + name);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l"><A NAME="23">1501</A></TD><TD>                                        Util.verbose(&#34; -&gt; pkg: &#34; + ((JavaElement) pkg).toStringWithAncestors());  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1502</TD><TD>                                        Util.verbose(&#34; -&gt; partial match:&#34; + partialMatch);  //$NON-NLS-1$</TD></TR><TR><TD CLASS="l">1503</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1504</TD><TD>                */</TD></TR><TR CLASS="z"><TD CLASS="l">1505</TD><TD>                                String matchName= partialMatch ? name.toLowerCase() : name;</TD></TR><TR CLASS="z"><TD CLASS="l">1506</TD><TD>                                if (pkg == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1507</TD><TD>                                        findAllBindings(matchName, bindingType, partialMatch, acceptFlags, requestor);</TD></TR><TR CLASS="z"><TD CLASS="l">1508</TD><TD>                                        return;</TD></TR><TR><TD CLASS="l">1509</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1510</TD><TD>                                IPackageFragmentRoot root= (IPackageFragmentRoot) pkg.getParent();</TD></TR><TR><TD CLASS="l">1511</TD><TD>                                try {</TD></TR><TR><TD CLASS="l">1512</TD><TD> </TD></TR><TR><TD CLASS="l">1513</TD><TD>                                        // look in working copies first</TD></TR><TR CLASS="z"><TD CLASS="l">1514</TD><TD>                                        int firstDot = -1;</TD></TR><TR CLASS="z"><TD CLASS="l">1515</TD><TD>                                        String topLevelTypeName = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1516</TD><TD>                                        int packageFlavor= root.getKind();</TD></TR><TR CLASS="z"><TD CLASS="l">1517</TD><TD>                                        if (this.typesInWorkingCopies != null || packageFlavor == IPackageFragmentRoot.K_SOURCE) {</TD></TR><TR CLASS="z"><TD CLASS="l">1518</TD><TD>                                                firstDot = matchName.indexOf('.');</TD></TR><TR CLASS="z"><TD CLASS="l">1519</TD><TD>                                                if (!partialMatch)</TD></TR><TR CLASS="z"><TD CLASS="l">1520</TD><TD>                                                        topLevelTypeName = firstDot == -1 ? matchName : matchName.substring(0, firstDot);</TD></TR><TR><TD CLASS="l">1521</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1522</TD><TD>                                        if (this.bindingsInWorkingCopies != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1523</TD><TD>                                                if (seekBindingsInWorkingCopies(matchName,bindingType, pkg, firstDot, partialMatch, topLevelTypeName, acceptFlags, requestor))</TD></TR><TR CLASS="z"><TD CLASS="l">1524</TD><TD>                                                        return;</TD></TR><TR><TD CLASS="l">1525</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1526</TD><TD> </TD></TR><TR><TD CLASS="l">1527</TD><TD>                                        // look in model</TD></TR><TR CLASS="z"><TD CLASS="l">1528</TD><TD>                                        switch (packageFlavor) {</TD></TR><TR><TD CLASS="l">1529</TD><TD>                                                case IPackageFragmentRoot.K_BINARY :</TD></TR><TR><TD CLASS="l">1530</TD><TD>//                                                        matchName= matchName.replace('.', '$');</TD></TR><TR CLASS="z"><TD CLASS="l">1531</TD><TD>                                                        seekBindingsInBinaryPackage(matchName,  bindingType,pkg, partialMatch, acceptFlags, requestor);</TD></TR><TR CLASS="z"><TD CLASS="l">1532</TD><TD>                                                        break;</TD></TR><TR><TD CLASS="l">1533</TD><TD>                                                case IPackageFragmentRoot.K_SOURCE :</TD></TR><TR CLASS="z"><TD CLASS="l">1534</TD><TD>                                                        seekBindingsInSourcePackage(matchName, bindingType,pkg, firstDot, partialMatch, topLevelTypeName, acceptFlags, requestor);</TD></TR><TR CLASS="z"><TD CLASS="l">1535</TD><TD>                                                        break;</TD></TR><TR><TD CLASS="l">1536</TD><TD>                                                default :</TD></TR><TR CLASS="z"><TD CLASS="l">1537</TD><TD>                                                        return;</TD></TR><TR><TD CLASS="l">1538</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1539</TD><TD>                                } catch (JavaScriptModelException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">1540</TD><TD>                                        return;</TD></TR><TR><TD CLASS="l">1541</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1542</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1543</TD><TD> </TD></TR><TR><TD CLASS="l">1544</TD><TD> </TD></TR><TR><TD CLASS="l">1545</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1546</TD><TD>         * Performs type search in a binary package.</TD></TR><TR><TD CLASS="l">1547</TD><TD>         */</TD></TR><TR><TD CLASS="l">1548</TD><TD>//        protected void seekTypesInBinaryPackage(String name, IPackageFragment pkg, boolean partialMatch, int acceptFlags, IJavaElementRequestor requestor) {</TD></TR><TR><TD CLASS="l">1549</TD><TD>//                long start = -1;</TD></TR><TR><TD CLASS="l">1550</TD><TD>//                if (VERBOSE)</TD></TR><TR><TD CLASS="l">1551</TD><TD>//                        start = System.currentTimeMillis();</TD></TR><TR><TD CLASS="l">1552</TD><TD>//                try {</TD></TR><TR><TD CLASS="l">1553</TD><TD>//                        if (!partialMatch) {</TD></TR><TR><TD CLASS="l">1554</TD><TD>//                                // exact match</TD></TR><TR><TD CLASS="l">1555</TD><TD>//                                if (requestor.isCanceled()) return;</TD></TR><TR><TD CLASS="l">1556</TD><TD>//                                ClassFile classFile =  new ClassFile((PackageFragment) pkg, name);</TD></TR><TR><TD CLASS="l">1557</TD><TD>//                                if (classFile.existsUsingJarTypeCache()) {</TD></TR><TR><TD CLASS="l">1558</TD><TD>//                                        IType type = classFile.getType();</TD></TR><TR><TD CLASS="l">1559</TD><TD>//                                        if (acceptType(type, acceptFlags, false/*not a source type*/)) {</TD></TR><TR><TD CLASS="l">1560</TD><TD>//                                                requestor.acceptType(type);</TD></TR><TR><TD CLASS="l">1561</TD><TD>//                                        }</TD></TR><TR><TD CLASS="l">1562</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">1563</TD><TD>//                        } else {</TD></TR><TR><TD CLASS="l">1564</TD><TD>//                                IJavaScriptElement[] classFiles= null;</TD></TR><TR><TD CLASS="l">1565</TD><TD>//                                try {</TD></TR><TR><TD CLASS="l">1566</TD><TD>//                                        classFiles= pkg.getChildren();</TD></TR><TR><TD CLASS="l">1567</TD><TD>//                                } catch (JavaScriptModelException npe) {</TD></TR><TR><TD CLASS="l">1568</TD><TD>//                                        return; // the package is not present</TD></TR><TR><TD CLASS="l">1569</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">1570</TD><TD>//                                int length= classFiles.length;</TD></TR><TR><TD CLASS="l">1571</TD><TD>//                                String unqualifiedName = name;</TD></TR><TR><TD CLASS="l">1572</TD><TD>//                                int index = name.lastIndexOf('$');</TD></TR><TR><TD CLASS="l">1573</TD><TD>//                                if (index != -1) {</TD></TR><TR><TD CLASS="l">1574</TD><TD>//                                        //the type name of the inner type</TD></TR><TR><TD CLASS="l">1575</TD><TD>//                                        unqualifiedName = Util.localTypeName(name, index, name.length());</TD></TR><TR><TD CLASS="l">1576</TD><TD>//                                        // unqualifiedName is empty if the name ends with a '$' sign.</TD></TR><TR><TD CLASS="l">1577</TD><TD>//                                        // See http://dev.eclipse.org/bugs/show_bug.cgi?id=14642</TD></TR><TR><TD CLASS="l">1578</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">1579</TD><TD>//                                int matchLength = name.length();</TD></TR><TR><TD CLASS="l">1580</TD><TD>//                                for (int i = 0; i &lt; length; i++) {</TD></TR><TR><TD CLASS="l">1581</TD><TD>//                                        if (requestor.isCanceled())</TD></TR><TR><TD CLASS="l">1582</TD><TD>//                                                return;</TD></TR><TR><TD CLASS="l">1583</TD><TD>//                                        IJavaScriptElement classFile= classFiles[i];</TD></TR><TR><TD CLASS="l">1584</TD><TD>//                                        // MatchName will never have the extension &#34;.class&#34; and the elementName always will.</TD></TR><TR><TD CLASS="l">1585</TD><TD>//                                        String elementName = classFile.getElementName();</TD></TR><TR><TD CLASS="l">1586</TD><TD>//                                        if (elementName.regionMatches(true /*ignore case*/, 0, name, 0, matchLength)) {</TD></TR><TR><TD CLASS="l">1587</TD><TD>//                                                IType type = ((ClassFile) classFile).getType();</TD></TR><TR><TD CLASS="l">1588</TD><TD>//                                                String typeName = type.getElementName();</TD></TR><TR><TD CLASS="l">1589</TD><TD>//                                                if (typeName.length() &gt; 0 &amp;&amp; !Character.isDigit(typeName.charAt(0))) { //not an anonymous type</TD></TR><TR><TD CLASS="l">1590</TD><TD>//                                                        if (nameMatches(unqualifiedName, type, true/*partial match*/) &amp;&amp; acceptType(type, acceptFlags, false/*not a source type*/))</TD></TR><TR><TD CLASS="l">1591</TD><TD>//                                                                requestor.acceptType(type);</TD></TR><TR><TD CLASS="l">1592</TD><TD>//                                                }</TD></TR><TR><TD CLASS="l">1593</TD><TD>//                                        }</TD></TR><TR><TD CLASS="l">1594</TD><TD>//                                }</TD></TR><TR><TD CLASS="l">1595</TD><TD>//                        }</TD></TR><TR><TD CLASS="l">1596</TD><TD>//                } finally {</TD></TR><TR><TD CLASS="l">1597</TD><TD>//                        if (VERBOSE)</TD></TR><TR><TD CLASS="l">1598</TD><TD>//                                this.timeSpentInSeekTypesInBinaryPackage += System.currentTimeMillis()-start;</TD></TR><TR><TD CLASS="l"><A NAME="24">1599</A></TD><TD>//                }</TD></TR><TR><TD CLASS="l">1600</TD><TD>//        }</TD></TR><TR><TD CLASS="l">1601</TD><TD>//</TD></TR><TR><TD CLASS="l">1602</TD><TD>        protected void seekBindingsInBinaryPackage(String name, int bindingType,IPackageFragment pkg, boolean partialMatch, int acceptFlags, IJavaElementRequestor requestor) {</TD></TR><TR CLASS="z"><TD CLASS="l">1603</TD><TD>                long start = -1;</TD></TR><TR CLASS="z"><TD CLASS="l">1604</TD><TD>                if (VERBOSE)</TD></TR><TR CLASS="z"><TD CLASS="l">1605</TD><TD>                        start = System.currentTimeMillis();</TD></TR><TR><TD CLASS="l">1606</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1607</TD><TD>                        this.acceptedCUs.clear();</TD></TR><TR CLASS="z"><TD CLASS="l">1608</TD><TD>                        IJavaScriptElement[] classFiles= null;</TD></TR><TR><TD CLASS="l">1609</TD><TD>                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">1610</TD><TD>                                classFiles= pkg.getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">1611</TD><TD>                        } catch (JavaScriptModelException npe) {</TD></TR><TR CLASS="z"><TD CLASS="l">1612</TD><TD>                                return; // the package is not present</TD></TR><TR><TD CLASS="l">1613</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1614</TD><TD>                        int length= classFiles.length;</TD></TR><TR CLASS="z"><TD CLASS="l">1615</TD><TD>                        if (!partialMatch) {</TD></TR><TR CLASS="z"><TD CLASS="l">1616</TD><TD>                                for (int i = 0; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1617</TD><TD>                                        ClassFile classFile=(ClassFile)classFiles[i];</TD></TR><TR CLASS="z"><TD CLASS="l">1618</TD><TD>                                        if (this.acceptedCUs.contains(classFile))</TD></TR><TR CLASS="z"><TD CLASS="l">1619</TD><TD>                                                continue;</TD></TR><TR CLASS="z"><TD CLASS="l">1620</TD><TD>                                        switch (bindingType) {</TD></TR><TR><TD CLASS="l">1621</TD><TD>                                        case Binding.TYPE:</TD></TR><TR><TD CLASS="l">1622</TD><TD>                                        case Binding.TYPE | Binding.PACKAGE:</TD></TR><TR CLASS="z"><TD CLASS="l">1623</TD><TD>                                                IType type = classFile.getType(name);</TD></TR><TR CLASS="z"><TD CLASS="l">1624</TD><TD>                                                if (acceptType(type, acceptFlags, false/*not a source type*/)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1625</TD><TD>                                                        acceptedCUs.add(classFile);</TD></TR><TR CLASS="z"><TD CLASS="l">1626</TD><TD>                                                        requestor.acceptType(type);</TD></TR><TR><TD CLASS="l">1627</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">1628</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1629</TD><TD>                                                break;</TD></TR><TR><TD CLASS="l">1630</TD><TD>                                        case Binding.VARIABLE:</TD></TR><TR><TD CLASS="l">1631</TD><TD>//                                                String cuName = cu.getElementName();</TD></TR><TR><TD CLASS="l">1632</TD><TD>//                                                int lastDot = cuName.lastIndexOf('.');</TD></TR><TR><TD CLASS="l">1633</TD><TD>//                                                if (lastDot != topLevelTypeName.length() || !topLevelTypeName.regionMatches(0, cuName, 0, lastDot))</TD></TR><TR><TD CLASS="l">1634</TD><TD>//                                                        continue;</TD></TR><TR CLASS="z"><TD CLASS="l">1635</TD><TD>                                                IField field = classFile.getField(name);</TD></TR><TR CLASS="z"><TD CLASS="l">1636</TD><TD>                                                if (field.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1637</TD><TD>                                                        acceptedCUs.add(classFile);</TD></TR><TR CLASS="z"><TD CLASS="l">1638</TD><TD>                                                        requestor.acceptField(field);</TD></TR><TR><TD CLASS="l">1639</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">1640</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1641</TD><TD>                                                break;</TD></TR><TR><TD CLASS="l">1642</TD><TD> </TD></TR><TR><TD CLASS="l">1643</TD><TD>                                        case Binding.METHOD:</TD></TR><TR><TD CLASS="l">1644</TD><TD>//                                                String cuName = cu.getElementName();</TD></TR><TR><TD CLASS="l">1645</TD><TD>//                                                int lastDot = cuName.lastIndexOf('.');</TD></TR><TR><TD CLASS="l">1646</TD><TD>//                                                if (lastDot != topLevelTypeName.length() || !topLevelTypeName.regionMatches(0, cuName, 0, lastDot))</TD></TR><TR><TD CLASS="l">1647</TD><TD>//                                                        continue;</TD></TR><TR CLASS="z"><TD CLASS="l">1648</TD><TD>                                                IFunction method = classFile.getFunction(name, null);</TD></TR><TR CLASS="z"><TD CLASS="l">1649</TD><TD>                                                if (method.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1650</TD><TD>                                                        acceptedCUs.add(classFile);</TD></TR><TR CLASS="z"><TD CLASS="l">1651</TD><TD>                                                        requestor.acceptMethod(method);</TD></TR><TR><TD CLASS="l">1652</TD><TD>                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1653</TD><TD>                                                break;</TD></TR><TR><TD CLASS="l">1654</TD><TD>                                        case Binding.METHOD | Binding.VARIABLE:</TD></TR><TR CLASS="z"><TD CLASS="l">1655</TD><TD>                                                 method = classFile.getFunction(name, null);</TD></TR><TR CLASS="z"><TD CLASS="l">1656</TD><TD>                                                if (method!=null</TD></TR><TR CLASS="z"><TD CLASS="l">1657</TD><TD>                                                        &amp;&amp; method.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1658</TD><TD>                                                                acceptedCUs.add(classFile);</TD></TR><TR CLASS="z"><TD CLASS="l">1659</TD><TD>                                                        requestor.acceptMethod(method);</TD></TR><TR><TD CLASS="l">1660</TD><TD>                                                } else</TD></TR><TR><TD CLASS="l">1661</TD><TD>                                                {</TD></TR><TR CLASS="z"><TD CLASS="l">1662</TD><TD>                                                   field = classFile.getField(name);</TD></TR><TR CLASS="z"><TD CLASS="l">1663</TD><TD>                                                   if (field!=null &amp;&amp; field.exists())</TD></TR><TR><TD CLASS="l">1664</TD><TD>                                                   {</TD></TR><TR CLASS="z"><TD CLASS="l">1665</TD><TD>                                                                acceptedCUs.add(classFile);</TD></TR><TR CLASS="z"><TD CLASS="l">1666</TD><TD>                                                                  requestor.acceptField(field);</TD></TR><TR><TD CLASS="l">1667</TD><TD> </TD></TR><TR><TD CLASS="l">1668</TD><TD>                                                   }</TD></TR><TR><TD CLASS="l">1669</TD><TD>                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1670</TD><TD>                                                break;</TD></TR><TR><TD CLASS="l">1671</TD><TD>                                          default:</TD></TR><TR><TD CLASS="l">1672</TD><TD>                                          {</TD></TR><TR CLASS="z"><TD CLASS="l">1673</TD><TD>                                                        if ((Binding.TYPE &amp; bindingType)!=0)</TD></TR><TR><TD CLASS="l">1674</TD><TD>                                                        {</TD></TR><TR CLASS="z"><TD CLASS="l">1675</TD><TD>                                                                IType thisType = classFile.getType(name);</TD></TR><TR CLASS="z"><TD CLASS="l">1676</TD><TD>                                                                if (acceptType(thisType, acceptFlags, false/*not a source type*/)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1677</TD><TD>                                                                        acceptedCUs.add(classFile);</TD></TR><TR CLASS="z"><TD CLASS="l">1678</TD><TD>                                                                        requestor.acceptType(thisType);</TD></TR><TR><TD CLASS="l">1679</TD><TD>                                                                }</TD></TR><TR><TD CLASS="l">1680</TD><TD>                                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1681</TD><TD>                                                        if ((Binding.METHOD &amp; bindingType)!=0)</TD></TR><TR><TD CLASS="l">1682</TD><TD>                                                        {</TD></TR><TR CLASS="z"><TD CLASS="l">1683</TD><TD>                                                                 method = classFile.getFunction(name, null);</TD></TR><TR CLASS="z"><TD CLASS="l">1684</TD><TD>                                                                        if (method!=null &amp;&amp; method.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1685</TD><TD>                                                                                acceptedCUs.add(classFile);</TD></TR><TR CLASS="z"><TD CLASS="l">1686</TD><TD>                                                                                requestor.acceptMethod(method);</TD></TR><TR><TD CLASS="l">1687</TD><TD>                                                                        }</TD></TR><TR><TD CLASS="l">1688</TD><TD>                                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1689</TD><TD>                                                        if ((Binding.VARIABLE &amp; bindingType)!=0)</TD></TR><TR><TD CLASS="l">1690</TD><TD>                                                        {</TD></TR><TR CLASS="z"><TD CLASS="l">1691</TD><TD>                                                           field = classFile.getField(name);</TD></TR><TR CLASS="z"><TD CLASS="l">1692</TD><TD>                                                                if (field!=null &amp;&amp; field.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1693</TD><TD>                                                                        acceptedCUs.add(classFile);</TD></TR><TR CLASS="z"><TD CLASS="l">1694</TD><TD>                                                                        requestor.acceptField(field);</TD></TR><TR><TD CLASS="l">1695</TD><TD>                                                                }</TD></TR><TR><TD CLASS="l">1696</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">1697</TD><TD>                                          }</TD></TR><TR><TD CLASS="l">1698</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1699</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1700</TD><TD>                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1701</TD><TD>                                String unqualifiedName = name;</TD></TR><TR CLASS="z"><TD CLASS="l">1702</TD><TD>                                int index = name.lastIndexOf('$');</TD></TR><TR CLASS="z"><TD CLASS="l">1703</TD><TD>                                if (index != -1) {</TD></TR><TR><TD CLASS="l">1704</TD><TD>                                        //the type name of the inner type</TD></TR><TR CLASS="z"><TD CLASS="l">1705</TD><TD>                                        unqualifiedName = Util.localTypeName(name, index, name.length());</TD></TR><TR><TD CLASS="l">1706</TD><TD>                                        // unqualifiedName is empty if the name ends with a '$' sign.</TD></TR><TR><TD CLASS="l">1707</TD><TD>                                        // See http://dev.eclipse.org/bugs/show_bug.cgi?id=14642</TD></TR><TR><TD CLASS="l">1708</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">1709</TD><TD>                                int matchLength = name.length();</TD></TR><TR CLASS="z"><TD CLASS="l">1710</TD><TD>                                for (int i = 0; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1711</TD><TD>                                        if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">1712</TD><TD>                                                return;</TD></TR><TR CLASS="z"><TD CLASS="l">1713</TD><TD>                                        IJavaScriptElement classFile= classFiles[i];</TD></TR><TR><TD CLASS="l">1714</TD><TD>                                        // MatchName will never have the extension &#34;.class&#34; and the elementName always will.</TD></TR><TR CLASS="z"><TD CLASS="l">1715</TD><TD>                                        String elementName = classFile.getElementName();</TD></TR><TR CLASS="z"><TD CLASS="l">1716</TD><TD>                                        if (elementName.regionMatches(true /*ignore case*/, 0, name, 0, matchLength)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1717</TD><TD>                                                IType type = ((ClassFile) classFile).getType();</TD></TR><TR CLASS="z"><TD CLASS="l">1718</TD><TD>                                                String typeName = type.getElementName();</TD></TR><TR CLASS="z"><TD CLASS="l">1719</TD><TD>                                                if (typeName.length() &gt; 0 &amp;&amp; !Character.isDigit(typeName.charAt(0))) { //not an anonymous type</TD></TR><TR CLASS="z"><TD CLASS="l">1720</TD><TD>                                                        if (nameMatches(unqualifiedName, type, true/*partial match*/) &amp;&amp; acceptType(type, acceptFlags, false/*not a source type*/))</TD></TR><TR CLASS="z"><TD CLASS="l">1721</TD><TD>                                                                requestor.acceptType(type);</TD></TR><TR><TD CLASS="l">1722</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">1723</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1724</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1725</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1726</TD><TD>                } finally {</TD></TR><TR CLASS="z"><TD CLASS="l">1727</TD><TD>                        if (VERBOSE)</TD></TR><TR CLASS="z"><TD CLASS="l">1728</TD><TD>                                this.timeSpentInSeekTypesInBinaryPackage += System.currentTimeMillis()-start;</TD></TR><TR CLASS="z"><TD CLASS="l">1729</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1730</TD><TD>        }</TD></TR><TR><TD CLASS="l">1731</TD><TD> </TD></TR><TR><TD CLASS="l">1732</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1733</TD><TD>         * Performs type search in a source package.</TD></TR><TR><TD CLASS="l">1734</TD><TD>         */</TD></TR><TR><TD CLASS="l">1735</TD><TD>        protected void seekTypesInSourcePackage(</TD></TR><TR><TD CLASS="l">1736</TD><TD>                        String name,</TD></TR><TR><TD CLASS="l">1737</TD><TD>                        IPackageFragment pkg,</TD></TR><TR><TD CLASS="l">1738</TD><TD>                        int firstDot,</TD></TR><TR><TD CLASS="l">1739</TD><TD>                        boolean partialMatch,</TD></TR><TR><TD CLASS="l"><A NAME="29">1740</A></TD><TD>                        String topLevelTypeName,</TD></TR><TR><TD CLASS="l">1741</TD><TD>                        int acceptFlags,</TD></TR><TR><TD CLASS="l">1742</TD><TD>                        IJavaElementRequestor requestor) {</TD></TR><TR><TD CLASS="l">1743</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1744</TD><TD>                long start = -1;</TD></TR><TR CLASS="z"><TD CLASS="l">1745</TD><TD>                if (VERBOSE)</TD></TR><TR CLASS="z"><TD CLASS="l">1746</TD><TD>                        start = System.currentTimeMillis();</TD></TR><TR><TD CLASS="l">1747</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1748</TD><TD>                        if (!partialMatch) {</TD></TR><TR><TD CLASS="l">1749</TD><TD>                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1750</TD><TD>                                        IJavaScriptElement[] compilationUnits = pkg.getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">1751</TD><TD>                                        for (int i = 0, length = compilationUnits.length; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1752</TD><TD>                                                if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">1753</TD><TD>                                                        return;</TD></TR><TR CLASS="z"><TD CLASS="l">1754</TD><TD>                                                IJavaScriptElement cu = compilationUnits[i];</TD></TR><TR><TD CLASS="l">1755</TD><TD>//                                                String cuName = cu.getElementName();</TD></TR><TR><TD CLASS="l">1756</TD><TD>                                                //int lastDot = cuName.lastIndexOf('.');</TD></TR><TR><TD CLASS="l">1757</TD><TD>                                                //if (lastDot != topLevelTypeName.length() || !topLevelTypeName.regionMatches(0, cuName, 0, lastDot)) \</TD></TR><TR><TD CLASS="l">1758</TD><TD>                                                //if(topLevelTypeName!=null &amp;&amp; !topLevelTypeName.equals(cuName))</TD></TR><TR><TD CLASS="l">1759</TD><TD>                                                //        continue;</TD></TR><TR CLASS="z"><TD CLASS="l">1760</TD><TD>                                                IType type = ((IJavaScriptUnit) cu).getType(name);</TD></TR><TR><TD CLASS="l">1761</TD><TD>                                                //type = getMemberType(type, name, firstDot);</TD></TR><TR CLASS="z"><TD CLASS="l">1762</TD><TD>                                                if (acceptType(type, acceptFlags, true/*a source type*/)) { // accept type checks for existence</TD></TR><TR CLASS="z"><TD CLASS="l">1763</TD><TD>                                                        requestor.acceptType(type);</TD></TR><TR CLASS="z"><TD CLASS="l">1764</TD><TD>                                                        break;  // since an exact match was requested, no other matching type can exist</TD></TR><TR><TD CLASS="l">1765</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">1766</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1767</TD><TD>                                } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">1768</TD><TD>                                        // package doesn't exist -&gt; ignore</TD></TR><TR><TD CLASS="l">1769</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1770</TD><TD>                        } else {</TD></TR><TR><TD CLASS="l">1771</TD><TD>                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1772</TD><TD>                                        String cuPrefix = firstDot == -1 ? name : name.substring(0, firstDot);</TD></TR><TR CLASS="z"><TD CLASS="l">1773</TD><TD>                                        IJavaScriptElement[] compilationUnits = pkg.getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">1774</TD><TD>                                        for (int i = 0, length = compilationUnits.length; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1775</TD><TD>                                                if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">1776</TD><TD>                                                        return;</TD></TR><TR CLASS="z"><TD CLASS="l">1777</TD><TD>                                                IJavaScriptElement cu = compilationUnits[i];</TD></TR><TR CLASS="z"><TD CLASS="l">1778</TD><TD>                                                if (!cu.getElementName().toLowerCase().startsWith(cuPrefix))</TD></TR><TR CLASS="z"><TD CLASS="l">1779</TD><TD>                                                        continue;</TD></TR><TR><TD CLASS="l">1780</TD><TD>                                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1781</TD><TD>                                                        IType[] types = ((IJavaScriptUnit) cu).getTypes();</TD></TR><TR CLASS="z"><TD CLASS="l">1782</TD><TD>                                                        for (int j = 0, typeLength = types.length; j &lt; typeLength; j++)</TD></TR><TR CLASS="z"><TD CLASS="l">1783</TD><TD>                                                                seekTypesInTopLevelType(name, firstDot, types[j], requestor, acceptFlags);</TD></TR><TR CLASS="z"><TD CLASS="l">1784</TD><TD>                                                } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">1785</TD><TD>                                                        // cu doesn't exist -&gt; ignore</TD></TR><TR><TD CLASS="l">1786</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">1787</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1788</TD><TD>                                } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">1789</TD><TD>                                        // package doesn't exist -&gt; ignore</TD></TR><TR><TD CLASS="l">1790</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1791</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1792</TD><TD>                } finally {</TD></TR><TR CLASS="z"><TD CLASS="l">1793</TD><TD>                        if (VERBOSE)</TD></TR><TR CLASS="z"><TD CLASS="l">1794</TD><TD>                                this.timeSpentInSeekTypesInSourcePackage += System.currentTimeMillis()-start;</TD></TR><TR CLASS="z"><TD CLASS="l">1795</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1796</TD><TD>        }</TD></TR><TR><TD CLASS="l">1797</TD><TD> </TD></TR><TR><TD CLASS="l">1798</TD><TD>        protected void seekBindingsInSourcePackage(</TD></TR><TR><TD CLASS="l">1799</TD><TD>                        String name,</TD></TR><TR><TD CLASS="l">1800</TD><TD>                        int bindingType,</TD></TR><TR><TD CLASS="l">1801</TD><TD>                        IPackageFragment pkg,</TD></TR><TR><TD CLASS="l">1802</TD><TD>                        int firstDot,</TD></TR><TR><TD CLASS="l">1803</TD><TD>                        boolean partialMatch,</TD></TR><TR><TD CLASS="l"><A NAME="25">1804</A></TD><TD>                        String topLevelTypeName,</TD></TR><TR><TD CLASS="l">1805</TD><TD>                        int acceptFlags,</TD></TR><TR><TD CLASS="l">1806</TD><TD>                        IJavaElementRequestor requestor) {</TD></TR><TR><TD CLASS="l">1807</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1808</TD><TD>                long start = -1;</TD></TR><TR CLASS="z"><TD CLASS="l">1809</TD><TD>                if (VERBOSE)</TD></TR><TR CLASS="z"><TD CLASS="l">1810</TD><TD>                        start = System.currentTimeMillis();</TD></TR><TR><TD CLASS="l">1811</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1812</TD><TD>                        if (!partialMatch) {</TD></TR><TR><TD CLASS="l">1813</TD><TD>                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1814</TD><TD>                                        IJavaScriptElement[] compilationUnits = pkg.getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">1815</TD><TD>                                        for (int i = 0, length = compilationUnits.length; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1816</TD><TD>                                                if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">1817</TD><TD>                                                        return;</TD></TR><TR CLASS="z"><TD CLASS="l">1818</TD><TD>                                                IJavaScriptElement cu = compilationUnits[i];</TD></TR><TR CLASS="z"><TD CLASS="l">1819</TD><TD>                                                if (cu instanceof IJavaScriptUnit &amp;&amp; ((IJavaScriptUnit)cu).isWorkingCopy())</TD></TR><TR CLASS="z"><TD CLASS="l">1820</TD><TD>                                                        continue;</TD></TR><TR CLASS="z"><TD CLASS="l">1821</TD><TD>                                                if (this.acceptedCUs.contains(cu))</TD></TR><TR CLASS="z"><TD CLASS="l">1822</TD><TD>                                                        continue;</TD></TR><TR><TD CLASS="l">1823</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1824</TD><TD>                                                switch (bindingType) {</TD></TR><TR><TD CLASS="l">1825</TD><TD>                                                case Binding.TYPE:</TD></TR><TR><TD CLASS="l">1826</TD><TD>//                                                        String cuName = cu.getElementName();</TD></TR><TR><TD CLASS="l">1827</TD><TD>//                                                        int lastDot = cuName.lastIndexOf('.');</TD></TR><TR><TD CLASS="l">1828</TD><TD>//                                                        if (lastDot != topLevelTypeName.length() || !topLevelTypeName.regionMatches(0, cuName, 0, lastDot))</TD></TR><TR><TD CLASS="l">1829</TD><TD>//                                                                continue;</TD></TR><TR CLASS="z"><TD CLASS="l">1830</TD><TD>                                                        IType type = ((IJavaScriptUnit) cu).getType(topLevelTypeName);</TD></TR><TR CLASS="z"><TD CLASS="l">1831</TD><TD>                                                        type = getMemberType(type, name, firstDot);</TD></TR><TR CLASS="z"><TD CLASS="l">1832</TD><TD>                                                        if (acceptType(type, acceptFlags, true/*a source type*/)) { // accept type checks for existence</TD></TR><TR CLASS="z"><TD CLASS="l">1833</TD><TD>                                                                acceptedCUs.add(cu);</TD></TR><TR CLASS="z"><TD CLASS="l">1834</TD><TD>                                                                requestor.acceptType(type);</TD></TR><TR CLASS="z"><TD CLASS="l">1835</TD><TD>                                                                break;  // since an exact match was requested, no other matching type can exist</TD></TR><TR><TD CLASS="l">1836</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">1837</TD><TD> </TD></TR><TR><TD CLASS="l">1838</TD><TD>                                                        break;</TD></TR><TR><TD CLASS="l">1839</TD><TD>                                                case Binding.VARIABLE:</TD></TR><TR><TD CLASS="l">1840</TD><TD>//                                                        String cuName = cu.getElementName();</TD></TR><TR><TD CLASS="l">1841</TD><TD>//                                                        int lastDot = cuName.lastIndexOf('.');</TD></TR><TR><TD CLASS="l">1842</TD><TD>//                                                        if (lastDot != topLevelTypeName.length() || !topLevelTypeName.regionMatches(0, cuName, 0, lastDot))</TD></TR><TR><TD CLASS="l">1843</TD><TD>//                                                                continue;</TD></TR><TR CLASS="z"><TD CLASS="l">1844</TD><TD>                                                        IField field = ((IJavaScriptUnit) cu).getField(name);</TD></TR><TR CLASS="z"><TD CLASS="l">1845</TD><TD>                                                        if (field.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1846</TD><TD>                                                                acceptedCUs.add(cu);</TD></TR><TR CLASS="z"><TD CLASS="l">1847</TD><TD>                                                                requestor.acceptField(field);</TD></TR><TR><TD CLASS="l">1848</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">1849</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1850</TD><TD>                                                        break;</TD></TR><TR><TD CLASS="l">1851</TD><TD> </TD></TR><TR><TD CLASS="l">1852</TD><TD>                                                case Binding.METHOD:</TD></TR><TR><TD CLASS="l">1853</TD><TD>//                                                        String cuName = cu.getElementName();</TD></TR><TR><TD CLASS="l">1854</TD><TD>//                                                        int lastDot = cuName.lastIndexOf('.');</TD></TR><TR><TD CLASS="l">1855</TD><TD>//                                                        if (lastDot != topLevelTypeName.length() || !topLevelTypeName.regionMatches(0, cuName, 0, lastDot))</TD></TR><TR><TD CLASS="l">1856</TD><TD>//                                                                continue;</TD></TR><TR CLASS="z"><TD CLASS="l">1857</TD><TD>                                                        IFunction method = ((IJavaScriptUnit) cu).getFunction(name, null);</TD></TR><TR CLASS="z"><TD CLASS="l">1858</TD><TD>                                                        if (method.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1859</TD><TD>                                                                acceptedCUs.add(cu);</TD></TR><TR CLASS="z"><TD CLASS="l">1860</TD><TD>                                                                requestor.acceptMethod(method);</TD></TR><TR><TD CLASS="l">1861</TD><TD>                                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1862</TD><TD>                                                        break;</TD></TR><TR><TD CLASS="l">1863</TD><TD>                                                case Binding.METHOD | Binding.VARIABLE:</TD></TR><TR CLASS="z"><TD CLASS="l">1864</TD><TD>                                                         method = ((IJavaScriptUnit) cu).getFunction(name, null);</TD></TR><TR CLASS="z"><TD CLASS="l">1865</TD><TD>                                                        if (method!=null)</TD></TR><TR CLASS="z"><TD CLASS="l">1866</TD><TD>                                                                if  (method.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1867</TD><TD>                                                                        acceptedCUs.add(cu);</TD></TR><TR CLASS="z"><TD CLASS="l">1868</TD><TD>                                                                        requestor.acceptMethod(method);</TD></TR><TR><TD CLASS="l">1869</TD><TD>                                                                } else</TD></TR><TR><TD CLASS="l">1870</TD><TD>                                                        {</TD></TR><TR CLASS="z"><TD CLASS="l">1871</TD><TD>                                                           field = ((IJavaScriptUnit) cu).getField(name);</TD></TR><TR CLASS="z"><TD CLASS="l">1872</TD><TD>                                                                if  (field.exists()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1873</TD><TD>                                                                        acceptedCUs.add(cu);</TD></TR><TR CLASS="z"><TD CLASS="l">1874</TD><TD>                                                                        requestor.acceptField(field);</TD></TR><TR><TD CLASS="l">1875</TD><TD>                                                                }</TD></TR><TR><TD CLASS="l">1876</TD><TD>                                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1877</TD><TD>                                                        break;</TD></TR><TR><TD CLASS="l">1878</TD><TD> </TD></TR><TR><TD CLASS="l">1879</TD><TD>                                                default:</TD></TR><TR><TD CLASS="l">1880</TD><TD>                                                        break;</TD></TR><TR><TD CLASS="l">1881</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">1882</TD><TD> </TD></TR><TR><TD CLASS="l">1883</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1884</TD><TD>                                } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">1885</TD><TD>                                        // package doesn't exist -&gt; ignore</TD></TR><TR><TD CLASS="l">1886</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1887</TD><TD>                        } else {</TD></TR><TR><TD CLASS="l">1888</TD><TD>                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1889</TD><TD>                                        String cuPrefix = firstDot == -1 ? name : name.substring(0, firstDot);</TD></TR><TR CLASS="z"><TD CLASS="l">1890</TD><TD>                                        IJavaScriptElement[] compilationUnits = pkg.getChildren();</TD></TR><TR CLASS="z"><TD CLASS="l">1891</TD><TD>                                        for (int i = 0, length = compilationUnits.length; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1892</TD><TD>                                                if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">1893</TD><TD>                                                        return;</TD></TR><TR CLASS="z"><TD CLASS="l">1894</TD><TD>                                                IJavaScriptElement cu = compilationUnits[i];</TD></TR><TR CLASS="z"><TD CLASS="l">1895</TD><TD>                                                if (!cu.getElementName().toLowerCase().startsWith(cuPrefix))</TD></TR><TR CLASS="z"><TD CLASS="l">1896</TD><TD>                                                        continue;</TD></TR><TR><TD CLASS="l">1897</TD><TD>                                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1898</TD><TD>                                                        IType[] types = ((IJavaScriptUnit) cu).getTypes();</TD></TR><TR CLASS="z"><TD CLASS="l">1899</TD><TD>                                                        for (int j = 0, typeLength = types.length; j &lt; typeLength; j++)</TD></TR><TR CLASS="z"><TD CLASS="l">1900</TD><TD>                                                                seekTypesInTopLevelType(name, firstDot, types[j], requestor, acceptFlags);</TD></TR><TR CLASS="z"><TD CLASS="l">1901</TD><TD>                                                } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">1902</TD><TD>                                                        // cu doesn't exist -&gt; ignore</TD></TR><TR><TD CLASS="l">1903</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">1904</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1905</TD><TD>                                } catch (JavaScriptModelException e) {</TD></TR><TR><TD CLASS="l">1906</TD><TD>                                        // package doesn't exist -&gt; ignore</TD></TR><TR><TD CLASS="l">1907</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1908</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1909</TD><TD>                } finally {</TD></TR><TR CLASS="z"><TD CLASS="l">1910</TD><TD>                        if (VERBOSE)</TD></TR><TR CLASS="z"><TD CLASS="l">1911</TD><TD>                                this.timeSpentInSeekTypesInSourcePackage += System.currentTimeMillis()-start;</TD></TR><TR CLASS="z"><TD CLASS="l">1912</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1913</TD><TD>        }</TD></TR><TR><TD CLASS="l">1914</TD><TD> </TD></TR><TR><TD CLASS="l">1915</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1916</TD><TD>         * Notifies the given requestor of all types (classes and interfaces) in the</TD></TR><TR><TD CLASS="l">1917</TD><TD>         * given type with the given (possibly qualified) name. Checks</TD></TR><TR><TD CLASS="l"><A NAME="2b">1918</A></TD><TD>         * the requestor at regular intervals to see if the requestor</TD></TR><TR><TD CLASS="l">1919</TD><TD>         * has canceled.</TD></TR><TR><TD CLASS="l">1920</TD><TD>         */</TD></TR><TR><TD CLASS="l">1921</TD><TD>        protected boolean seekTypesInType(String prefix, int firstDot, IType type, IJavaElementRequestor requestor, int acceptFlags) {</TD></TR><TR CLASS="z"><TD CLASS="l">1922</TD><TD>                IType[] types= null;</TD></TR><TR><TD CLASS="l">1923</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1924</TD><TD>                        types= type.getTypes();</TD></TR><TR CLASS="z"><TD CLASS="l">1925</TD><TD>                } catch (JavaScriptModelException npe) {</TD></TR><TR CLASS="z"><TD CLASS="l">1926</TD><TD>                        return false; // the enclosing type is not present</TD></TR><TR><TD CLASS="l">1927</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1928</TD><TD>                int length= types.length;</TD></TR><TR CLASS="z"><TD CLASS="l">1929</TD><TD>                if (length == 0) return false;</TD></TR><TR><TD CLASS="l">1930</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1931</TD><TD>                String memberPrefix = prefix;</TD></TR><TR CLASS="z"><TD CLASS="l">1932</TD><TD>                boolean isMemberTypePrefix = false;</TD></TR><TR CLASS="z"><TD CLASS="l">1933</TD><TD>                if (firstDot != -1) {</TD></TR><TR CLASS="z"><TD CLASS="l">1934</TD><TD>                        memberPrefix= prefix.substring(0, firstDot);</TD></TR><TR CLASS="z"><TD CLASS="l">1935</TD><TD>                        isMemberTypePrefix = true;</TD></TR><TR><TD CLASS="l">1936</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1937</TD><TD>                for (int i= 0; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1938</TD><TD>                        if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">1939</TD><TD>                                return false;</TD></TR><TR CLASS="z"><TD CLASS="l">1940</TD><TD>                        IType memberType= types[i];</TD></TR><TR CLASS="z"><TD CLASS="l">1941</TD><TD>                        if (memberType.getElementName().toLowerCase().startsWith(memberPrefix))</TD></TR><TR CLASS="z"><TD CLASS="l">1942</TD><TD>                                if (isMemberTypePrefix) {</TD></TR><TR CLASS="z"><TD CLASS="l">1943</TD><TD>                                        String subPrefix = prefix.substring(firstDot + 1, prefix.length());</TD></TR><TR CLASS="z"><TD CLASS="l">1944</TD><TD>                                        return seekTypesInType(subPrefix, subPrefix.indexOf('.'), memberType, requestor, acceptFlags);</TD></TR><TR><TD CLASS="l">1945</TD><TD>                                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1946</TD><TD>                                        if (acceptType(memberType, acceptFlags, true/*a source type*/)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1947</TD><TD>                                                requestor.acceptMemberType(memberType);</TD></TR><TR CLASS="z"><TD CLASS="l">1948</TD><TD>                                                return true;</TD></TR><TR><TD CLASS="l">1949</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1950</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1951</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2a">1952</A></TD><TD>                return false;</TD></TR><TR><TD CLASS="l">1953</TD><TD>        }</TD></TR><TR><TD CLASS="l">1954</TD><TD> </TD></TR><TR><TD CLASS="l">1955</TD><TD>        protected boolean seekTypesInTopLevelType(String prefix, int firstDot, IType topLevelType, IJavaElementRequestor requestor, int acceptFlags) {</TD></TR><TR CLASS="z"><TD CLASS="l">1956</TD><TD>                if (!topLevelType.getElementName().toLowerCase().startsWith(prefix))</TD></TR><TR CLASS="z"><TD CLASS="l">1957</TD><TD>                        return false;</TD></TR><TR CLASS="z"><TD CLASS="l">1958</TD><TD>                if (firstDot == -1) {</TD></TR><TR CLASS="z"><TD CLASS="l">1959</TD><TD>                        if (acceptType(topLevelType, acceptFlags, true/*a source type*/)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1960</TD><TD>                                requestor.acceptType(topLevelType);</TD></TR><TR CLASS="z"><TD CLASS="l">1961</TD><TD>                                return true;</TD></TR><TR><TD CLASS="l">1962</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1963</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1964</TD><TD>                        return seekTypesInType(prefix, firstDot, topLevelType, requestor, acceptFlags);</TD></TR><TR><TD CLASS="l">1965</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1966</TD><TD>                return false;</TD></TR><TR><TD CLASS="l">1967</TD><TD>        }</TD></TR><TR><TD CLASS="l">1968</TD><TD> </TD></TR><TR><TD CLASS="l">1969</TD><TD>        /*</TD></TR><TR><TD CLASS="l">1970</TD><TD>         * Seeks the type with the given name in the map of types with precedence (coming from working copies)</TD></TR><TR><TD CLASS="l">1971</TD><TD>         * Return whether a type has been found.</TD></TR><TR><TD CLASS="l">1972</TD><TD>         */</TD></TR><TR><TD CLASS="l">1973</TD><TD>        protected boolean seekTypesInWorkingCopies(</TD></TR><TR><TD CLASS="l">1974</TD><TD>                        String name,</TD></TR><TR><TD CLASS="l">1975</TD><TD>                        IPackageFragment pkg,</TD></TR><TR><TD CLASS="l">1976</TD><TD>                        int firstDot,</TD></TR><TR><TD CLASS="l">1977</TD><TD>                        boolean partialMatch,</TD></TR><TR><TD CLASS="l"><A NAME="2c">1978</A></TD><TD>                        String topLevelTypeName,</TD></TR><TR><TD CLASS="l">1979</TD><TD>                        int acceptFlags,</TD></TR><TR><TD CLASS="l">1980</TD><TD>                        IJavaElementRequestor requestor) {</TD></TR><TR><TD CLASS="l">1981</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1982</TD><TD>                if (!partialMatch) {</TD></TR><TR CLASS="z"><TD CLASS="l">1983</TD><TD>                        HashMap typeMap = (HashMap) (this.typesInWorkingCopies == null ? null : this.typesInWorkingCopies.get(pkg));</TD></TR><TR CLASS="z"><TD CLASS="l">1984</TD><TD>                        if (typeMap != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1985</TD><TD>                                Object object = typeMap.get(topLevelTypeName);</TD></TR><TR CLASS="z"><TD CLASS="l">1986</TD><TD>                                if (object instanceof IType) {</TD></TR><TR CLASS="z"><TD CLASS="l">1987</TD><TD>                                        IType type = getMemberType((IType) object, name, firstDot);</TD></TR><TR CLASS="z"><TD CLASS="l">1988</TD><TD>                                        if (acceptType(type, acceptFlags, true/*a source type*/)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1989</TD><TD>                                                requestor.acceptType(type);</TD></TR><TR CLASS="z"><TD CLASS="l">1990</TD><TD>                                                return true; // don't continue with compilation unit</TD></TR><TR><TD CLASS="l">1991</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">1992</TD><TD>                                } else if (object instanceof IType[]) {</TD></TR><TR CLASS="z"><TD CLASS="l">1993</TD><TD>                                        if (object == NO_TYPES) return true; // all types where deleted -&gt; type is hidden</TD></TR><TR CLASS="z"><TD CLASS="l">1994</TD><TD>                                        IType[] topLevelTypes = (IType[]) object;</TD></TR><TR CLASS="z"><TD CLASS="l">1995</TD><TD>                                        for (int i = 0, length = topLevelTypes.length; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">1996</TD><TD>                                                if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">1997</TD><TD>                                                        return false;</TD></TR><TR CLASS="z"><TD CLASS="l">1998</TD><TD>                                                IType type = getMemberType(topLevelTypes[i], name, firstDot);</TD></TR><TR CLASS="z"><TD CLASS="l">1999</TD><TD>                                                if (acceptType(type, acceptFlags, true/*a source type*/)) {</TD></TR><TR CLASS="z"><TD CLASS="l">2000</TD><TD>                                                        requestor.acceptType(type);</TD></TR><TR CLASS="z"><TD CLASS="l">2001</TD><TD>                                                        return true; // return the first one</TD></TR><TR><TD CLASS="l">2002</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">2003</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">2004</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2005</TD><TD>                        }</TD></TR><TR><TD CLASS="l">2006</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">2007</TD><TD>                        HashMap typeMap = (HashMap) (this.typesInWorkingCopies == null ? null : this.typesInWorkingCopies.get(pkg));</TD></TR><TR CLASS="z"><TD CLASS="l">2008</TD><TD>                        if (typeMap != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">2009</TD><TD>                                Iterator iterator = typeMap.values().iterator();</TD></TR><TR CLASS="z"><TD CLASS="l">2010</TD><TD>                                while (iterator.hasNext()) {</TD></TR><TR CLASS="z"><TD CLASS="l">2011</TD><TD>                                        if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">2012</TD><TD>                                                return false;</TD></TR><TR CLASS="z"><TD CLASS="l">2013</TD><TD>                                        Object object = iterator.next();</TD></TR><TR CLASS="z"><TD CLASS="l">2014</TD><TD>                                        if (object instanceof IType) {</TD></TR><TR CLASS="z"><TD CLASS="l">2015</TD><TD>                                                seekTypesInTopLevelType(name, firstDot, (IType) object, requestor, acceptFlags);</TD></TR><TR CLASS="z"><TD CLASS="l">2016</TD><TD>                                        } else if (object instanceof IType[]) {</TD></TR><TR CLASS="z"><TD CLASS="l">2017</TD><TD>                                                IType[] topLevelTypes = (IType[]) object;</TD></TR><TR CLASS="z"><TD CLASS="l">2018</TD><TD>                                                for (int i = 0, length = topLevelTypes.length; i &lt; length; i++)</TD></TR><TR CLASS="z"><TD CLASS="l">2019</TD><TD>                                                        seekTypesInTopLevelType(name, firstDot, topLevelTypes[i], requestor, acceptFlags);</TD></TR><TR><TD CLASS="l">2020</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">2021</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2022</TD><TD>                        }</TD></TR><TR><TD CLASS="l">2023</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">2024</TD><TD>                return false;</TD></TR><TR><TD CLASS="l">2025</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="5">2026</A></TD><TD> </TD></TR><TR><TD CLASS="l">2027</TD><TD> </TD></TR><TR><TD CLASS="l">2028</TD><TD>        private boolean checkBindingAccept(String topLevelTypeName,HashMap []bindingsMap,int bindingType,IJavaElementRequestor requestor)</TD></TR><TR><TD CLASS="l">2029</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2030</TD><TD>                Object object = bindingsMap[bindingType].get(topLevelTypeName);</TD></TR><TR CLASS="z"><TD CLASS="l">2031</TD><TD>                if (object instanceof IJavaScriptElement) {</TD></TR><TR CLASS="z"><TD CLASS="l">2032</TD><TD>                        if (doAcceptBinding((IJavaScriptElement)object, bindingType , true/*a source type*/,requestor)) {</TD></TR><TR CLASS="z"><TD CLASS="l">2033</TD><TD>                                return true; // don't continue with compilation unit</TD></TR><TR><TD CLASS="l">2034</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">2035</TD><TD>                } else if (object instanceof IJavaScriptElement[]) {</TD></TR><TR CLASS="z"><TD CLASS="l">2036</TD><TD>                        if (object == NO_BINDINGS) return true; // all types where deleted -&gt; type is hidden</TD></TR><TR CLASS="z"><TD CLASS="l">2037</TD><TD>                        IJavaScriptElement[] topLevelElements = (IJavaScriptElement[]) object;</TD></TR><TR CLASS="z"><TD CLASS="l">2038</TD><TD>                        for (int i = 0, length = topLevelElements.length; i &lt; length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">2039</TD><TD>                                if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">2040</TD><TD>                                        return false;</TD></TR><TR CLASS="z"><TD CLASS="l">2041</TD><TD>                                if (doAcceptBinding(topLevelElements[i], bindingType, true/*a source type*/,requestor)) {</TD></TR><TR CLASS="z"><TD CLASS="l">2042</TD><TD>                                        return true; // return the first one</TD></TR><TR><TD CLASS="l">2043</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2044</TD><TD>                        }</TD></TR><TR><TD CLASS="l">2045</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">2046</TD><TD>                return false;</TD></TR><TR><TD CLASS="l">2047</TD><TD> </TD></TR><TR><TD CLASS="l">2048</TD><TD>        }</TD></TR><TR><TD CLASS="l">2049</TD><TD>        protected boolean seekBindingsInWorkingCopies(</TD></TR><TR><TD CLASS="l">2050</TD><TD>                        String name,</TD></TR><TR><TD CLASS="l">2051</TD><TD>                        int bindingType,</TD></TR><TR><TD CLASS="l">2052</TD><TD>                        IPackageFragment pkg,</TD></TR><TR><TD CLASS="l">2053</TD><TD>                        int firstDot,</TD></TR><TR><TD CLASS="l">2054</TD><TD>                        boolean partialMatch,</TD></TR><TR><TD CLASS="l"><A NAME="26">2055</A></TD><TD>                        String topLevelTypeName,</TD></TR><TR><TD CLASS="l">2056</TD><TD>                        int acceptFlags,</TD></TR><TR><TD CLASS="l">2057</TD><TD>                        IJavaElementRequestor requestor) {</TD></TR><TR><TD CLASS="l">2058</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2059</TD><TD>                bindingType=bindingType &amp; Binding.BASIC_BINDINGS_MASK;</TD></TR><TR CLASS="z"><TD CLASS="l">2060</TD><TD>                if (!partialMatch) {</TD></TR><TR CLASS="z"><TD CLASS="l">2061</TD><TD>                        HashMap []bindingsMap = (HashMap[]) (this.bindingsInWorkingCopies == null ? null : this.bindingsInWorkingCopies.get(pkg));</TD></TR><TR CLASS="z"><TD CLASS="l">2062</TD><TD>                        if (bindingsMap != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">2063</TD><TD>                                if (checkBindingAccept(topLevelTypeName, bindingsMap, bindingType, requestor))</TD></TR><TR CLASS="z"><TD CLASS="l">2064</TD><TD>                                        return true;</TD></TR><TR CLASS="z"><TD CLASS="l">2065</TD><TD>                                if ((bindingType&amp;Binding.VARIABLE)&gt;0 &amp;&amp; bindingType!=Binding.VARIABLE)</TD></TR><TR CLASS="z"><TD CLASS="l">2066</TD><TD>                                        if (checkBindingAccept(topLevelTypeName, bindingsMap, Binding.VARIABLE, requestor))</TD></TR><TR CLASS="z"><TD CLASS="l">2067</TD><TD>                                                return true;</TD></TR><TR CLASS="z"><TD CLASS="l">2068</TD><TD>                                if ((bindingType&amp;Binding.LOCAL)&gt;0 &amp;&amp; bindingType!=Binding.LOCAL)</TD></TR><TR CLASS="z"><TD CLASS="l">2069</TD><TD>                                        if (checkBindingAccept(topLevelTypeName, bindingsMap, Binding.LOCAL, requestor))</TD></TR><TR CLASS="z"><TD CLASS="l">2070</TD><TD>                                                return true;</TD></TR><TR CLASS="z"><TD CLASS="l">2071</TD><TD>                                if ((bindingType&amp;Binding.METHOD)&gt;0 &amp;&amp; bindingType!=Binding.METHOD)</TD></TR><TR CLASS="z"><TD CLASS="l">2072</TD><TD>                                        if (checkBindingAccept(topLevelTypeName, bindingsMap, Binding.METHOD, requestor))</TD></TR><TR CLASS="z"><TD CLASS="l">2073</TD><TD>                                                return true;</TD></TR><TR CLASS="z"><TD CLASS="l">2074</TD><TD>                                if ((bindingType&amp;Binding.TYPE)&gt;0 &amp;&amp; bindingType!=Binding.TYPE)</TD></TR><TR CLASS="z"><TD CLASS="l">2075</TD><TD>                                        if (checkBindingAccept(topLevelTypeName, bindingsMap, Binding.TYPE, requestor))</TD></TR><TR CLASS="z"><TD CLASS="l">2076</TD><TD>                                                return true;</TD></TR><TR><TD CLASS="l">2077</TD><TD>                        }</TD></TR><TR><TD CLASS="l">2078</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">2079</TD><TD>                        HashMap[] bindingsMap = (HashMap[]) (this.bindingsInWorkingCopies == null ? null : this.bindingsInWorkingCopies.get(pkg));</TD></TR><TR CLASS="z"><TD CLASS="l">2080</TD><TD>                        if (bindingsMap != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">2081</TD><TD>                                Iterator iterator = bindingsMap[bindingType].values().iterator();</TD></TR><TR CLASS="z"><TD CLASS="l">2082</TD><TD>                                while (iterator.hasNext()) {</TD></TR><TR CLASS="z"><TD CLASS="l">2083</TD><TD>                                        if (requestor.isCanceled())</TD></TR><TR CLASS="z"><TD CLASS="l">2084</TD><TD>                                                return false;</TD></TR><TR CLASS="z"><TD CLASS="l">2085</TD><TD>                                        Object object = iterator.next();</TD></TR><TR CLASS="z"><TD CLASS="l">2086</TD><TD>                                        if (object instanceof IType) {</TD></TR><TR CLASS="z"><TD CLASS="l">2087</TD><TD>                                                seekTypesInTopLevelType(name, firstDot, (IType) object, requestor, acceptFlags);</TD></TR><TR CLASS="z"><TD CLASS="l">2088</TD><TD>                                        } else if (object instanceof IType[]) {</TD></TR><TR CLASS="z"><TD CLASS="l">2089</TD><TD>                                                IType[] topLevelTypes = (IType[]) object;</TD></TR><TR CLASS="z"><TD CLASS="l">2090</TD><TD>                                                for (int i = 0, length = topLevelTypes.length; i &lt; length; i++)</TD></TR><TR CLASS="z"><TD CLASS="l">2091</TD><TD>                                                        seekTypesInTopLevelType(name, firstDot, topLevelTypes[i], requestor, acceptFlags);</TD></TR><TR><TD CLASS="l">2092</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">2093</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2094</TD><TD>                        }</TD></TR><TR><TD CLASS="l">2095</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">2096</TD><TD>                return false;</TD></TR><TR><TD CLASS="l">2097</TD><TD>        }</TD></TR><TR><TD CLASS="l">2098</TD><TD> </TD></TR><TR><TD CLASS="l">2099</TD><TD>           public static final boolean USE_BINDING_SEARCH=true;</TD></TR><TR><TD CLASS="l">2100</TD><TD>           private HandleFactory handleFactory;</TD></TR><TR><TD CLASS="l">2101</TD><TD>                protected IJavaScriptSearchScope searchScope;</TD></TR><TR><TD CLASS="l">2102</TD><TD>                public Answer findBindingSearch(</TD></TR><TR><TD CLASS="l">2103</TD><TD>                                String bindingName,</TD></TR><TR><TD CLASS="l">2104</TD><TD>                                String packageName,</TD></TR><TR><TD CLASS="l">2105</TD><TD>                                int bindingType,</TD></TR><TR><TD CLASS="l">2106</TD><TD>                                boolean partialMatch,</TD></TR><TR><TD CLASS="l">2107</TD><TD>                                int acceptFlags,</TD></TR><TR><TD CLASS="l">2108</TD><TD>                                boolean considerSecondaryTypes,</TD></TR><TR><TD CLASS="l">2109</TD><TD>                                boolean waitForIndexes,</TD></TR><TR><TD CLASS="l"><A NAME="36">2110</A></TD><TD>                                boolean checkRestrictions,</TD></TR><TR><TD CLASS="l">2111</TD><TD>                                IProgressMonitor progressMonitor, boolean returnMultiple, String exclude) {</TD></TR><TR><TD CLASS="l">2112</TD><TD> </TD></TR><TR><TD CLASS="l">2113</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="38">2114</A></TD><TD>                        class MyRequestor implements IJavaElementRequestor</TD></TR><TR><TD CLASS="l">2115</TD><TD>                        {</TD></TR><TR><TD CLASS="l">2116</TD><TD>                                IJavaScriptElement element;</TD></TR><TR><TD CLASS="l">2117</TD><TD>                                public void acceptField(IField field) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="39">2118</A></TD><TD>                                        element=field;</TD></TR><TR CLASS="z"><TD CLASS="l">2119</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2120</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="3a">2121</A></TD><TD>                                public void acceptInitializer(IInitializer initializer) {</TD></TR><TR CLASS="z"><TD CLASS="l">2122</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2123</TD><TD> </TD></TR><TR><TD CLASS="l">2124</TD><TD>                                public void acceptMemberType(IType type) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="3b">2125</A></TD><TD>                                        element=type;</TD></TR><TR CLASS="z"><TD CLASS="l">2126</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2127</TD><TD> </TD></TR><TR><TD CLASS="l">2128</TD><TD>                                public void acceptMethod(IFunction method) {</TD></TR><TR CLASS="z"><TD CLASS="l">2129</TD><TD>                                        element=method;</TD></TR><TR><TD CLASS="l">2130</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="3c">2131</A></TD><TD>                                }</TD></TR><TR><TD CLASS="l">2132</TD><TD> </TD></TR><TR><TD CLASS="l">2133</TD><TD>                                public void acceptPackageFragment(</TD></TR><TR><TD CLASS="l"><A NAME="3d">2134</A></TD><TD>                                                IPackageFragment packageFragment) {</TD></TR><TR CLASS="z"><TD CLASS="l">2135</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2136</TD><TD> </TD></TR><TR><TD CLASS="l">2137</TD><TD>                                public void acceptType(IType type) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="3e">2138</A></TD><TD>                                        element=type;</TD></TR><TR CLASS="z"><TD CLASS="l">2139</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2140</TD><TD> </TD></TR><TR><TD CLASS="l">2141</TD><TD>                                public boolean isCanceled() {</TD></TR><TR CLASS="z"><TD CLASS="l">2142</TD><TD>                                        return false;</TD></TR><TR><TD CLASS="l"><A NAME="d">2143</A></TD><TD>                                }</TD></TR><TR><TD CLASS="l">2144</TD><TD> </TD></TR><TR><TD CLASS="l">2145</TD><TD>                        }</TD></TR><TR><TD CLASS="l">2146</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2147</TD><TD>                        if (this.searchScope==null)</TD></TR><TR CLASS="z"><TD CLASS="l">2148</TD><TD>                                this.searchScope = BasicSearchEngine.createJavaSearchScope(packageFragmentRoots);</TD></TR><TR><TD CLASS="l">2149</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2150</TD><TD>                        ArrayList foundAnswers=new ArrayList();</TD></TR><TR CLASS="z"><TD CLASS="l">2151</TD><TD>                        Path excludePath= (exclude!=null)? new Path(exclude) : null;</TD></TR><TR><TD CLASS="l">2152</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2153</TD><TD>                        MyRequestor requestor=new MyRequestor();</TD></TR><TR CLASS="z"><TD CLASS="l">2154</TD><TD>                        JavaElementRequestor elementRequestor = new JavaElementRequestor();</TD></TR><TR CLASS="z"><TD CLASS="l">2155</TD><TD>                        seekPackageFragments(packageName, false, elementRequestor);</TD></TR><TR CLASS="z"><TD CLASS="l">2156</TD><TD>                        IPackageFragment[] packages= elementRequestor.getPackageFragments();</TD></TR><TR CLASS="z"><TD CLASS="l">2157</TD><TD>                        for (int i = 0; i &lt; packages.length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">2158</TD><TD>                                seekBindingsInWorkingCopies(bindingName, bindingType,</TD></TR><TR CLASS="z"><TD CLASS="l">2159</TD><TD>                                                packages[i], -1, partialMatch,</TD></TR><TR CLASS="z"><TD CLASS="l">2160</TD><TD>                                                bindingName, acceptFlags, requestor);</TD></TR><TR CLASS="z"><TD CLASS="l">2161</TD><TD>                                if (requestor.element != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">2162</TD><TD>                                        IOpenable openable = requestor.element.getOpenable();</TD></TR><TR CLASS="z"><TD CLASS="l">2163</TD><TD>                                        if (excludePath!=null &amp;&amp; requestor.element.getPath().equals(excludePath))</TD></TR><TR CLASS="z"><TD CLASS="l">2164</TD><TD>                                                continue;</TD></TR><TR CLASS="z"><TD CLASS="l">2165</TD><TD>                                        if (!returnMultiple) {</TD></TR><TR CLASS="z"><TD CLASS="l">2166</TD><TD>                                                return new Answer(openable, null);</TD></TR><TR><TD CLASS="l">2167</TD><TD>                                        } else</TD></TR><TR CLASS="z"><TD CLASS="l">2168</TD><TD>                                                foundAnswers.add(openable);</TD></TR><TR CLASS="z"><TD CLASS="l">2169</TD><TD>                                        requestor.element=null;</TD></TR><TR><TD CLASS="l">2170</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2171</TD><TD>                        }</TD></TR><TR><TD CLASS="l">2172</TD><TD>                        /*</TD></TR><TR><TD CLASS="l">2173</TD><TD>                         * if (true){ findTypes(new String(prefix), storage,</TD></TR><TR><TD CLASS="l">2174</TD><TD>                         * NameLookup.ACCEPT_CLASSES | NameLookup.ACCEPT_INTERFACES); return; }</TD></TR><TR><TD CLASS="l">2175</TD><TD>                         */</TD></TR><TR><TD CLASS="l">2176</TD><TD>                        try {</TD></TR><TR><TD CLASS="l">2177</TD><TD> </TD></TR><TR><TD CLASS="l">2178</TD><TD> </TD></TR><TR><TD CLASS="l">2179</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2180</TD><TD>                                IRestrictedAccessBindingRequestor bindingAcceptor = getRestrictedAccessRequestor();</TD></TR><TR CLASS="z"><TD CLASS="l">2181</TD><TD>                                if (exclude!=null)</TD></TR><TR CLASS="z"><TD CLASS="l">2182</TD><TD>                                        exclude=exclude.replace('\\', '/');</TD></TR><TR CLASS="z"><TD CLASS="l">2183</TD><TD>                                bindingAcceptor.setExcludePath(exclude);</TD></TR><TR><TD CLASS="l">2184</TD><TD> </TD></TR><TR><TD CLASS="l">2185</TD><TD>                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">2186</TD><TD>                                        int matchRule = SearchPattern.R_EXACT_MATCH | SearchPattern.R_CASE_SENSITIVE;</TD></TR><TR CLASS="z"><TD CLASS="l">2187</TD><TD>                                        new BasicSearchEngine().searchAllBindingNames(</TD></TR><TR CLASS="z"><TD CLASS="l">2188</TD><TD>                                                        CharOperation.NO_CHAR,</TD></TR><TR CLASS="z"><TD CLASS="l">2189</TD><TD>                                                        bindingName.toCharArray(),</TD></TR><TR CLASS="z"><TD CLASS="l">2190</TD><TD>                                                        bindingType,</TD></TR><TR CLASS="z"><TD CLASS="l">2191</TD><TD>                                                        matchRule, // not case sensitive</TD></TR><TR CLASS="z"><TD CLASS="l">2192</TD><TD>                                                        /*IJavaScriptSearchConstants.TYPE,*/ this.searchScope,</TD></TR><TR CLASS="z"><TD CLASS="l">2193</TD><TD>                                                        bindingAcceptor, IJavaScriptSearchConstants.WAIT_UNTIL_READY_TO_SEARCH,</TD></TR><TR CLASS="z"><TD CLASS="l">2194</TD><TD>                                                        false,</TD></TR><TR CLASS="z"><TD CLASS="l">2195</TD><TD>                                                        progressMonitor);</TD></TR><TR CLASS="z"><TD CLASS="l">2196</TD><TD>                                        if (bindingAcceptor.getFoundPath()!=null)</TD></TR><TR><TD CLASS="l">2197</TD><TD>                                        {</TD></TR><TR><TD CLASS="l">2198</TD><TD>                                                </TD></TR><TR CLASS="z"><TD CLASS="l">2199</TD><TD>                                                Object[] foundPaths = bindingAcceptor.getFoundPaths().toArray();</TD></TR><TR CLASS="z"><TD CLASS="l">2200</TD><TD>                                                for (int i = 0; i &lt; foundPaths.length; ++i) {</TD></TR><TR CLASS="z"><TD CLASS="l">2201</TD><TD>                                                        String path = (String) foundPaths[i];</TD></TR><TR><TD CLASS="l">2202</TD><TD> </TD></TR><TR><TD CLASS="l">2203</TD><TD>                                                IOpenable openable ; //= createOpenable(getRestrictedAccessRequestor().getFoundPath(), this.searchScope);</TD></TR><TR><TD CLASS="l">2204</TD><TD>//                                                if (openable!=null)</TD></TR><TR><TD CLASS="l">2205</TD><TD>//                                                        return new Answer(openable, null);</TD></TR><TR><TD CLASS="l">2206</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2207</TD><TD>                                                if (this.handleFactory == null)</TD></TR><TR CLASS="z"><TD CLASS="l">2208</TD><TD>                                                        this.handleFactory = new HandleFactory();</TD></TR><TR><TD CLASS="l">2209</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2210</TD><TD>                                                openable = this.handleFactory.createOpenable(path, this.searchScope);</TD></TR><TR><TD CLASS="l">2211</TD><TD> </TD></TR><TR><TD CLASS="l">2212</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2213</TD><TD>                                                if (openable!=null)</TD></TR><TR><TD CLASS="l">2214</TD><TD>                                                {</TD></TR><TR CLASS="z"><TD CLASS="l">2215</TD><TD>                                                        if (!returnMultiple)</TD></TR><TR CLASS="z"><TD CLASS="l">2216</TD><TD>                                                                return new Answer(openable, null);</TD></TR><TR><TD CLASS="l">2217</TD><TD>                                                        else</TD></TR><TR CLASS="z"><TD CLASS="l">2218</TD><TD>                                                                foundAnswers.add(openable);</TD></TR><TR><TD CLASS="l">2219</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">2220</TD><TD>                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">2221</TD><TD>                                                if (foundAnswers.size()&gt;0 &amp;&amp; returnMultiple)</TD></TR><TR CLASS="z"><TD CLASS="l">2222</TD><TD>                                                        return new Answer(foundAnswers.toArray(),null);</TD></TR><TR><TD CLASS="l">2223</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">2224</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2225</TD><TD>                                } catch (OperationCanceledException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">2226</TD><TD>                                        return findBinding( bindingName,packageName,bindingType,partialMatch,acceptFlags,considerSecondaryTypes,waitForIndexes,</TD></TR><TR CLASS="z"><TD CLASS="l">2227</TD><TD>                                                        checkRestrictions,progressMonitor);</TD></TR><TR><TD CLASS="l">2228</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2229</TD><TD>                                finally</TD></TR><TR CLASS="z"><TD CLASS="l">2230</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">2231</TD><TD>                                        bindingAcceptor.reset();</TD></TR><TR CLASS="z"><TD CLASS="l">2232</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">2233</TD><TD>                        } catch (JavaScriptModelException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">2234</TD><TD>                                return findBinding( bindingName,packageName,bindingType,partialMatch,acceptFlags,considerSecondaryTypes,waitForIndexes,</TD></TR><TR CLASS="z"><TD CLASS="l">2235</TD><TD>                                                checkRestrictions,progressMonitor);</TD></TR><TR><TD CLASS="l">2236</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">2237</TD><TD>                        return null;</TD></TR><TR><TD CLASS="l">2238</TD><TD>                }</TD></TR><TR><TD CLASS="l">2239</TD><TD>                /* creates an openable from PackageFragmentRoots in this lookup</TD></TR><TR><TD CLASS="l">2240</TD><TD>                 * i thought i was going to use, but found another way.  This may still</TD></TR><TR><TD CLASS="l"><A NAME="6">2241</A></TD><TD>                 * be faster then the current method so leaveing in case...</TD></TR><TR><TD CLASS="l">2242</TD><TD>                 *</TD></TR><TR><TD CLASS="l">2243</TD><TD>                 * */</TD></TR><TR><TD CLASS="l">2244</TD><TD>                public IOpenable createOpenable(String resourcePath, IJavaScriptSearchScope scope) {</TD></TR><TR CLASS="z"><TD CLASS="l">2245</TD><TD>                        if(packageFragmentRoots==null) return null;</TD></TR><TR CLASS="z"><TD CLASS="l">2246</TD><TD>                        IPath resourceP = new Path(resourcePath);</TD></TR><TR CLASS="z"><TD CLASS="l">2247</TD><TD>                        for(int i = 0;i&lt;packageFragmentRoots.length;i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">2248</TD><TD>                                IPackageFragmentRoot root = packageFragmentRoots[i];</TD></TR><TR CLASS="z"><TD CLASS="l">2249</TD><TD>                                IPath fragPath = root.getPath();</TD></TR><TR><TD CLASS="l">2250</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2251</TD><TD>                                String fileName = resourceP.lastSegment();</TD></TR><TR CLASS="z"><TD CLASS="l">2252</TD><TD>                                IPath rootPostFix=null;</TD></TR><TR><TD CLASS="l">2253</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2254</TD><TD>                                if( root.isLanguageRuntime() /*&amp;&amp; restrictToLanguage*/) {</TD></TR><TR CLASS="z"><TD CLASS="l">2255</TD><TD>                                        int rootSegs = fragPath.segmentCount();</TD></TR><TR CLASS="z"><TD CLASS="l">2256</TD><TD>                                        int resourceSegs = resourceP.segmentCount();</TD></TR><TR CLASS="z"><TD CLASS="l">2257</TD><TD>                                        if(rootSegs&gt;resourceSegs)</TD></TR><TR CLASS="z"><TD CLASS="l">2258</TD><TD>                                                rootPostFix =  (fragPath.removeFirstSegments(rootSegs - resourceSegs )).setDevice(null).makeAbsolute();</TD></TR><TR><TD CLASS="l">2259</TD><TD>                                }</TD></TR><TR><TD CLASS="l">2260</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2261</TD><TD>                                        if(fragPath.isPrefixOf(resourceP) || (rootPostFix!=null &amp;&amp; rootPostFix.equals(resourceP.makeAbsolute()))) {</TD></TR><TR CLASS="z"><TD CLASS="l">2262</TD><TD>                                                if(root instanceof LibraryFragmentRoot  /*&amp;&amp; (!restrictToLanguage  || root.isLanguageRuntime()      )*/ ) {</TD></TR><TR CLASS="z"><TD CLASS="l">2263</TD><TD>                                                                IClassFile file = root.getPackageFragment(root.getPath().toString()).getClassFile(root.getPath().toString());</TD></TR><TR CLASS="z"><TD CLASS="l">2264</TD><TD>                                                                return file;</TD></TR><TR><TD CLASS="l">2265</TD><TD> </TD></TR><TR><TD CLASS="l">2266</TD><TD>                                                }else{</TD></TR><TR CLASS="z"><TD CLASS="l">2267</TD><TD>                                                        if(resourceP.toFile().exists()){</TD></TR><TR CLASS="z"><TD CLASS="l">2268</TD><TD>                                                                IClassFile file = root.getPackageFragment(resourcePath).getClassFile(resourcePath);</TD></TR><TR CLASS="z"><TD CLASS="l">2269</TD><TD>                                                                return file;</TD></TR><TR><TD CLASS="l">2270</TD><TD>                                                        }else {</TD></TR><TR CLASS="z"><TD CLASS="l">2271</TD><TD>                                                                String pkgName = resourcePath.substring(fragPath.toString().length());</TD></TR><TR CLASS="z"><TD CLASS="l">2272</TD><TD>                                                                int indexName = pkgName.indexOf(fileName);</TD></TR><TR CLASS="z"><TD CLASS="l">2273</TD><TD>                                                                if(indexName&gt;-1) {</TD></TR><TR CLASS="z"><TD CLASS="l">2274</TD><TD>                                                                        pkgName = pkgName.substring(0,indexName-1);</TD></TR><TR><TD CLASS="l">2275</TD><TD>                                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">2276</TD><TD>                                                                IJavaScriptUnit file = root.getPackageFragment(pkgName).getJavaScriptUnit((fileName));</TD></TR><TR CLASS="z"><TD CLASS="l">2277</TD><TD>                                                                return file;</TD></TR><TR><TD CLASS="l">2278</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">2279</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">2280</TD><TD> </TD></TR><TR><TD CLASS="l">2281</TD><TD> </TD></TR><TR><TD CLASS="l">2282</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">2283</TD><TD> </TD></TR><TR><TD CLASS="l">2284</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">2285</TD><TD>                        return null;</TD></TR><TR><TD CLASS="l">2286</TD><TD> </TD></TR><TR><TD CLASS="l">2287</TD><TD> </TD></TR><TR><TD CLASS="l">2288</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="2e">2289</A></TD><TD> </TD></TR><TR><TD CLASS="l">2290</TD><TD> </TD></TR><TR><TD CLASS="l">2291</TD><TD>                public void setScriptFile(IInferenceFile compUnit)</TD></TR><TR><TD CLASS="l">2292</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2293</TD><TD>                        InferrenceProvider[] inferenceProviders = InferrenceManager.getInstance().getInferenceProviders(compUnit);</TD></TR><TR CLASS="z"><TD CLASS="l">2294</TD><TD>                        if (inferenceProviders!=null &amp;&amp; inferenceProviders.length&gt;0)</TD></TR><TR><TD CLASS="l">2295</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">2296</TD><TD>                                ResolutionConfiguration resolutionConfiguration = inferenceProviders[0].getResolutionConfiguration();</TD></TR><TR CLASS="z"><TD CLASS="l">2297</TD><TD>                                if (resolutionConfiguration!=null)</TD></TR><TR CLASS="z"><TD CLASS="l">2298</TD><TD>                                        searchFiles=resolutionConfiguration.searchAllFiles();</TD></TR><TR><TD CLASS="l">2299</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">2300</TD><TD>                }</TD></TR><TR><TD CLASS="l">2301</TD><TD>                </TD></TR><TR><TD CLASS="l">2302</TD><TD>}</TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../xslUnitTestCoverage.html">all classes</A>][<A HREF="124.html">org.eclipse.wst.jsdt.internal.core</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://www.eclemma.org/support.html">EMMA 2.0.5312 EclEmma Fix 1</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>